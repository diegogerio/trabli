import{R as e,_ as t,I as r,l as n,y as o,q as i,F as a,c as s,b as l,d as c,e as u,k as h,a as d,h as p,f,s as v,A as m,g,i as y,j as w,L as b,m as k}from"./index.6984fb79.js";import{g as x,c as S,i as M,d as C,a as O,b as E,s as A,e as N,t as R,S as T,f as D,h as P,Y as I,m as V,j as z,k as $,l as B,C as H,n as L,o as _,p as F,q as j,R as W,r as K,u as U,v as q,w as J,x as Z,y as G,z as X,A as Y,B as Q,E as ee,F as te,U as re,G as ne,H as oe,W as ie,J as ae}from"./y.a65ca05f.js";import{_ as se,I as le,a as ce,n as ue,U as he}from"./bucket-23.6f76f9e5.js";var de,pe,fe,ve,me,ge,ye,we,be,ke,xe,Se,Me,Ce,Oe,Ee,Ae,Ne,Re,Te,De,Pe,Ie,Ve,ze,$e,Be,He,Le,_e,Fe,je,We,Ke,Ue,qe,Je,Ze,Ge,Xe,Ye,Qe,et=e.forwardRef((function(t,r){var n=t.children,o=se(t,["children"]);return e.createElement(le,ce({width:24,height:24,viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",ref:r},o),de||(de=e.createElement("path",{d:"M14 21.414L9 16.413 10.413 15 14 18.586 21.585 11 23 12.415 14 21.414z"})),pe||(pe=e.createElement("path",{d:"M16,2A14,14,0,1,0,30,16,14,14,0,0,0,16,2Zm0,26A12,12,0,1,1,28,16,12,12,0,0,1,16,28Z"})),n)})),tt=e.forwardRef((function(t,r){var n=t.children,o=se(t,["children"]);return e.createElement(le,ce({width:24,height:24,viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",ref:r},o),fe||(fe=e.createElement("path",{d:"M16,2C8.2,2,2,8.2,2,16s6.2,14,14,14s14-6.2,14-14S23.8,2,16,2z M16,28C9.4,28,4,22.6,4,16S9.4,4,16,4s12,5.4,12,12\tS22.6,28,16,28z"})),ve||(ve=e.createElement("path",{d:"M21.4 23L16 17.6 10.6 23 9 21.4 14.4 16 9 10.6 10.6 9 16 14.4 21.4 9 23 10.6 17.6 16 23 21.4z"})),n)})),rt=e.forwardRef((function(t,r){var n=t.children,o=se(t,["children"]);return e.createElement(le,ce({width:16,height:16,viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",ref:r},o),me||(me=e.createElement("path",{d:"M30 3.41L28.59 2 25 5.59 21.41 2 20 3.41 23.59 7 20 10.59 21.41 12 25 8.41 28.59 12 30 10.59 26.41 7 30 3.41z"})),ge||(ge=e.createElement("path",{d:"M24 14V28H18V6H16V28a2.0023 2.0023 0 002 2h6a2.0023 2.0023 0 002-2V14zM10 30H4a2.0021 2.0021 0 01-2-2V8A2.0021 2.0021 0 014 6h6a2.0021 2.0021 0 012 2V28A2.0021 2.0021 0 0110 30zM4 8V28h6V8z"})),n)})),nt=e.forwardRef((function(t,r){var n=t.children,o=se(t,["children"]);return e.createElement(le,ce({width:16,height:16,viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",ref:r},o),ye||(ye=e.createElement("path",{d:"M29.37,11.84a13.6,13.6,0,0,0-1.06-2.51A14.17,14.17,0,0,0,25.9,6.1a14,14,0,1,0,0,19.8,14.17,14.17,0,0,0,2.41-3.23,13.6,13.6,0,0,0,1.06-2.51,14,14,0,0,0,0-8.32ZM4,16A12,12,0,0,1,16,4V28A12,12,0,0,1,4,16Z"})),n)})),ot=e.forwardRef((function(t,r){var n=t.children,o=se(t,["children"]);return e.createElement(le,ce({width:16,height:16,viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",ref:r},o),we||(we=e.createElement("path",{d:"M4 20L4 22 8.586 22 2 28.586 3.414 30 10 23.414 10 28 12 28 12 20 4 20zM20 22H24V24H20zM16 18H20V20H16zM20 14H24V16H20zM8 14H12V16H8z"})),be||(be=e.createElement("path",{d:"M27,3H5A2.0027,2.0027,0,0,0,3,5V16H5V11H27V27H16v2H27a2.0027,2.0027,0,0,0,2-2V5A2.0027,2.0027,0,0,0,27,3Zm0,6H5V5H27Z"})),n)})),it=e.forwardRef((function(t,r){var n=t.children,o=se(t,["children"]);return e.createElement(le,ce({width:16,height:16,viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",ref:r},o),ke||(ke=e.createElement("path",{d:"M26 30H24V27a5.0059 5.0059 0 00-5-5H13a5.0059 5.0059 0 00-5 5v3H6V27a7.0082 7.0082 0 017-7h6a7.0082 7.0082 0 017 7zM5 6A1 1 0 004 7v9H6V7A1 1 0 005 6z"})),xe||(xe=e.createElement("path",{d:"M4,2V4H9v7a7,7,0,0,0,14,0V4h5V2Zm7,2H21V7H11Zm5,12a5,5,0,0,1-5-5V9H21v2A5,5,0,0,1,16,16Z"})),n)})),at=e.forwardRef((function(t,r){var n=t.children,o=se(t,["children"]);return e.createElement(le,ce({width:16,height:16,viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",ref:r},o),Se||(Se=e.createElement("path",{d:"M16.6123,2.2138a1.01,1.01,0,0,0-1.2427,0L1,13.4194l1.2427,1.5717L4,13.6209V26a2.0041,2.0041,0,0,0,2,2H26a2.0037,2.0037,0,0,0,2-2V13.63L29.7573,15,31,13.4282ZM18,26H14V18h4Zm2,0V18a2.0023,2.0023,0,0,0-2-2H14a2.002,2.002,0,0,0-2,2v8H6V12.0615l10-7.79,10,7.8005V26Z"})),n)})),st=e.forwardRef((function(t,r){var n=t.children,o=se(t,["children"]);return e.createElement(le,ce({width:16,height:16,viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",ref:r},o),Me||(Me=e.createElement("path",{d:"M4 20L4 22 8.586 22 2 28.586 3.414 30 10 23.414 10 28 12 28 12 20 4 20zM19 14a3 3 0 10-3-3A3 3 0 0019 14zm0-4a1 1 0 11-1 1A1 1 0 0119 10z"})),Ce||(Ce=e.createElement("path",{d:"M26,4H6A2,2,0,0,0,4,6V16H6V6H26V21.17l-3.59-3.59a2,2,0,0,0-2.82,0L18,19.17,11.8308,13l-1.4151,1.4155L14,18l2.59,2.59a2,2,0,0,0,2.82,0L21,19l5,5v2H16v2H26a2,2,0,0,0,2-2V6A2,2,0,0,0,26,4Z"})),n)})),lt=e.forwardRef((function(t,r){var n=t.children,o=se(t,["children"]);return e.createElement(le,ce({width:16,height:16,viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",ref:r},o),Oe||(Oe=e.createElement("circle",{cx:"3.5",cy:"4.5",r:"1.5"})),Ee||(Ee=e.createElement("circle",{cx:"3.5",cy:"11.5",r:"1.5"})),Ae||(Ae=e.createElement("path",{d:"M8 11H15V12H8zM8 4H15V5H8z"})),n)})),ct=e.forwardRef((function(t,r){var n=t.children,o=se(t,["children"]);return e.createElement(le,ce({width:16,height:16,viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",ref:r},o),Ne||(Ne=e.createElement("path",{d:"M16,10V22h0V10m1-1H12v2h3V21H12v2h8V21H17V9Z"})),n)})),ut=e.forwardRef((function(t,r){var n=t.children,o=se(t,["children"]);return e.createElement(le,ce({width:16,height:16,viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",ref:r},o),Re||(Re=e.createElement("path",{d:"M20,23H12V17a2,2,0,0,1,2-2h4V11H12V9h6a2,2,0,0,1,2,2v4a2,2,0,0,1-2,2H14v4h6Z"})),n)})),ht=e.forwardRef((function(t,r){var n=t.children,o=se(t,["children"]);return e.createElement(le,ce({width:16,height:16,viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",ref:r},o),Te||(Te=e.createElement("path",{d:"M18,9H12v2h6v4H14v2h4v4H12v2h6a2,2,0,0,0,2-2V11A2,2,0,0,0,18,9Z"})),n)})),dt=e.forwardRef((function(t,r){var n=t.children,o=se(t,["children"]);return e.createElement(le,ce({width:16,height:16,viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",ref:r},o),De||(De=e.createElement("path",{d:"M18,10v8h0V10m1-1H17v8H14V9H12V19h5v4h2V19h1V17H19V9Z"})),n)})),pt=e.forwardRef((function(t,r){var n=t.children,o=se(t,["children"]);return e.createElement(le,ce({width:16,height:16,viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",ref:r},o),Pe||(Pe=e.createElement("path",{d:"M18,23H12V21h6V17H12V9h8v2H14v4h4a2,2,0,0,1,2,2v4A2,2,0,0,1,18,23Z"})),n)})),ft=e.forwardRef((function(t,r){var n=t.children,o=se(t,["children"]);return e.createElement(le,ce({width:16,height:16,viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",ref:r},o),Ie||(Ie=e.createElement("path",{d:"M28,4H4A2,2,0,0,0,2,6V26a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V6A2,2,0,0,0,28,4Zm0,2V18H4V6ZM4,26V20H28v6Z"})),n)})),vt=e.forwardRef((function(t,r){var n=t.children,o=se(t,["children"]);return e.createElement(le,ce({width:16,height:16,viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",ref:r},o),Ve||(Ve=e.createElement("path",{d:"M28,4H4A2,2,0,0,0,2,6V26a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V6A2,2,0,0,0,28,4ZM4,6h6V26H4ZM28,26H12V6H28Z"})),n)})),mt=e.forwardRef((function(t,r){var n=t.children,o=se(t,["children"]);return e.createElement(le,ce({width:16,height:16,viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",ref:r},o),ze||(ze=e.createElement("path",{d:"M28,4H4A2,2,0,0,0,2,6V26a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V6A2,2,0,0,0,28,4ZM4,6H20V26H4ZM28,26H22V6h6Z"})),n)})),gt=e.forwardRef((function(t,r){var n=t.children,o=se(t,["children"]);return e.createElement(le,ce({width:16,height:16,viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",ref:r},o),$e||($e=e.createElement("path",{d:"M28,4H4A2,2,0,0,0,2,6V26a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V6A2,2,0,0,0,28,4Zm0,2v6H4V6ZM4,26V14H28V26Z"})),n)})),yt=e.forwardRef((function(t,r){var n=t.children,o=se(t,["children"]);return e.createElement(le,ce({width:16,height:16,viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",ref:r},o),Be||(Be=e.createElement("path",{d:"M28,9H25V3H7V9H4a2,2,0,0,0-2,2V21a2,2,0,0,0,2,2H7v6H25V23h3a2,2,0,0,0,2-2V11A2,2,0,0,0,28,9ZM9,5H23V9H9ZM23,27H9V17H23Zm5-6H25V15H7v6H4V11H28Z"})),n)})),wt=e.forwardRef((function(t,r){var n=t.children,o=se(t,["children"]);return e.createElement(le,ce({width:24,height:24,viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",ref:r},o),He||(He=e.createElement("path",{d:"M16,2A14,14,0,1,0,30,16,14,14,0,0,0,16,2Zm0,26A12,12,0,1,1,28,16,12,12,0,0,1,16,28Z"})),n)})),bt=e.forwardRef((function(t,r){var n=t.children,o=se(t,["children"]);return e.createElement(le,ce({width:16,height:16,viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",ref:r},o),Le||(Le=e.createElement("path",{d:"M4,8c-1.2,0-2,0.8-2,2c0,1.2,0.8,2,2,2h3v1H4c-1.7,0-3-1.2-3-3c0-1.7,1.3-3,3-3l9.1,0l-2-2l0.7-0.7\tL15,7.5l-3.2,3.2L11.1,10l2-2L4,8z"})),n)})),kt=e.forwardRef((function(t,r){var n=t.children,o=se(t,["children"]);return e.createElement(le,ce({width:16,height:16,viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",ref:r},o),_e||(_e=e.createElement("path",{d:"M4 24H28V26H4zM26 18H6V14H26v4m2 0V14a2 2 0 00-2-2H6a2 2 0 00-2 2v4a2 2 0 002 2H26a2 2 0 002-2zM4 6H28V8H4z"})),n)})),xt=e.forwardRef((function(t,r){var n=t.children,o=se(t,["children"]);return e.createElement(le,ce({width:16,height:16,viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",ref:r},o),Fe||(Fe=e.createElement("path",{d:"M24 30H4a2.0021 2.0021 0 01-2-2V22a2.0021 2.0021 0 012-2H24a2.0021 2.0021 0 012 2v6A2.0021 2.0021 0 0124 30zM4 22H3.9985L4 28H24V22zM30 3.41L28.59 2 25 5.59 21.41 2 20 3.41 23.59 7 20 10.59 21.41 12 25 8.41 28.59 12 30 10.59 26.41 7 30 3.41z"})),je||(je=e.createElement("path",{d:"M4,14V8H18V6H4A2.0023,2.0023,0,0,0,2,8v6a2.0023,2.0023,0,0,0,2,2H26V14Z"})),n)})),St=e.forwardRef((function(t,r){var n=t.children,o=se(t,["children"]);return e.createElement(le,ce({width:16,height:16,viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",ref:r},o),We||(We=e.createElement("path",{d:"M27.45,15.11l-22-11a1,1,0,0,0-1.08.12,1,1,0,0,0-.33,1L7,16,4,26.74A1,1,0,0,0,5,28a1,1,0,0,0,.45-.11l22-11a1,1,0,0,0,0-1.78Zm-20.9,10L8.76,17H18V15H8.76L6.55,6.89,24.76,16Z"})),n)})),Mt=e.forwardRef((function(t,r){var n=t.children,o=se(t,["children"]);return e.createElement(le,ce({width:16,height:16,viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",ref:r},o),Ke||(Ke=e.createElement("path",{d:"M4 6H22V8H4zM4 12H22V14H4zM4 18H22V20H4zM4 24H22V26H4zM26 6H28V8H26zM26 12H28V14H26zM26 18H28V20H26zM26 24H28V26H26z"})),n)})),Ct=e.forwardRef((function(t,r){var n=t.children,o=se(t,["children"]);return e.createElement(le,ce({width:16,height:16,viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",ref:r},o),Ue||(Ue=e.createElement("path",{d:"M18.25,25H9V7h8.5a5.25,5.25,0,0,1,4,8.65A5.25,5.25,0,0,1,18.25,25ZM12,22h6.23a2.25,2.25,0,1,0,0-4.5H12Zm0-7.5h5.5a2.25,2.25,0,1,0,0-4.5H12Z"})),n)})),Ot=e.forwardRef((function(t,r){var n=t.children,o=se(t,["children"]);return e.createElement(le,ce({width:16,height:16,viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",ref:r},o),qe||(qe=e.createElement("path",{d:"M14 6H28V8H14zM14 12H28V14H14zM7 18H28V20H7zM7 24H28V26H7zM4 13.59L7.29 10 4 6.41 5.42 5 10.04 10 5.42 15 4 13.59z"})),n)})),Et=e.forwardRef((function(t,r){var n=t.children,o=se(t,["children"]);return e.createElement(le,ce({width:16,height:16,viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",ref:r},o),Je||(Je=e.createElement("path",{d:"M25 9L25 7 12 7 12 9 17.14 9 12.77 23 7 23 7 25 20 25 20 23 14.86 23 19.23 9 25 9z"})),n)})),At=e.forwardRef((function(t,r){var n=t.children,o=se(t,["children"]);return e.createElement(le,ce({width:16,height:16,viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",ref:r},o),Ze||(Ze=e.createElement("path",{d:"M4 26H28V28H4zM16 23a7 7 0 01-7-7V5h2V16a5 5 0 0010 0V5h2V16A7 7 0 0116 23z"})),n)})),Nt=e.forwardRef((function(t,r){var n=t.children,o=se(t,["children"]);return e.createElement(le,ce({width:16,height:16,viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",ref:r},o),Ge||(Ge=e.createElement("path",{d:"M26,12H20V6a3.0033,3.0033,0,0,0-3-3H14.8672a2.0094,2.0094,0,0,0-1.98,1.7173l-.8453,5.9165L8.4648,16H2V30H23a7.0078,7.0078,0,0,0,7-7V16A4.0045,4.0045,0,0,0,26,12ZM8,28H4V18H8Zm20-5a5.0057,5.0057,0,0,1-5,5H10V17.3027l3.9578-5.9365L14.8672,5H17a1.0008,1.0008,0,0,1,1,1v8h8a2.0025,2.0025,0,0,1,2,2Z"})),n)})),Rt=e.forwardRef((function(t,r){var n=t.children,o=se(t,["children"]);return e.createElement(le,ce({width:16,height:16,viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",ref:r},o),Xe||(Xe=e.createElement("path",{d:"M25 11L26.414 12.414 23.828 15 30 15 30 17 23.828 17 26.414 19.586 25 21 20 16 25 11z"})),Ye||(Ye=e.createElement("path",{d:"M30 28H20a2.0023 2.0023 0 01-2-2V6a2.0023 2.0023 0 012-2H30V6H20V26H30zM12 28H2V26H12V6H2V4H12a2.0023 2.0023 0 012 2V26A2.0023 2.0023 0 0112 28z"})),Qe||(Qe=e.createElement("path",{d:"M7 11L5.586 12.414 8.172 15 2 15 2 17 8.172 17 5.586 19.586 7 21 12 16 7 11z"})),n)}));function Tt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Dt(e,t){if(e){if("string"==typeof e)return Tt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Tt(e,t):void 0}}function Pt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=r){var n,o,i=[],a=!0,s=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(l){s=!0,o=l}finally{try{a||null==r.return||r.return()}finally{if(s)throw o}}return i}}(e,t)||Dt(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function It(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Vt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function zt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Vt(Object(r),!0).forEach((function(t){It(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Vt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function $t(e,r){if(null==e)return{};var n,o,i=t(e,r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],r.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Bt(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Dt(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function Ht(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Lt(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,Ht(e,t,"get"))}let _t=()=>({events:{},emit(e,...t){(this.events[e]||[]).forEach((e=>e(...t)))},on(e,t){return(this.events[e]=this.events[e]||[]).push(t),()=>this.events[e]=(this.events[e]||[]).filter((e=>e!==t))}});var Ft,jt,Wt,Kt,Ut={LastNodeCompatible:"lastNodeCompatible",FormattingMark:"formattingMark",FormattingNode:"formattingNode",NodeCursor:"nodeCursor",FontStyle:"fontStyle",Link:"link",Color:"color",Alignment:"alignment",Indentation:"indentation",Behavior:"behavior",Code:"code",InlineNode:"inline",ListContainerNode:"listContainer",ListItemNode:"listItemNode",BlockNode:"block",ExcludeInputRules:"excludeFromInputRules",MarkSupportsExit:"markSupportsExits"};(jt=Ft||(Ft={})).FontStyle="fontStyle",jt.Link="link",jt.Color="color",jt.Alignment="alignment",jt.Indentation="indentation",jt.Behavior="behavior",jt.Code="code",(Kt=Wt||(Wt={})).Inline="inline",Kt.Block="block";var qt,Jt,Zt,Gt,Xt,Yt,Qt,er,tr=Symbol.for("__remirror__");(Jt=qt||(qt={})).PlainExtension="RemirrorPlainExtension",Jt.NodeExtension="RemirrorNodeExtension",Jt.MarkExtension="RemirrorMarkExtension",Jt.PlainExtensionConstructor="RemirrorPlainExtensionConstructor",Jt.NodeExtensionConstructor="RemirrorNodeExtensionConstructor",Jt.MarkExtensionConstructor="RemirrorMarkExtensionConstructor",Jt.Manager="RemirrorManager",Jt.Preset="RemirrorPreset",Jt.PresetConstructor="RemirrorPresetConstructor",(Gt=Zt||(Zt={}))[Gt.Critical=1e6]="Critical",Gt[Gt.Highest=1e5]="Highest",Gt[Gt.High=1e4]="High",Gt[Gt.Medium=1e3]="Medium",Gt[Gt.Default=100]="Default",Gt[Gt.Low=10]="Low",Gt[Gt.Lowest=0]="Lowest",(Yt=Xt||(Xt={}))[Yt.None=0]="None",Yt[Yt.Create=1]="Create",Yt[Yt.EditorView=2]="EditorView",Yt[Yt.Runtime=3]="Runtime",Yt[Yt.Destroy=4]="Destroy",(er=Qt||(Qt={})).PROD="RMR0000",er.UNKNOWN="RMR0001",er.INVALID_COMMAND_ARGUMENTS="RMR0002",er.CUSTOM="RMR0003",er.CORE_HELPERS="RMR0004",er.MUTATION="RMR0005",er.INTERNAL="RMR0006",er.MISSING_REQUIRED_EXTENSION="RMR0007",er.MANAGER_PHASE_ERROR="RMR0008",er.NEW_EDITOR_MANAGER="RMR0009",er.INVALID_PRESET_EXTENSION="RMR0010",er.INVALID_MANAGER_ARGUMENTS="RMR0011",er.SCHEMA="RMR0012",er.HELPERS_CALLED_IN_OUTER_SCOPE="RMR0013",er.INVALID_MANAGER_EXTENSION="RMR0014",er.INVALID_MANAGER_PRESET="RMR0015",er.DUPLICATE_COMMAND_NAMES="RMR0016",er.DUPLICATE_HELPER_NAMES="RMR0017",er.NON_CHAINABLE_COMMAND="RMR0018",er.INVALID_EXTENSION="RMR0019",er.INVALID_PRESET="RMR0020",er.INVALID_CONTENT="RMR0021",er.INVALID_NAME="RMR0050",er.EXTENSION="RMR0100",er.EXTENSION_SPEC="RMR0101",er.EXTENSION_EXTRA_ATTRIBUTES="RMR0102",er.INVALID_SET_EXTENSION_OPTIONS="RMR0103",er.REACT_PROVIDER_CONTEXT="RMR0200",er.REACT_GET_ROOT_PROPS="RMR0201",er.REACT_EDITOR_VIEW="RMR0202",er.REACT_CONTROLLED="RMR0203",er.REACT_NODE_VIEW="RMR0204",er.I18N_CONTEXT="RMR0300";var rr={exports:{}};!function(e,t){var r="undefined"!=typeof Reflect?Reflect.construct:void 0,n=Object.defineProperty,o=Error.captureStackTrace;function i(e){void 0!==e&&n(this,"message",{configurable:!0,value:e,writable:!0});var t=this.constructor.name;void 0!==t&&t!==this.name&&n(this,"name",{configurable:!0,value:t,writable:!0}),o(this,this.constructor)}void 0===o&&(o=function(e){var t=new Error;n(e,"stack",{configurable:!0,get:function(){var e=t.stack;return n(this,"stack",{configurable:!0,value:e,writable:!0}),e},set:function(t){n(e,"stack",{configurable:!0,value:t,writable:!0})}})}),i.prototype=Object.create(Error.prototype,{constructor:{configurable:!0,value:i,writable:!0}});var a=function(){function e(e,t){return n(e,"name",{configurable:!0,value:t})}try{var t=function(){};if(e(t,"foo"),"foo"===t.name)return e}catch(r){}}();(e.exports=function(e,t){if(null==t||t===Error)t=i;else if("function"!=typeof t)throw new TypeError("super_ should be a function");var n;if("string"==typeof e)n=e,e=void 0!==r?function(){return r(t,arguments,this.constructor)}:function(){t.apply(this,arguments)},void 0!==a&&(a(e,n),n=void 0);else if("function"!=typeof e)throw new TypeError("constructor should be either a string or a function");e.super_=e.super=t;var o={constructor:{configurable:!0,value:e,writable:!0}};return void 0!==n&&(o.name={configurable:!0,value:n,writable:!0}),e.prototype=Object.create(t.prototype,o),e}).BaseError=i}(rr);var nr=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===or}(e)}(e)};var or="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function ir(e,t){return!1!==t.clone&&t.isMergeableObject(e)?ur((r=e,Array.isArray(r)?[]:{}),e,t):e;var r}function ar(e,t,r){return e.concat(t).map((function(e){return ir(e,r)}))}function sr(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return e.propertyIsEnumerable(t)})):[]}(e))}function lr(e,t){try{return t in e}catch(r){return!1}}function cr(e,t,r){var n={};return r.isMergeableObject(e)&&sr(e).forEach((function(t){n[t]=ir(e[t],r)})),sr(t).forEach((function(o){(function(e,t){return lr(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,o)||(lr(e,o)&&r.isMergeableObject(t[o])?n[o]=function(e,t){if(!t.customMerge)return ur;var r=t.customMerge(e);return"function"==typeof r?r:ur}(o,r)(e[o],t[o],r):n[o]=ir(t[o],r))})),n}function ur(e,t,r){(r=r||{}).arrayMerge=r.arrayMerge||ar,r.isMergeableObject=r.isMergeableObject||nr,r.cloneUnlessOtherwiseSpecified=ir;var n=Array.isArray(t);return n===Array.isArray(e)?n?r.arrayMerge(e,t,r):cr(e,t,r):ir(t,r)}ur.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,r){return ur(e,r,t)}),{})};var hr=ur,dr=function(e){return null!=e&&"object"==typeof e&&!1===Array.isArray(e)},pr=dr;function fr(e){return!0===pr(e)&&"[object Object]"===Object.prototype.toString.call(e)}var vr=function(e){var t,r;return!1!==fr(e)&&("function"==typeof(t=e.constructor)&&(!1!==fr(r=t.prototype)&&!1!==r.hasOwnProperty("isPrototypeOf")))},mr=function(e){return vr(e)||"function"==typeof e||Array.isArray(e)},gr=function(e,t,r){if(!mr(e))return{};"function"==typeof t&&(r=t,t=[]),"string"==typeof t&&(t=[t]);for(var n="function"==typeof r,o=Object.keys(e),i={},a=0;a<o.length;a++){var s=o[a],l=e[s];t&&(-1!==t.indexOf(s)||n&&!r(l,s,e))||(i[s]=l)}return i},yr=dr,wr=function(e,t){if(!yr(e)&&"function"!=typeof e)return{};var r={};if("string"==typeof t)return t in e&&(r[t]=e[t]),r;for(var n=t.length,o=-1;++o<n;){var i=t[o];i in e&&(r[i]=e[i])}return r};
/*!
 * is-extendable <https://github.com/jonschlinkert/is-extendable>
 *
 * Copyright (c) 2015-2017, Jon Schlinkert.
 * Released under the MIT License.
 */function br(e,t){void 0===t&&(t=!1);var r=e.trim().normalize("NFC"),n=r.includes(" ")?r.split(" ").filter(Boolean):function(e){return e.match(/^[a-zà-öø-ÿ]+|[A-ZÀ-ÖØ-ß][a-zà-öø-ÿ]+|[a-zà-öø-ÿ]+|[0-9]+|[A-ZÀ-ÖØ-ß]+(?![a-zà-öø-ÿ])/g)}(r);return t?n.map((function(e){return e.normalize("NFD").replace(/[^a-zA-ZØßø0-9]/g,"")})):n}function kr(e){return e[0].toUpperCase()+e.slice(1).toLowerCase()}var xr,Sr;function Mr(e){return br(e,true).reduce((function(e,t){return e+kr(t)}),"")}function Cr(e){return br(e,true).join("-").toLowerCase()}function Or(e,t,r,n){var o,i=!1,a=0;function s(){o&&clearTimeout(o)}function l(){for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];var h=this,d=Date.now()-a;function p(){a=Date.now(),r.apply(h,c)}function f(){o=void 0}i||(n&&!o&&p(),s(),void 0===n&&d>e?p():!0!==t&&(o=setTimeout(n?f:p,void 0===n?e-d:e)))}return"boolean"!=typeof t&&(n=r,r=t,t=void 0),l.cancel=function(){s(),i=!0},l}function Er(e){return Object.entries(e)}function Ar(e){return Object.keys(e)}function Nr(e){return Object.values(e)}function Rr(e,t,r){return e.includes(t,r)}function Tr(e){return Object.assign(Object.create(null),e)}function Dr(e){return!!e}function Pr(e){return function(e){return Object.prototype.toString.call(e)}(e).slice(8,-1)}function Ir(e,t){return r=>typeof r===e&&(!t||t(r))}function Vr(e){return t=>Pr(t)===e}(Sr=xr||(xr={})).Object="Object",Sr.RegExp="RegExp",Sr.Date="Date",Sr.Promise="Promise",Sr.Error="Error",Sr.Map="Map",Sr.Set="Set";var zr=Ir("undefined"),$r=Ir("string"),Br=Ir("number",(e=>!Number.isNaN(e))),Hr=Ir("function");function Lr(e){return null===e}function _r(e){if(Pr(e)!==xr.Object)return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.getPrototypeOf({})}function Fr(e){return null==e||/^[bns]/.test(typeof e)}function jr(e){return Lr(e)||zr(e)}function Wr(e){return!jr(e)&&(Hr(e)||Ir("object")(e))}function Kr(e){return function(e){return Vr(xr.Promise)(e)}(e)||(e=>!(Lr(e)||!Wr(e)||!Hr(e.then)||!Hr(e.catch)))(e)}var Ur=Vr(xr.RegExp);function qr(e){return Wr(e)&&!function(e){return Vr(xr.Map)(e)}(e)&&!function(e){return Vr(xr.Set)(e)}(e)&&0===Object.keys(e).length}xr.Date,xr.Error;var Jr=Array.isArray;function Zr(e){return Jr(e)&&0===e.length}var Gr=e=>Wr(e);function Xr(e,t){return Jr(t)?Rr(t,e[tr]):t===e[tr]}function Yr(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e=>Dr(e),o=[],i=t.flags;i.includes("g")||(t=new RegExp(t.source,"g".concat(i)));do{(r=t.exec(e))&&o.push(r)}while(n(r));return t.lastIndex=0,o}function Qr(){var e=Date.now(),t=Qr.last||e;return Qr.last=e>t?e:t+1}function en(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"".concat(e).concat(Qr().toString(36))}function tn(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=t?[...e].reverse():e,n=new Set(r);return t?[...n].reverse():[...n]}function rn(){}function nn(e,t){return[...e].map(((e,t)=>({value:e,index:t}))).sort(((e,r)=>t(e.value,r.value)||e.index-r.index)).map((e=>e.value))}function on(e,t){var r,n=function(e){if(!_r(e))throw new Error("An invalid value was passed into this clone utility. Expected a plain object");return zt({},e)}(t),o=n,i=Bt(e.entries());try{for(i.s();!(r=i.n()).done;){var a=Pt(r.value,2),s=a[0],l=a[1],c=s>=e.length-1,u=o[l];if(c){if(Jr(o)){var h=Number.parseInt(l.toString(),10);Br(h)&&o.splice(h,1)}else Reflect.deleteProperty(o,l);return n}if(Fr(u))return n;u=Jr(u)?[...u]:zt({},u),o[l]=u,o=u}}catch(d){i.e(d)}finally{i.f()}return n}function an(e){return t=>function(e,t,r){if(!e||Zr(e))return zr(t)?r:t;$r(e)&&(e=e.split("."));for(var n=0,o=e.length;n<o&&t;++n){if(!_r(t)&&!Jr(t))return r;t=t[e[n]]}return zr(t)?r:t}(e,t)}function sn(e,t){return Br(t)?e<=t?Array.from({length:t+1-e},((t,r)=>r+e)):Array.from({length:e+1-t},((t,r)=>-1*r+e)):Array.from({length:Math.abs(e)},((t,r)=>(e<0?-1:1)*r))}function ln(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function cn(e){return Hr(e)?e():e}Qr.last=0;var un={};function hn(e,t){var r=un[e],n=r?"".concat(r,"\n\n"):"",o=t?"".concat(t,"\n\n"):"";return"".concat(n).concat(o,"For more information visit ").concat("https://remirror.io/docs/errors","#").concat(e.toLowerCase())}class dn extends rr.exports.BaseError{static create(){return new dn(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}constructor(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.code,n=t.message,o=t.disableLogging,i=void 0!==o&&o;!function(e){return $r(e)&&Rr(Nr(Qt),e)}(r)?super(hn(e=Qt.CUSTOM,n)):super(hn(e=r,n)),this.errorCode=e,this.url="".concat("https://remirror.io/docs/errors","#").concat(e.toLowerCase()),i||console.error(this.message)}}function pn(e,t){if(!e)throw dn.create({code:Qt.PROD})}function fn(e,t){var r=e.selection,n=e.doc,o=e.storedMarks;return zt(zt({},t),{},{schema:t.schema,plugins:t.plugins,apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return o},get selection(){return r},get doc(){return n},get tr(){return r=e.selection,n=e.doc,o=e.storedMarks,e}})}function vn(e){return t=>{var r=t.state,n=t.dispatch,o=t.view,i=t.tr;return e(fn(i,r),n,o)}}function mn(e){return t=>{var r;return void 0!==t.dispatch&&t.dispatch!==(null===(r=t.view)||void 0===r?void 0:r.dispatch)&&pn(!1),e(t)}}function gn(e){this.content=e}gn.prototype={constructor:gn,find:function(e){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===e)return t;return-1},get:function(e){var t=this.find(e);return-1==t?void 0:this.content[t+1]},update:function(e,t,r){var n=r&&r!=e?this.remove(r):this,o=n.find(e),i=n.content.slice();return-1==o?i.push(r||e,t):(i[o+1]=t,r&&(i[o]=r)),new gn(i)},remove:function(e){var t=this.find(e);if(-1==t)return this;var r=this.content.slice();return r.splice(t,2),new gn(r)},addToStart:function(e,t){return new gn([e,t].concat(this.remove(e).content))},addToEnd:function(e,t){var r=this.remove(e).content.slice();return r.push(e,t),new gn(r)},addBefore:function(e,t,r){var n=this.remove(t),o=n.content.slice(),i=n.find(e);return o.splice(-1==i?o.length:i,0,t,r),new gn(o)},forEach:function(e){for(var t=0;t<this.content.length;t+=2)e(this.content[t],this.content[t+1])},prepend:function(e){return(e=gn.from(e)).size?new gn(e.content.concat(this.subtract(e).content)):this},append:function(e){return(e=gn.from(e)).size?new gn(this.subtract(e).content.concat(e.content)):this},subtract:function(e){var t=this;e=gn.from(e);for(var r=0;r<e.content.length;r+=2)t=t.remove(e.content[r]);return t},get size(){return this.content.length>>1}},gn.from=function(e){if(e instanceof gn)return e;var t=[];if(e)for(var r in e)t.push(r,e[r]);return new gn(t)};var yn=gn;function wn(e,t,r){for(var n=0;;n++){if(n==e.childCount||n==t.childCount)return e.childCount==t.childCount?null:r;var o=e.child(n),i=t.child(n);if(o!=i){if(!o.sameMarkup(i))return r;if(o.isText&&o.text!=i.text){for(var a=0;o.text[a]==i.text[a];a++)r++;return r}if(o.content.size||i.content.size){var s=wn(o.content,i.content,r+1);if(null!=s)return s}r+=o.nodeSize}else r+=o.nodeSize}}function bn(e,t,r,n){for(var o=e.childCount,i=t.childCount;;){if(0==o||0==i)return o==i?null:{a:r,b:n};var a=e.child(--o),s=t.child(--i),l=a.nodeSize;if(a!=s){if(!a.sameMarkup(s))return{a:r,b:n};if(a.isText&&a.text!=s.text){for(var c=0,u=Math.min(a.text.length,s.text.length);c<u&&a.text[a.text.length-c-1]==s.text[s.text.length-c-1];)c++,r--,n--;return{a:r,b:n}}if(a.content.size||s.content.size){var h=bn(a.content,s.content,r-1,n-1);if(h)return h}r-=l,n-=l}else r-=l,n-=l}}var kn=function(e,t){if(this.content=e,this.size=t||0,null==t)for(var r=0;r<e.length;r++)this.size+=e[r].nodeSize},xn={firstChild:{configurable:!0},lastChild:{configurable:!0},childCount:{configurable:!0}};kn.prototype.nodesBetween=function(e,t,r,n,o){void 0===n&&(n=0);for(var i=0,a=0;a<t;i++){var s=this.content[i],l=a+s.nodeSize;if(l>e&&!1!==r(s,n+a,o,i)&&s.content.size){var c=a+1;s.nodesBetween(Math.max(0,e-c),Math.min(s.content.size,t-c),r,n+c)}a=l}},kn.prototype.descendants=function(e){this.nodesBetween(0,this.size,e)},kn.prototype.textBetween=function(e,t,r,n){var o="",i=!0;return this.nodesBetween(e,t,(function(a,s){a.isText?(o+=a.text.slice(Math.max(e,s)-s,t-s),i=!r):a.isLeaf&&n?(o+=n,i=!r):!i&&a.isBlock&&(o+=r,i=!0)}),0),o},kn.prototype.append=function(e){if(!e.size)return this;if(!this.size)return e;var t=this.lastChild,r=e.firstChild,n=this.content.slice(),o=0;for(t.isText&&t.sameMarkup(r)&&(n[n.length-1]=t.withText(t.text+r.text),o=1);o<e.content.length;o++)n.push(e.content[o]);return new kn(n,this.size+e.size)},kn.prototype.cut=function(e,t){if(null==t&&(t=this.size),0==e&&t==this.size)return this;var r=[],n=0;if(t>e)for(var o=0,i=0;i<t;o++){var a=this.content[o],s=i+a.nodeSize;s>e&&((i<e||s>t)&&(a=a.isText?a.cut(Math.max(0,e-i),Math.min(a.text.length,t-i)):a.cut(Math.max(0,e-i-1),Math.min(a.content.size,t-i-1))),r.push(a),n+=a.nodeSize),i=s}return new kn(r,n)},kn.prototype.cutByIndex=function(e,t){return e==t?kn.empty:0==e&&t==this.content.length?this:new kn(this.content.slice(e,t))},kn.prototype.replaceChild=function(e,t){var r=this.content[e];if(r==t)return this;var n=this.content.slice(),o=this.size+t.nodeSize-r.nodeSize;return n[e]=t,new kn(n,o)},kn.prototype.addToStart=function(e){return new kn([e].concat(this.content),this.size+e.nodeSize)},kn.prototype.addToEnd=function(e){return new kn(this.content.concat(e),this.size+e.nodeSize)},kn.prototype.eq=function(e){if(this.content.length!=e.content.length)return!1;for(var t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0},xn.firstChild.get=function(){return this.content.length?this.content[0]:null},xn.lastChild.get=function(){return this.content.length?this.content[this.content.length-1]:null},xn.childCount.get=function(){return this.content.length},kn.prototype.child=function(e){var t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t},kn.prototype.maybeChild=function(e){return this.content[e]},kn.prototype.forEach=function(e){for(var t=0,r=0;t<this.content.length;t++){var n=this.content[t];e(n,r,t),r+=n.nodeSize}},kn.prototype.findDiffStart=function(e,t){return void 0===t&&(t=0),wn(this,e,t)},kn.prototype.findDiffEnd=function(e,t,r){return void 0===t&&(t=this.size),void 0===r&&(r=e.size),bn(this,e,t,r)},kn.prototype.findIndex=function(e,t){if(void 0===t&&(t=-1),0==e)return Mn(0,e);if(e==this.size)return Mn(this.content.length,e);if(e>this.size||e<0)throw new RangeError("Position "+e+" outside of fragment ("+this+")");for(var r=0,n=0;;r++){var o=n+this.child(r).nodeSize;if(o>=e)return o==e||t>0?Mn(r+1,o):Mn(r,n);n=o}},kn.prototype.toString=function(){return"<"+this.toStringInner()+">"},kn.prototype.toStringInner=function(){return this.content.join(", ")},kn.prototype.toJSON=function(){return this.content.length?this.content.map((function(e){return e.toJSON()})):null},kn.fromJSON=function(e,t){if(!t)return kn.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new kn(t.map(e.nodeFromJSON))},kn.fromArray=function(e){if(!e.length)return kn.empty;for(var t,r=0,n=0;n<e.length;n++){var o=e[n];r+=o.nodeSize,n&&o.isText&&e[n-1].sameMarkup(o)?(t||(t=e.slice(0,n)),t[t.length-1]=o.withText(t[t.length-1].text+o.text)):t&&t.push(o)}return new kn(t||e,r)},kn.from=function(e){if(!e)return kn.empty;if(e instanceof kn)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new kn([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))},Object.defineProperties(kn.prototype,xn);var Sn={index:0,offset:0};function Mn(e,t){return Sn.index=e,Sn.offset=t,Sn}function Cn(e,t){if(e===t)return!0;if(!e||"object"!=typeof e||!t||"object"!=typeof t)return!1;var r=Array.isArray(e);if(Array.isArray(t)!=r)return!1;if(r){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(!Cn(e[n],t[n]))return!1}else{for(var o in e)if(!(o in t)||!Cn(e[o],t[o]))return!1;for(var i in t)if(!(i in e))return!1}return!0}kn.empty=new kn([],0);var On=function(e,t){this.type=e,this.attrs=t};function En(e){var t=Error.call(this,e);return t.__proto__=En.prototype,t}On.prototype.addToSet=function(e){for(var t,r=!1,n=0;n<e.length;n++){var o=e[n];if(this.eq(o))return e;if(this.type.excludes(o.type))t||(t=e.slice(0,n));else{if(o.type.excludes(this.type))return e;!r&&o.type.rank>this.type.rank&&(t||(t=e.slice(0,n)),t.push(this),r=!0),t&&t.push(o)}}return t||(t=e.slice()),r||t.push(this),t},On.prototype.removeFromSet=function(e){for(var t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e},On.prototype.isInSet=function(e){for(var t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1},On.prototype.eq=function(e){return this==e||this.type==e.type&&Cn(this.attrs,e.attrs)},On.prototype.toJSON=function(){var e={type:this.type.name};for(var t in this.attrs){e.attrs=this.attrs;break}return e},On.fromJSON=function(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");var r=e.marks[t.type];if(!r)throw new RangeError("There is no mark type "+t.type+" in this schema");return r.create(t.attrs)},On.sameSet=function(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(var r=0;r<e.length;r++)if(!e[r].eq(t[r]))return!1;return!0},On.setFrom=function(e){if(!e||0==e.length)return On.none;if(e instanceof On)return[e];var t=e.slice();return t.sort((function(e,t){return e.type.rank-t.type.rank})),t},On.none=[],En.prototype=Object.create(Error.prototype),En.prototype.constructor=En,En.prototype.name="ReplaceError";var An=function(e,t,r){this.content=e,this.openStart=t,this.openEnd=r},Nn={size:{configurable:!0}};function Rn(e,t,r){var n=e.findIndex(t),o=n.index,i=n.offset,a=e.maybeChild(o),s=e.findIndex(r),l=s.index,c=s.offset;if(i==t||a.isText){if(c!=r&&!e.child(l).isText)throw new RangeError("Removing non-flat range");return e.cut(0,t).append(e.cut(r))}if(o!=l)throw new RangeError("Removing non-flat range");return e.replaceChild(o,a.copy(Rn(a.content,t-i-1,r-i-1)))}function Tn(e,t,r,n){var o=e.findIndex(t),i=o.index,a=o.offset,s=e.maybeChild(i);if(a==t||s.isText)return n&&!n.canReplace(i,i,r)?null:e.cut(0,t).append(r).append(e.cut(t));var l=Tn(s.content,t-a-1,r);return l&&e.replaceChild(i,s.copy(l))}function Dn(e,t,r){if(r.openStart>e.depth)throw new En("Inserted content deeper than insertion position");if(e.depth-r.openStart!=t.depth-r.openEnd)throw new En("Inconsistent open depths");return Pn(e,t,r,0)}function Pn(e,t,r,n){var o=e.index(n),i=e.node(n);if(o==t.index(n)&&n<e.depth-r.openStart){var a=Pn(e,t,r,n+1);return i.copy(i.content.replaceChild(o,a))}if(r.content.size){if(r.openStart||r.openEnd||e.depth!=n||t.depth!=n){var s=function(e,t){for(var r=t.depth-e.openStart,n=t.node(r).copy(e.content),o=r-1;o>=0;o--)n=t.node(o).copy(kn.from(n));return{start:n.resolveNoCache(e.openStart+r),end:n.resolveNoCache(n.content.size-e.openEnd-r)}}(r,e);return Bn(i,Hn(e,s.start,s.end,t,n))}var l=e.parent,c=l.content;return Bn(l,c.cut(0,e.parentOffset).append(r.content).append(c.cut(t.parentOffset)))}return Bn(i,Ln(e,t,n))}function In(e,t){if(!t.type.compatibleContent(e.type))throw new En("Cannot join "+t.type.name+" onto "+e.type.name)}function Vn(e,t,r){var n=e.node(r);return In(n,t.node(r)),n}function zn(e,t){var r=t.length-1;r>=0&&e.isText&&e.sameMarkup(t[r])?t[r]=e.withText(t[r].text+e.text):t.push(e)}function $n(e,t,r,n){var o=(t||e).node(r),i=0,a=t?t.index(r):o.childCount;e&&(i=e.index(r),e.depth>r?i++:e.textOffset&&(zn(e.nodeAfter,n),i++));for(var s=i;s<a;s++)zn(o.child(s),n);t&&t.depth==r&&t.textOffset&&zn(t.nodeBefore,n)}function Bn(e,t){if(!e.type.validContent(t))throw new En("Invalid content for node "+e.type.name);return e.copy(t)}function Hn(e,t,r,n,o){var i=e.depth>o&&Vn(e,t,o+1),a=n.depth>o&&Vn(r,n,o+1),s=[];return $n(null,e,o,s),i&&a&&t.index(o)==r.index(o)?(In(i,a),zn(Bn(i,Hn(e,t,r,n,o+1)),s)):(i&&zn(Bn(i,Ln(e,t,o+1)),s),$n(t,r,o,s),a&&zn(Bn(a,Ln(r,n,o+1)),s)),$n(n,null,o,s),new kn(s)}function Ln(e,t,r){var n=[];($n(null,e,r,n),e.depth>r)&&zn(Bn(Vn(e,t,r+1),Ln(e,t,r+1)),n);return $n(t,null,r,n),new kn(n)}Nn.size.get=function(){return this.content.size-this.openStart-this.openEnd},An.prototype.insertAt=function(e,t){var r=Tn(this.content,e+this.openStart,t,null);return r&&new An(r,this.openStart,this.openEnd)},An.prototype.removeBetween=function(e,t){return new An(Rn(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)},An.prototype.eq=function(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd},An.prototype.toString=function(){return this.content+"("+this.openStart+","+this.openEnd+")"},An.prototype.toJSON=function(){if(!this.content.size)return null;var e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e},An.fromJSON=function(e,t){if(!t)return An.empty;var r=t.openStart||0,n=t.openEnd||0;if("number"!=typeof r||"number"!=typeof n)throw new RangeError("Invalid input for Slice.fromJSON");return new An(kn.fromJSON(e,t.content),r,n)},An.maxOpen=function(e,t){void 0===t&&(t=!0);for(var r=0,n=0,o=e.firstChild;o&&!o.isLeaf&&(t||!o.type.spec.isolating);o=o.firstChild)r++;for(var i=e.lastChild;i&&!i.isLeaf&&(t||!i.type.spec.isolating);i=i.lastChild)n++;return new An(e,r,n)},Object.defineProperties(An.prototype,Nn),An.empty=new An(kn.empty,0,0);var _n=function(e,t,r){this.pos=e,this.path=t,this.depth=t.length/3-1,this.parentOffset=r},Fn={parent:{configurable:!0},doc:{configurable:!0},textOffset:{configurable:!0},nodeAfter:{configurable:!0},nodeBefore:{configurable:!0}};_n.prototype.resolveDepth=function(e){return null==e?this.depth:e<0?this.depth+e:e},Fn.parent.get=function(){return this.node(this.depth)},Fn.doc.get=function(){return this.node(0)},_n.prototype.node=function(e){return this.path[3*this.resolveDepth(e)]},_n.prototype.index=function(e){return this.path[3*this.resolveDepth(e)+1]},_n.prototype.indexAfter=function(e){return e=this.resolveDepth(e),this.index(e)+(e!=this.depth||this.textOffset?1:0)},_n.prototype.start=function(e){return 0==(e=this.resolveDepth(e))?0:this.path[3*e-1]+1},_n.prototype.end=function(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size},_n.prototype.before=function(e){if(!(e=this.resolveDepth(e)))throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]},_n.prototype.after=function(e){if(!(e=this.resolveDepth(e)))throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]+this.path[3*e].nodeSize},Fn.textOffset.get=function(){return this.pos-this.path[this.path.length-1]},Fn.nodeAfter.get=function(){var e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;var r=this.pos-this.path[this.path.length-1],n=e.child(t);return r?e.child(t).cut(r):n},Fn.nodeBefore.get=function(){var e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):0==e?null:this.parent.child(e-1)},_n.prototype.posAtIndex=function(e,t){t=this.resolveDepth(t);for(var r=this.path[3*t],n=0==t?0:this.path[3*t-1]+1,o=0;o<e;o++)n+=r.child(o).nodeSize;return n},_n.prototype.marks=function(){var e=this.parent,t=this.index();if(0==e.content.size)return On.none;if(this.textOffset)return e.child(t).marks;var r=e.maybeChild(t-1),n=e.maybeChild(t);if(!r){var o=r;r=n,n=o}for(var i=r.marks,a=0;a<i.length;a++)!1!==i[a].type.spec.inclusive||n&&i[a].isInSet(n.marks)||(i=i[a--].removeFromSet(i));return i},_n.prototype.marksAcross=function(e){var t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;for(var r=t.marks,n=e.parent.maybeChild(e.index()),o=0;o<r.length;o++)!1!==r[o].type.spec.inclusive||n&&r[o].isInSet(n.marks)||(r=r[o--].removeFromSet(r));return r},_n.prototype.sharedDepth=function(e){for(var t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0},_n.prototype.blockRange=function(e,t){if(void 0===e&&(e=this),e.pos<this.pos)return e.blockRange(this);for(var r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!t||t(this.node(r))))return new Un(this,e,r)},_n.prototype.sameParent=function(e){return this.pos-this.parentOffset==e.pos-e.parentOffset},_n.prototype.max=function(e){return e.pos>this.pos?e:this},_n.prototype.min=function(e){return e.pos<this.pos?e:this},_n.prototype.toString=function(){for(var e="",t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset},_n.resolve=function(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");for(var r=[],n=0,o=t,i=e;;){var a=i.content.findIndex(o),s=a.index,l=a.offset,c=o-l;if(r.push(i,s,n+l),!c)break;if((i=i.child(s)).isText)break;o=c-1,n+=l+1}return new _n(t,r,o)},_n.resolveCached=function(e,t){for(var r=0;r<jn.length;r++){var n=jn[r];if(n.pos==t&&n.doc==e)return n}var o=jn[Wn]=_n.resolve(e,t);return Wn=(Wn+1)%Kn,o},Object.defineProperties(_n.prototype,Fn);var jn=[],Wn=0,Kn=12,Un=function(e,t,r){this.$from=e,this.$to=t,this.depth=r},qn={start:{configurable:!0},end:{configurable:!0},parent:{configurable:!0},startIndex:{configurable:!0},endIndex:{configurable:!0}};qn.start.get=function(){return this.$from.before(this.depth+1)},qn.end.get=function(){return this.$to.after(this.depth+1)},qn.parent.get=function(){return this.$from.node(this.depth)},qn.startIndex.get=function(){return this.$from.index(this.depth)},qn.endIndex.get=function(){return this.$to.indexAfter(this.depth)},Object.defineProperties(Un.prototype,qn);var Jn=Object.create(null),Zn=function(e,t,r,n){this.type=e,this.attrs=t,this.content=r||kn.empty,this.marks=n||On.none},Gn={nodeSize:{configurable:!0},childCount:{configurable:!0},textContent:{configurable:!0},firstChild:{configurable:!0},lastChild:{configurable:!0},isBlock:{configurable:!0},isTextblock:{configurable:!0},inlineContent:{configurable:!0},isInline:{configurable:!0},isText:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};Gn.nodeSize.get=function(){return this.isLeaf?1:2+this.content.size},Gn.childCount.get=function(){return this.content.childCount},Zn.prototype.child=function(e){return this.content.child(e)},Zn.prototype.maybeChild=function(e){return this.content.maybeChild(e)},Zn.prototype.forEach=function(e){this.content.forEach(e)},Zn.prototype.nodesBetween=function(e,t,r,n){void 0===n&&(n=0),this.content.nodesBetween(e,t,r,n,this)},Zn.prototype.descendants=function(e){this.nodesBetween(0,this.content.size,e)},Gn.textContent.get=function(){return this.textBetween(0,this.content.size,"")},Zn.prototype.textBetween=function(e,t,r,n){return this.content.textBetween(e,t,r,n)},Gn.firstChild.get=function(){return this.content.firstChild},Gn.lastChild.get=function(){return this.content.lastChild},Zn.prototype.eq=function(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)},Zn.prototype.sameMarkup=function(e){return this.hasMarkup(e.type,e.attrs,e.marks)},Zn.prototype.hasMarkup=function(e,t,r){return this.type==e&&Cn(this.attrs,t||e.defaultAttrs||Jn)&&On.sameSet(this.marks,r||On.none)},Zn.prototype.copy=function(e){return void 0===e&&(e=null),e==this.content?this:new this.constructor(this.type,this.attrs,e,this.marks)},Zn.prototype.mark=function(e){return e==this.marks?this:new this.constructor(this.type,this.attrs,this.content,e)},Zn.prototype.cut=function(e,t){return 0==e&&t==this.content.size?this:this.copy(this.content.cut(e,t))},Zn.prototype.slice=function(e,t,r){if(void 0===t&&(t=this.content.size),void 0===r&&(r=!1),e==t)return An.empty;var n=this.resolve(e),o=this.resolve(t),i=r?0:n.sharedDepth(t),a=n.start(i),s=n.node(i).content.cut(n.pos-a,o.pos-a);return new An(s,n.depth-i,o.depth-i)},Zn.prototype.replace=function(e,t,r){return Dn(this.resolve(e),this.resolve(t),r)},Zn.prototype.nodeAt=function(e){for(var t=this;;){var r=t.content.findIndex(e),n=r.index,o=r.offset;if(!(t=t.maybeChild(n)))return null;if(o==e||t.isText)return t;e-=o+1}},Zn.prototype.childAfter=function(e){var t=this.content.findIndex(e),r=t.index,n=t.offset;return{node:this.content.maybeChild(r),index:r,offset:n}},Zn.prototype.childBefore=function(e){if(0==e)return{node:null,index:0,offset:0};var t=this.content.findIndex(e),r=t.index,n=t.offset;if(n<e)return{node:this.content.child(r),index:r,offset:n};var o=this.content.child(r-1);return{node:o,index:r-1,offset:n-o.nodeSize}},Zn.prototype.resolve=function(e){return _n.resolveCached(this,e)},Zn.prototype.resolveNoCache=function(e){return _n.resolve(this,e)},Zn.prototype.rangeHasMark=function(e,t,r){var n=!1;return t>e&&this.nodesBetween(e,t,(function(e){return r.isInSet(e.marks)&&(n=!0),!n})),n},Gn.isBlock.get=function(){return this.type.isBlock},Gn.isTextblock.get=function(){return this.type.isTextblock},Gn.inlineContent.get=function(){return this.type.inlineContent},Gn.isInline.get=function(){return this.type.isInline},Gn.isText.get=function(){return this.type.isText},Gn.isLeaf.get=function(){return this.type.isLeaf},Gn.isAtom.get=function(){return this.type.isAtom},Zn.prototype.toString=function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),Yn(this.marks,e)},Zn.prototype.contentMatchAt=function(e){var t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t},Zn.prototype.canReplace=function(e,t,r,n,o){void 0===r&&(r=kn.empty),void 0===n&&(n=0),void 0===o&&(o=r.childCount);var i=this.contentMatchAt(e).matchFragment(r,n,o),a=i&&i.matchFragment(this.content,t);if(!a||!a.validEnd)return!1;for(var s=n;s<o;s++)if(!this.type.allowsMarks(r.child(s).marks))return!1;return!0},Zn.prototype.canReplaceWith=function(e,t,r,n){if(n&&!this.type.allowsMarks(n))return!1;var o=this.contentMatchAt(e).matchType(r),i=o&&o.matchFragment(this.content,t);return!!i&&i.validEnd},Zn.prototype.canAppend=function(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)},Zn.prototype.check=function(){if(!this.type.validContent(this.content))throw new RangeError("Invalid content for node "+this.type.name+": "+this.content.toString().slice(0,50));for(var e=On.none,t=0;t<this.marks.length;t++)e=this.marks[t].addToSet(e);if(!On.sameSet(e,this.marks))throw new RangeError("Invalid collection of marks for node "+this.type.name+": "+this.marks.map((function(e){return e.type.name})));this.content.forEach((function(e){return e.check()}))},Zn.prototype.toJSON=function(){var e={type:this.type.name};for(var t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map((function(e){return e.toJSON()}))),e},Zn.fromJSON=function(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");var r=null;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=t.marks.map(e.markFromJSON)}if("text"==t.type){if("string"!=typeof t.text)throw new RangeError("Invalid text node in JSON");return e.text(t.text,r)}var n=kn.fromJSON(e,t.content);return e.nodeType(t.type).create(t.attrs,n,r)},Object.defineProperties(Zn.prototype,Gn);var Xn=function(e){function t(t,r,n,o){if(e.call(this,t,r,null,o),!n)throw new RangeError("Empty text nodes are not allowed");this.text=n}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var r={textContent:{configurable:!0},nodeSize:{configurable:!0}};return t.prototype.toString=function(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):Yn(this.marks,JSON.stringify(this.text))},r.textContent.get=function(){return this.text},t.prototype.textBetween=function(e,t){return this.text.slice(e,t)},r.nodeSize.get=function(){return this.text.length},t.prototype.mark=function(e){return e==this.marks?this:new t(this.type,this.attrs,this.text,e)},t.prototype.withText=function(e){return e==this.text?this:new t(this.type,this.attrs,e,this.marks)},t.prototype.cut=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=this.text.length),0==e&&t==this.text.length?this:this.withText(this.text.slice(e,t))},t.prototype.eq=function(e){return this.sameMarkup(e)&&this.text==e.text},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.text=this.text,t},Object.defineProperties(t.prototype,r),t}(Zn);function Yn(e,t){for(var r=e.length-1;r>=0;r--)t=e[r].type.name+"("+t+")";return t}var Qn=function(e){this.validEnd=e,this.next=[],this.wrapCache=[]},eo={inlineContent:{configurable:!0},defaultType:{configurable:!0},edgeCount:{configurable:!0}};Qn.parse=function(e,t){var r=new to(e,t);if(null==r.next)return Qn.empty;var n=no(r);r.next&&r.err("Unexpected trailing text");var o=function(e){var t=Object.create(null);return r(co(e,0));function r(n){var o=[];n.forEach((function(t){e[t].forEach((function(t){var r=t.term,n=t.to;if(r){var i=o.indexOf(r),a=i>-1&&o[i+1];co(e,n).forEach((function(e){a||o.push(r,a=[]),-1==a.indexOf(e)&&a.push(e)}))}}))}));for(var i=t[n.join(",")]=new Qn(n.indexOf(e.length-1)>-1),a=0;a<o.length;a+=2){var s=o[a+1].sort(lo);i.next.push(o[a],t[s.join(",")]||r(s))}return i}}(function(e){var t=[[]];return o(i(e,0),r()),t;function r(){return t.push([])-1}function n(e,r,n){var o={term:n,to:r};return t[e].push(o),o}function o(e,t){e.forEach((function(e){return e.to=t}))}function i(e,t){if("choice"==e.type)return e.exprs.reduce((function(e,r){return e.concat(i(r,t))}),[]);if("seq"==e.type)for(var a=0;;a++){var s=i(e.exprs[a],t);if(a==e.exprs.length-1)return s;o(s,t=r())}else{if("star"==e.type){var l=r();return n(t,l),o(i(e.expr,l),l),[n(l)]}if("plus"==e.type){var c=r();return o(i(e.expr,t),c),o(i(e.expr,c),c),[n(c)]}if("opt"==e.type)return[n(t)].concat(i(e.expr,t));if("range"==e.type){for(var u=t,h=0;h<e.min;h++){var d=r();o(i(e.expr,u),d),u=d}if(-1==e.max)o(i(e.expr,u),u);else for(var p=e.min;p<e.max;p++){var f=r();n(u,f),o(i(e.expr,u),f),u=f}return[n(u)]}if("name"==e.type)return[n(t,null,e.value)]}}}(n));return function(e,t){for(var r=0,n=[e];r<n.length;r++){for(var o=n[r],i=!o.validEnd,a=[],s=0;s<o.next.length;s+=2){var l=o.next[s],c=o.next[s+1];a.push(l.name),!i||l.isText||l.hasRequiredAttrs()||(i=!1),-1==n.indexOf(c)&&n.push(c)}i&&t.err("Only non-generatable nodes ("+a.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(o,r),o},Qn.prototype.matchType=function(e){for(var t=0;t<this.next.length;t+=2)if(this.next[t]==e)return this.next[t+1];return null},Qn.prototype.matchFragment=function(e,t,r){void 0===t&&(t=0),void 0===r&&(r=e.childCount);for(var n=this,o=t;n&&o<r;o++)n=n.matchType(e.child(o).type);return n},eo.inlineContent.get=function(){var e=this.next[0];return!!e&&e.isInline},eo.defaultType.get=function(){for(var e=0;e<this.next.length;e+=2){var t=this.next[e];if(!t.isText&&!t.hasRequiredAttrs())return t}},Qn.prototype.compatible=function(e){for(var t=0;t<this.next.length;t+=2)for(var r=0;r<e.next.length;r+=2)if(this.next[t]==e.next[r])return!0;return!1},Qn.prototype.fillBefore=function(e,t,r){void 0===t&&(t=!1),void 0===r&&(r=0);var n=[this];return function o(i,a){var s=i.matchFragment(e,r);if(s&&(!t||s.validEnd))return kn.from(a.map((function(e){return e.createAndFill()})));for(var l=0;l<i.next.length;l+=2){var c=i.next[l],u=i.next[l+1];if(!c.isText&&!c.hasRequiredAttrs()&&-1==n.indexOf(u)){n.push(u);var h=o(u,a.concat(c));if(h)return h}}}(this,[])},Qn.prototype.findWrapping=function(e){for(var t=0;t<this.wrapCache.length;t+=2)if(this.wrapCache[t]==e)return this.wrapCache[t+1];var r=this.computeWrapping(e);return this.wrapCache.push(e,r),r},Qn.prototype.computeWrapping=function(e){for(var t=Object.create(null),r=[{match:this,type:null,via:null}];r.length;){var n=r.shift(),o=n.match;if(o.matchType(e)){for(var i=[],a=n;a.type;a=a.via)i.push(a.type);return i.reverse()}for(var s=0;s<o.next.length;s+=2){var l=o.next[s];l.isLeaf||l.hasRequiredAttrs()||l.name in t||n.type&&!o.next[s+1].validEnd||(r.push({match:l.contentMatch,type:l,via:n}),t[l.name]=!0)}}},eo.edgeCount.get=function(){return this.next.length>>1},Qn.prototype.edge=function(e){var t=e<<1;if(t>=this.next.length)throw new RangeError("There's no "+e+"th edge in this content match");return{type:this.next[t],next:this.next[t+1]}},Qn.prototype.toString=function(){var e=[];return function t(r){e.push(r);for(var n=1;n<r.next.length;n+=2)-1==e.indexOf(r.next[n])&&t(r.next[n])}(this),e.map((function(t,r){for(var n=r+(t.validEnd?"*":" ")+" ",o=0;o<t.next.length;o+=2)n+=(o?", ":"")+t.next[o].name+"->"+e.indexOf(t.next[o+1]);return n})).join("\n")},Object.defineProperties(Qn.prototype,eo),Qn.empty=new Qn(!0);var to=function(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()},ro={next:{configurable:!0}};function no(e){var t=[];do{t.push(oo(e))}while(e.eat("|"));return 1==t.length?t[0]:{type:"choice",exprs:t}}function oo(e){var t=[];do{t.push(io(e))}while(e.next&&")"!=e.next&&"|"!=e.next);return 1==t.length?t[0]:{type:"seq",exprs:t}}function io(e){for(var t=function(e){if(e.eat("(")){var t=no(e);return e.eat(")")||e.err("Missing closing paren"),t}if(!/\W/.test(e.next)){var r=function(e,t){var r=e.nodeTypes,n=r[t];if(n)return[n];var o=[];for(var i in r){var a=r[i];a.groups.indexOf(t)>-1&&o.push(a)}0==o.length&&e.err("No node type or group '"+t+"' found");return o}(e,e.next).map((function(t){return null==e.inline?e.inline=t.isInline:e.inline!=t.isInline&&e.err("Mixing inline and block content"),{type:"name",value:t}}));return e.pos++,1==r.length?r[0]:{type:"choice",exprs:r}}e.err("Unexpected token '"+e.next+"'")}(e);;)if(e.eat("+"))t={type:"plus",expr:t};else if(e.eat("*"))t={type:"star",expr:t};else if(e.eat("?"))t={type:"opt",expr:t};else{if(!e.eat("{"))break;t=so(e,t)}return t}function ao(e){/\D/.test(e.next)&&e.err("Expected number, got '"+e.next+"'");var t=Number(e.next);return e.pos++,t}function so(e,t){var r=ao(e),n=r;return e.eat(",")&&(n="}"!=e.next?ao(e):-1),e.eat("}")||e.err("Unclosed braced range"),{type:"range",min:r,max:n,expr:t}}function lo(e,t){return t-e}function co(e,t){var r=[];return function t(n){var o=e[n];if(1==o.length&&!o[0].term)return t(o[0].to);r.push(n);for(var i=0;i<o.length;i++){var a=o[i],s=a.term,l=a.to;s||-1!=r.indexOf(l)||t(l)}}(t),r.sort(lo)}function uo(e){var t=Object.create(null);for(var r in e){var n=e[r];if(!n.hasDefault)return null;t[r]=n.default}return t}function ho(e,t){var r=Object.create(null);for(var n in e){var o=t&&t[n];if(void 0===o){var i=e[n];if(!i.hasDefault)throw new RangeError("No value supplied for attribute "+n);o=i.default}r[n]=o}return r}function po(e){var t=Object.create(null);if(e)for(var r in e)t[r]=new mo(e[r]);return t}ro.next.get=function(){return this.tokens[this.pos]},to.prototype.eat=function(e){return this.next==e&&(this.pos++||!0)},to.prototype.err=function(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")},Object.defineProperties(to.prototype,ro);var fo=function(e,t,r){this.name=e,this.schema=t,this.spec=r,this.groups=r.group?r.group.split(" "):[],this.attrs=po(r.attrs),this.defaultAttrs=uo(this.attrs),this.contentMatch=null,this.markSet=null,this.inlineContent=null,this.isBlock=!(r.inline||"text"==e),this.isText="text"==e},vo={isInline:{configurable:!0},isTextblock:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};vo.isInline.get=function(){return!this.isBlock},vo.isTextblock.get=function(){return this.isBlock&&this.inlineContent},vo.isLeaf.get=function(){return this.contentMatch==Qn.empty},vo.isAtom.get=function(){return this.isLeaf||this.spec.atom},fo.prototype.hasRequiredAttrs=function(){for(var e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1},fo.prototype.compatibleContent=function(e){return this==e||this.contentMatch.compatible(e.contentMatch)},fo.prototype.computeAttrs=function(e){return!e&&this.defaultAttrs?this.defaultAttrs:ho(this.attrs,e)},fo.prototype.create=function(e,t,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Zn(this,this.computeAttrs(e),kn.from(t),On.setFrom(r))},fo.prototype.createChecked=function(e,t,r){if(t=kn.from(t),!this.validContent(t))throw new RangeError("Invalid content for node "+this.name);return new Zn(this,this.computeAttrs(e),t,On.setFrom(r))},fo.prototype.createAndFill=function(e,t,r){if(e=this.computeAttrs(e),(t=kn.from(t)).size){var n=this.contentMatch.fillBefore(t);if(!n)return null;t=n.append(t)}var o=this.contentMatch.matchFragment(t).fillBefore(kn.empty,!0);return o?new Zn(this,e,t.append(o),On.setFrom(r)):null},fo.prototype.validContent=function(e){var t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(var r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0},fo.prototype.allowsMarkType=function(e){return null==this.markSet||this.markSet.indexOf(e)>-1},fo.prototype.allowsMarks=function(e){if(null==this.markSet)return!0;for(var t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0},fo.prototype.allowedMarks=function(e){if(null==this.markSet)return e;for(var t,r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?t&&t.push(e[r]):t||(t=e.slice(0,r));return t?t.length?t:On.empty:e},fo.compile=function(e,t){var r=Object.create(null);e.forEach((function(e,n){return r[e]=new fo(e,t,n)}));var n=t.spec.topNode||"doc";if(!r[n])throw new RangeError("Schema is missing its top node type ('"+n+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(var o in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r},Object.defineProperties(fo.prototype,vo);var mo=function(e){this.hasDefault=Object.prototype.hasOwnProperty.call(e,"default"),this.default=e.default},go={isRequired:{configurable:!0}};go.isRequired.get=function(){return!this.hasDefault},Object.defineProperties(mo.prototype,go);var yo=function(e,t,r,n){this.name=e,this.schema=r,this.spec=n,this.attrs=po(n.attrs),this.rank=t,this.excluded=null;var o=uo(this.attrs);this.instance=o&&new On(this,o)};yo.prototype.create=function(e){return!e&&this.instance?this.instance:new On(this,ho(this.attrs,e))},yo.compile=function(e,t){var r=Object.create(null),n=0;return e.forEach((function(e,o){return r[e]=new yo(e,n++,t,o)})),r},yo.prototype.removeFromSet=function(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e},yo.prototype.isInSet=function(e){for(var t=0;t<e.length;t++)if(e[t].type==this)return e[t]},yo.prototype.excludes=function(e){return this.excluded.indexOf(e)>-1};var wo=function(e){for(var t in this.spec={},e)this.spec[t]=e[t];this.spec.nodes=yn.from(e.nodes),this.spec.marks=yn.from(e.marks),this.nodes=fo.compile(this.spec.nodes,this),this.marks=yo.compile(this.spec.marks,this);var r=Object.create(null);for(var n in this.nodes){if(n in this.marks)throw new RangeError(n+" can not be both a node and a mark");var o=this.nodes[n],i=o.spec.content||"",a=o.spec.marks;o.contentMatch=r[i]||(r[i]=Qn.parse(i,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.markSet="_"==a?null:a?bo(this,a.split(" ")):""!=a&&o.inlineContent?null:[]}for(var s in this.marks){var l=this.marks[s],c=l.spec.excludes;l.excluded=null==c?[l]:""==c?[]:bo(this,c.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached=Object.create(null),this.cached.wrappings=Object.create(null)};function bo(e,t){for(var r=[],n=0;n<t.length;n++){var o=t[n],i=e.marks[o],a=i;if(i)r.push(i);else for(var s in e.marks){var l=e.marks[s];("_"==o||l.spec.group&&l.spec.group.split(" ").indexOf(o)>-1)&&r.push(a=l)}if(!a)throw new SyntaxError("Unknown mark type: '"+t[n]+"'")}return r}wo.prototype.node=function(e,t,r,n){if("string"==typeof e)e=this.nodeType(e);else{if(!(e instanceof fo))throw new RangeError("Invalid node type: "+e);if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}return e.createChecked(t,r,n)},wo.prototype.text=function(e,t){var r=this.nodes.text;return new Xn(r,r.defaultAttrs,e,On.setFrom(t))},wo.prototype.mark=function(e,t){return"string"==typeof e&&(e=this.marks[e]),e.create(t)},wo.prototype.nodeFromJSON=function(e){return Zn.fromJSON(this,e)},wo.prototype.markFromJSON=function(e){return On.fromJSON(this,e)},wo.prototype.nodeType=function(e){var t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t};var ko=function(e,t){var r=this;this.schema=e,this.rules=t,this.tags=[],this.styles=[],t.forEach((function(e){e.tag?r.tags.push(e):e.style&&r.styles.push(e)})),this.normalizeLists=!this.tags.some((function(t){if(!/^(ul|ol)\b/.test(t.tag)||!t.node)return!1;var r=e.nodes[t.node];return r.contentMatch.matchType(r)}))};ko.prototype.parse=function(e,t){void 0===t&&(t={});var r=new Eo(this,t,!1);return r.addAll(e,null,t.from,t.to),r.finish()},ko.prototype.parseSlice=function(e,t){void 0===t&&(t={});var r=new Eo(this,t,!0);return r.addAll(e,null,t.from,t.to),An.maxOpen(r.finish())},ko.prototype.matchTag=function(e,t,r){for(var n=r?this.tags.indexOf(r)+1:0;n<this.tags.length;n++){var o=this.tags[n];if(No(e,o.tag)&&(void 0===o.namespace||e.namespaceURI==o.namespace)&&(!o.context||t.matchesContext(o.context))){if(o.getAttrs){var i=o.getAttrs(e);if(!1===i)continue;o.attrs=i}return o}}},ko.prototype.matchStyle=function(e,t,r,n){for(var o=n?this.styles.indexOf(n)+1:0;o<this.styles.length;o++){var i=this.styles[o];if(!(0!=i.style.indexOf(e)||i.context&&!r.matchesContext(i.context)||i.style.length>e.length&&(61!=i.style.charCodeAt(e.length)||i.style.slice(e.length+1)!=t))){if(i.getAttrs){var a=i.getAttrs(t);if(!1===a)continue;i.attrs=a}return i}}},ko.schemaRules=function(e){var t=[];function r(e){for(var r=null==e.priority?50:e.priority,n=0;n<t.length;n++){var o=t[n];if((null==o.priority?50:o.priority)<r)break}t.splice(n,0,e)}var n=function(t){var n=e.marks[t].spec.parseDOM;n&&n.forEach((function(e){r(e=Ro(e)),e.mark=t}))};for(var o in e.marks)n(o);var i;for(var a in e.nodes)i=void 0,(i=e.nodes[a].spec.parseDOM)&&i.forEach((function(e){r(e=Ro(e)),e.node=a}));return t},ko.fromSchema=function(e){return e.cached.domParser||(e.cached.domParser=new ko(e,ko.schemaRules(e)))};var xo={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},So={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Mo={ol:!0,ul:!0};function Co(e){return(e?1:0)|("full"===e?2:0)}var Oo=function(e,t,r,n,o,i,a){this.type=e,this.attrs=t,this.solid=o,this.match=i||(4&a?null:e.contentMatch),this.options=a,this.content=[],this.marks=r,this.activeMarks=On.none,this.pendingMarks=n,this.stashMarks=[]};Oo.prototype.findWrapping=function(e){if(!this.match){if(!this.type)return[];var t=this.type.contentMatch.fillBefore(kn.from(e));if(!t){var r,n=this.type.contentMatch;return(r=n.findWrapping(e.type))?(this.match=n,r):null}this.match=this.type.contentMatch.matchFragment(t)}return this.match.findWrapping(e.type)},Oo.prototype.finish=function(e){if(!(1&this.options)){var t,r=this.content[this.content.length-1];r&&r.isText&&(t=/[ \t\r\n\u000c]+$/.exec(r.text))&&(r.text.length==t[0].length?this.content.pop():this.content[this.content.length-1]=r.withText(r.text.slice(0,r.text.length-t[0].length)))}var n=kn.from(this.content);return!e&&this.match&&(n=n.append(this.match.fillBefore(kn.empty,!0))),this.type?this.type.create(this.attrs,n,this.marks):n},Oo.prototype.popFromStashMark=function(e){for(var t=this.stashMarks.length-1;t>=0;t--)if(e.eq(this.stashMarks[t]))return this.stashMarks.splice(t,1)[0]},Oo.prototype.applyPending=function(e){for(var t=0,r=this.pendingMarks;t<r.length;t++){var n=r[t];(this.type?this.type.allowsMarkType(n.type):To(n.type,e))&&!n.isInSet(this.activeMarks)&&(this.activeMarks=n.addToSet(this.activeMarks),this.pendingMarks=n.removeFromSet(this.pendingMarks))}};var Eo=function(e,t,r){this.parser=e,this.options=t,this.isOpen=r;var n,o=t.topNode,i=Co(t.preserveWhitespace)|(r?4:0);n=o?new Oo(o.type,o.attrs,On.none,On.none,!0,t.topMatch||o.type.contentMatch,i):new Oo(r?null:e.schema.topNodeType,null,On.none,On.none,!0,null,i),this.nodes=[n],this.open=0,this.find=t.findPositions,this.needsBlock=!1},Ao={top:{configurable:!0},currentPos:{configurable:!0}};function No(e,t){return(e.matches||e.msMatchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector).call(e,t)}function Ro(e){var t={};for(var r in e)t[r]=e[r];return t}function To(e,t){var r=t.schema.nodes,n=function(n){var o=r[n];if(o.allowsMarkType(e)){var i=[],a=function(e){i.push(e);for(var r=0;r<e.edgeCount;r++){var n=e.edge(r),o=n.type,s=n.next;if(o==t)return!0;if(i.indexOf(s)<0&&a(s))return!0}};return a(o.contentMatch)?{v:!0}:void 0}};for(var o in r){var i=n(o);if(i)return i.v}}Ao.top.get=function(){return this.nodes[this.open]},Eo.prototype.addDOM=function(e){if(3==e.nodeType)this.addTextNode(e);else if(1==e.nodeType){var t=e.getAttribute("style"),r=t?this.readStyles(function(e){var t,r=/\s*([\w-]+)\s*:\s*([^;]+)/g,n=[];for(;t=r.exec(e);)n.push(t[1],t[2].trim());return n}(t)):null,n=this.top;if(null!=r)for(var o=0;o<r.length;o++)this.addPendingMark(r[o]);if(this.addElement(e),null!=r)for(var i=0;i<r.length;i++)this.removePendingMark(r[i],n)}},Eo.prototype.addTextNode=function(e){var t=e.nodeValue,r=this.top;if(2&r.options||(r.type?r.type.inlineContent:r.content.length&&r.content[0].isInline)||/[^ \t\r\n\u000c]/.test(t)){if(1&r.options)t=2&r.options?t.replace(/\r\n?/g,"\n"):t.replace(/\r?\n|\r/g," ");else if(t=t.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(t)&&this.open==this.nodes.length-1){var n=r.content[r.content.length-1],o=e.previousSibling;(!n||o&&"BR"==o.nodeName||n.isText&&/[ \t\r\n\u000c]$/.test(n.text))&&(t=t.slice(1))}t&&this.insertNode(this.parser.schema.text(t)),this.findInText(e)}else this.findInside(e)},Eo.prototype.addElement=function(e,t){var r,n=e.nodeName.toLowerCase();Mo.hasOwnProperty(n)&&this.parser.normalizeLists&&function(e){for(var t=e.firstChild,r=null;t;t=t.nextSibling){var n=1==t.nodeType?t.nodeName.toLowerCase():null;n&&Mo.hasOwnProperty(n)&&r?(r.appendChild(t),t=r):"li"==n?r=t:n&&(r=null)}}(e);var o=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(r=this.parser.matchTag(e,this,t));if(o?o.ignore:So.hasOwnProperty(n))this.findInside(e),this.ignoreFallback(e);else if(!o||o.skip||o.closeParent){o&&o.closeParent?this.open=Math.max(0,this.open-1):o&&o.skip.nodeType&&(e=o.skip);var i,a=this.top,s=this.needsBlock;if(xo.hasOwnProperty(n))i=!0,a.type||(this.needsBlock=!0);else if(!e.firstChild)return void this.leafFallback(e);this.addAll(e),i&&this.sync(a),this.needsBlock=s}else this.addElementByRule(e,o,!1===o.consuming?r:null)},Eo.prototype.leafFallback=function(e){"BR"==e.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode("\n"))},Eo.prototype.ignoreFallback=function(e){"BR"!=e.nodeName||this.top.type&&this.top.type.inlineContent||this.findPlace(this.parser.schema.text("-"))},Eo.prototype.readStyles=function(e){var t=On.none;e:for(var r=0;r<e.length;r+=2)for(var n=null;;){var o=this.parser.matchStyle(e[r],e[r+1],this,n);if(!o)continue e;if(o.ignore)return null;if(t=this.parser.schema.marks[o.mark].create(o.attrs).addToSet(t),!1!==o.consuming)break;n=o}return t},Eo.prototype.addElementByRule=function(e,t,r){var n,o,i,a=this;t.node?(o=this.parser.schema.nodes[t.node]).isLeaf?this.insertNode(o.create(t.attrs))||this.leafFallback(e):n=this.enter(o,t.attrs,t.preserveWhitespace):(i=this.parser.schema.marks[t.mark].create(t.attrs),this.addPendingMark(i));var s=this.top;if(o&&o.isLeaf)this.findInside(e);else if(r)this.addElement(e,r);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach((function(e){return a.insertNode(e)}));else{var l=t.contentElement;"string"==typeof l?l=e.querySelector(l):"function"==typeof l&&(l=l(e)),l||(l=e),this.findAround(e,l,!0),this.addAll(l,n)}n&&(this.sync(s),this.open--),i&&this.removePendingMark(i,s)},Eo.prototype.addAll=function(e,t,r,n){for(var o=r||0,i=r?e.childNodes[r]:e.firstChild,a=null==n?null:e.childNodes[n];i!=a;i=i.nextSibling,++o)this.findAtPoint(e,o),this.addDOM(i),t&&xo.hasOwnProperty(i.nodeName.toLowerCase())&&this.sync(t);this.findAtPoint(e,o)},Eo.prototype.findPlace=function(e){for(var t,r,n=this.open;n>=0;n--){var o=this.nodes[n],i=o.findWrapping(e);if(i&&(!t||t.length>i.length)&&(t=i,r=o,!i.length))break;if(o.solid)break}if(!t)return!1;this.sync(r);for(var a=0;a<t.length;a++)this.enterInner(t[a],null,!1);return!0},Eo.prototype.insertNode=function(e){if(e.isInline&&this.needsBlock&&!this.top.type){var t=this.textblockFromContext();t&&this.enterInner(t)}if(this.findPlace(e)){this.closeExtra();var r=this.top;r.applyPending(e.type),r.match&&(r.match=r.match.matchType(e.type));for(var n=r.activeMarks,o=0;o<e.marks.length;o++)r.type&&!r.type.allowsMarkType(e.marks[o].type)||(n=e.marks[o].addToSet(n));return r.content.push(e.mark(n)),!0}return!1},Eo.prototype.enter=function(e,t,r){var n=this.findPlace(e.create(t));return n&&this.enterInner(e,t,!0,r),n},Eo.prototype.enterInner=function(e,t,r,n){this.closeExtra();var o=this.top;o.applyPending(e),o.match=o.match&&o.match.matchType(e,t);var i=null==n?-5&o.options:Co(n);4&o.options&&0==o.content.length&&(i|=4),this.nodes.push(new Oo(e,t,o.activeMarks,o.pendingMarks,r,null,i)),this.open++},Eo.prototype.closeExtra=function(e){var t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}},Eo.prototype.finish=function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)},Eo.prototype.sync=function(e){for(var t=this.open;t>=0;t--)if(this.nodes[t]==e)return void(this.open=t)},Ao.currentPos.get=function(){this.closeExtra();for(var e=0,t=this.open;t>=0;t--){for(var r=this.nodes[t].content,n=r.length-1;n>=0;n--)e+=r[n].nodeSize;t&&e++}return e},Eo.prototype.findAtPoint=function(e,t){if(this.find)for(var r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==t&&(this.find[r].pos=this.currentPos)},Eo.prototype.findInside=function(e){if(this.find)for(var t=0;t<this.find.length;t++)null==this.find[t].pos&&1==e.nodeType&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)},Eo.prototype.findAround=function(e,t,r){if(e!=t&&this.find)for(var n=0;n<this.find.length;n++){if(null==this.find[n].pos&&1==e.nodeType&&e.contains(this.find[n].node))t.compareDocumentPosition(this.find[n].node)&(r?2:4)&&(this.find[n].pos=this.currentPos)}},Eo.prototype.findInText=function(e){if(this.find)for(var t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))},Eo.prototype.matchesContext=function(e){var t=this;if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);var r=e.split("/"),n=this.options.context,o=!(this.isOpen||n&&n.parent.type!=this.nodes[0].type),i=-(n?n.depth+1:0)+(o?0:1),a=function(e,s){for(;e>=0;e--){var l=r[e];if(""==l){if(e==r.length-1||0==e)continue;for(;s>=i;s--)if(a(e-1,s))return!0;return!1}var c=s>0||0==s&&o?t.nodes[s].type:n&&s>=i?n.node(s-i).type:null;if(!c||c.name!=l&&-1==c.groups.indexOf(l))return!1;s--}return!0};return a(r.length-1,this.open)},Eo.prototype.textblockFromContext=function(){var e=this.options.context;if(e)for(var t=e.depth;t>=0;t--){var r=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(var n in this.parser.schema.nodes){var o=this.parser.schema.nodes[n];if(o.isTextblock&&o.defaultAttrs)return o}},Eo.prototype.addPendingMark=function(e){var t=function(e,t){for(var r=0;r<t.length;r++)if(e.eq(t[r]))return t[r]}(e,this.top.pendingMarks);t&&this.top.stashMarks.push(t),this.top.pendingMarks=e.addToSet(this.top.pendingMarks)},Eo.prototype.removePendingMark=function(e,t){for(var r=this.open;r>=0;r--){var n=this.nodes[r];if(n.pendingMarks.lastIndexOf(e)>-1)n.pendingMarks=e.removeFromSet(n.pendingMarks);else{n.activeMarks=e.removeFromSet(n.activeMarks);var o=n.popFromStashMark(e);o&&n.type&&n.type.allowsMarkType(o.type)&&(n.activeMarks=o.addToSet(n.activeMarks))}if(n==t)break}},Object.defineProperties(Eo.prototype,Ao);var Do=function(e,t){this.nodes=e||{},this.marks=t||{}};function Po(e){var t={};for(var r in e){var n=e[r].spec.toDOM;n&&(t[r]=n)}return t}function Io(e){return e.document||window.document}Do.prototype.serializeFragment=function(e,t,r){var n=this;void 0===t&&(t={}),r||(r=Io(t).createDocumentFragment());var o=r,i=null;return e.forEach((function(e){if(i||e.marks.length){i||(i=[]);for(var r=0,a=0;r<i.length&&a<e.marks.length;){var s=e.marks[a];if(n.marks[s.type.name]){if(!s.eq(i[r])||!1===s.type.spec.spanning)break;r+=2,a++}else a++}for(;r<i.length;)o=i.pop(),i.pop();for(;a<e.marks.length;){var l=e.marks[a++],c=n.serializeMark(l,e.isInline,t);c&&(i.push(l,o),o.appendChild(c.dom),o=c.contentDOM||c.dom)}}o.appendChild(n.serializeNode(e,t))})),r},Do.prototype.serializeNode=function(e,t){void 0===t&&(t={});var r=Do.renderSpec(Io(t),this.nodes[e.type.name](e)),n=r.dom,o=r.contentDOM;if(o){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");t.onContent?t.onContent(e,o,t):this.serializeFragment(e.content,t,o)}return n},Do.prototype.serializeNodeAndMarks=function(e,t){void 0===t&&(t={});for(var r=this.serializeNode(e,t),n=e.marks.length-1;n>=0;n--){var o=this.serializeMark(e.marks[n],e.isInline,t);o&&((o.contentDOM||o.dom).appendChild(r),r=o.dom)}return r},Do.prototype.serializeMark=function(e,t,r){void 0===r&&(r={});var n=this.marks[e.type.name];return n&&Do.renderSpec(Io(r),n(e,t))},Do.renderSpec=function(e,t,r){if(void 0===r&&(r=null),"string"==typeof t)return{dom:e.createTextNode(t)};if(null!=t.nodeType)return{dom:t};if(t.dom&&null!=t.dom.nodeType)return t;var n=t[0],o=n.indexOf(" ");o>0&&(r=n.slice(0,o),n=n.slice(o+1));var i=null,a=r?e.createElementNS(r,n):e.createElement(n),s=t[1],l=1;if(s&&"object"==typeof s&&null==s.nodeType&&!Array.isArray(s))for(var c in l=2,s)if(null!=s[c]){var u=c.indexOf(" ");u>0?a.setAttributeNS(c.slice(0,u),c.slice(u+1),s[c]):a.setAttribute(c,s[c])}for(var h=l;h<t.length;h++){var d=t[h];if(0===d){if(h<t.length-1||h>l)throw new RangeError("Content hole must be the only child of its parent node");return{dom:a,contentDOM:a}}var p=Do.renderSpec(e,d,r),f=p.dom,v=p.contentDOM;if(a.appendChild(f),v){if(i)throw new RangeError("Multiple content holes");i=v}}return{dom:a,contentDOM:i}},Do.fromSchema=function(e){return e.cached.domSerializer||(e.cached.domSerializer=new Do(this.nodesFromSchema(e),this.marksFromSchema(e)))},Do.nodesFromSchema=function(e){var t=Po(e.nodes);return t.text||(t.text=function(e){return e.text}),t},Do.marksFromSchema=function(e){return Po(e.marks)};var Vo=Math.pow(2,16);function zo(e){return 65535&e}var $o=function(e,t,r){void 0===t&&(t=!1),void 0===r&&(r=null),this.pos=e,this.deleted=t,this.recover=r},Bo=function(e,t){void 0===t&&(t=!1),this.ranges=e,this.inverted=t};Bo.prototype.recover=function(e){var t=0,r=zo(e);if(!this.inverted)for(var n=0;n<r;n++)t+=this.ranges[3*n+2]-this.ranges[3*n+1];return this.ranges[3*r]+t+function(e){return(e-(65535&e))/Vo}(e)},Bo.prototype.mapResult=function(e,t){return void 0===t&&(t=1),this._map(e,t,!1)},Bo.prototype.map=function(e,t){return void 0===t&&(t=1),this._map(e,t,!0)},Bo.prototype._map=function(e,t,r){for(var n=0,o=this.inverted?2:1,i=this.inverted?1:2,a=0;a<this.ranges.length;a+=3){var s=this.ranges[a]-(this.inverted?n:0);if(s>e)break;var l=this.ranges[a+o],c=this.ranges[a+i],u=s+l;if(e<=u){var h=s+n+((l?e==s?-1:e==u?1:t:t)<0?0:c);if(r)return h;var d=e==(t<0?s:u)?null:a/3+(e-s)*Vo;return new $o(h,t<0?e!=s:e!=u,d)}n+=c-l}return r?e+n:new $o(e+n)},Bo.prototype.touches=function(e,t){for(var r=0,n=zo(t),o=this.inverted?2:1,i=this.inverted?1:2,a=0;a<this.ranges.length;a+=3){var s=this.ranges[a]-(this.inverted?r:0);if(s>e)break;var l=this.ranges[a+o];if(e<=s+l&&a==3*n)return!0;r+=this.ranges[a+i]-l}return!1},Bo.prototype.forEach=function(e){for(var t=this.inverted?2:1,r=this.inverted?1:2,n=0,o=0;n<this.ranges.length;n+=3){var i=this.ranges[n],a=i-(this.inverted?o:0),s=i+(this.inverted?0:o),l=this.ranges[n+t],c=this.ranges[n+r];e(a,a+l,s,s+c),o+=c-l}},Bo.prototype.invert=function(){return new Bo(this.ranges,!this.inverted)},Bo.prototype.toString=function(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)},Bo.offset=function(e){return 0==e?Bo.empty:new Bo(e<0?[0,-e,0]:[0,0,e])},Bo.empty=new Bo([]);var Ho=function(e,t,r,n){this.maps=e||[],this.from=r||0,this.to=null==n?this.maps.length:n,this.mirror=t};function Lo(e){var t=Error.call(this,e);return t.__proto__=Lo.prototype,t}Ho.prototype.slice=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=this.maps.length),new Ho(this.maps,this.mirror,e,t)},Ho.prototype.copy=function(){return new Ho(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)},Ho.prototype.appendMap=function(e,t){this.to=this.maps.push(e),null!=t&&this.setMirror(this.maps.length-1,t)},Ho.prototype.appendMapping=function(e){for(var t=0,r=this.maps.length;t<e.maps.length;t++){var n=e.getMirror(t);this.appendMap(e.maps[t],null!=n&&n<t?r+n:null)}},Ho.prototype.getMirror=function(e){if(this.mirror)for(var t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]},Ho.prototype.setMirror=function(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)},Ho.prototype.appendMappingInverted=function(e){for(var t=e.maps.length-1,r=this.maps.length+e.maps.length;t>=0;t--){var n=e.getMirror(t);this.appendMap(e.maps[t].invert(),null!=n&&n>t?r-n-1:null)}},Ho.prototype.invert=function(){var e=new Ho;return e.appendMappingInverted(this),e},Ho.prototype.map=function(e,t){if(void 0===t&&(t=1),this.mirror)return this._map(e,t,!0);for(var r=this.from;r<this.to;r++)e=this.maps[r].map(e,t);return e},Ho.prototype.mapResult=function(e,t){return void 0===t&&(t=1),this._map(e,t,!1)},Ho.prototype._map=function(e,t,r){for(var n=!1,o=this.from;o<this.to;o++){var i=this.maps[o].mapResult(e,t);if(null!=i.recover){var a=this.getMirror(o);if(null!=a&&a>o&&a<this.to){o=a,e=this.maps[a].recover(i.recover);continue}}i.deleted&&(n=!0),e=i.pos}return r?e:new $o(e,n)},Lo.prototype=Object.create(Error.prototype),Lo.prototype.constructor=Lo,Lo.prototype.name="TransformError";var _o=function(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new Ho},Fo={before:{configurable:!0},docChanged:{configurable:!0}};function jo(){throw new Error("Override me")}Fo.before.get=function(){return this.docs.length?this.docs[0]:this.doc},_o.prototype.step=function(e){var t=this.maybeStep(e);if(t.failed)throw new Lo(t.failed);return this},_o.prototype.maybeStep=function(e){var t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t},Fo.docChanged.get=function(){return this.steps.length>0},_o.prototype.addStep=function(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t},Object.defineProperties(_o.prototype,Fo);var Wo=Object.create(null),Ko=function(){};Ko.prototype.apply=function(e){return jo()},Ko.prototype.getMap=function(){return Bo.empty},Ko.prototype.invert=function(e){return jo()},Ko.prototype.map=function(e){return jo()},Ko.prototype.merge=function(e){return null},Ko.prototype.toJSON=function(){return jo()},Ko.fromJSON=function(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");var r=Wo[t.stepType];if(!r)throw new RangeError("No step type "+t.stepType+" defined");return r.fromJSON(e,t)},Ko.jsonID=function(e,t){if(e in Wo)throw new RangeError("Duplicate use of step JSON ID "+e);return Wo[e]=t,t.prototype.jsonID=e,t};var Uo=function(e,t){this.doc=e,this.failed=t};Uo.ok=function(e){return new Uo(e,null)},Uo.fail=function(e){return new Uo(null,e)},Uo.fromReplace=function(e,t,r,n){try{return Uo.ok(e.replace(t,r,n))}catch(o){if(o instanceof En)return Uo.fail(o.message);throw o}};var qo=function(e){function t(t,r,n,o){e.call(this),this.from=t,this.to=r,this.slice=n,this.structure=!!o}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.apply=function(e){return this.structure&&Zo(e,this.from,this.to)?Uo.fail("Structure replace would overwrite content"):Uo.fromReplace(e,this.from,this.to,this.slice)},t.prototype.getMap=function(){return new Bo([this.from,this.to-this.from,this.slice.size])},t.prototype.invert=function(e){return new t(this.from,this.from+this.slice.size,e.slice(this.from,this.to))},t.prototype.map=function(e){var r=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return r.deleted&&n.deleted?null:new t(r.pos,Math.max(r.pos,n.pos),this.slice)},t.prototype.merge=function(e){if(!(e instanceof t)||e.structure||this.structure)return null;if(this.from+this.slice.size!=e.from||this.slice.openEnd||e.slice.openStart){if(e.to!=this.from||this.slice.openStart||e.slice.openEnd)return null;var r=this.slice.size+e.slice.size==0?An.empty:new An(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new t(e.from,this.to,r,this.structure)}var n=this.slice.size+e.slice.size==0?An.empty:new An(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new t(this.from,this.to+(e.to-e.from),n,this.structure)},t.prototype.toJSON=function(){var e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e},t.fromJSON=function(e,r){if("number"!=typeof r.from||"number"!=typeof r.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new t(r.from,r.to,An.fromJSON(e,r.slice),!!r.structure)},t}(Ko);Ko.jsonID("replace",qo);var Jo=function(e){function t(t,r,n,o,i,a,s){e.call(this),this.from=t,this.to=r,this.gapFrom=n,this.gapTo=o,this.slice=i,this.insert=a,this.structure=!!s}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.apply=function(e){if(this.structure&&(Zo(e,this.from,this.gapFrom)||Zo(e,this.gapTo,this.to)))return Uo.fail("Structure gap-replace would overwrite content");var t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return Uo.fail("Gap is not a flat range");var r=this.slice.insertAt(this.insert,t.content);return r?Uo.fromReplace(e,this.from,this.to,r):Uo.fail("Content does not fit in gap")},t.prototype.getMap=function(){return new Bo([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])},t.prototype.invert=function(e){var r=this.gapTo-this.gapFrom;return new t(this.from,this.from+this.slice.size+r,this.from+this.insert,this.from+this.insert+r,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)},t.prototype.map=function(e){var r=e.mapResult(this.from,1),n=e.mapResult(this.to,-1),o=e.map(this.gapFrom,-1),i=e.map(this.gapTo,1);return r.deleted&&n.deleted||o<r.pos||i>n.pos?null:new t(r.pos,n.pos,o,i,this.slice,this.insert,this.structure)},t.prototype.toJSON=function(){var e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e},t.fromJSON=function(e,r){if("number"!=typeof r.from||"number"!=typeof r.to||"number"!=typeof r.gapFrom||"number"!=typeof r.gapTo||"number"!=typeof r.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new t(r.from,r.to,r.gapFrom,r.gapTo,An.fromJSON(e,r.slice),r.insert,!!r.structure)},t}(Ko);function Zo(e,t,r){for(var n=e.resolve(t),o=r-t,i=n.depth;o>0&&i>0&&n.indexAfter(i)==n.node(i).childCount;)i--,o--;if(o>0)for(var a=n.node(i).maybeChild(n.indexAfter(i));o>0;){if(!a||a.isLeaf)return!0;a=a.firstChild,o--}return!1}function Go(e,t,r){return(0==t||e.canReplace(t,e.childCount))&&(r==e.childCount||e.canReplace(0,r))}function Xo(e){for(var t=e.parent.content.cutByIndex(e.startIndex,e.endIndex),r=e.depth;;--r){var n=e.$from.node(r),o=e.$from.index(r),i=e.$to.indexAfter(r);if(r<e.depth&&n.canReplace(o,i,t))return r;if(0==r||n.type.spec.isolating||!Go(n,o,i))break}}function Yo(e,t,r,n){void 0===n&&(n=e);var o=function(e,t){var r=e.parent,n=e.startIndex,o=e.endIndex,i=r.contentMatchAt(n).findWrapping(t);if(!i)return null;var a=i.length?i[0]:t;return r.canReplaceWith(n,o,a)?i:null}(e,t),i=o&&function(e,t){var r=e.parent,n=e.startIndex,o=e.endIndex,i=r.child(n),a=t.contentMatch.findWrapping(i.type);if(!a)return null;for(var s=(a.length?a[a.length-1]:t).contentMatch,l=n;s&&l<o;l++)s=s.matchType(r.child(l).type);if(!s||!s.validEnd)return null;return a}(n,t);return i?o.map(Qo).concat({type:t,attrs:r}).concat(i.map(Qo)):null}function Qo(e){return{type:e,attrs:null}}function ei(e,t,r,n){void 0===r&&(r=1);var o=e.resolve(t),i=o.depth-r,a=n&&n[n.length-1]||o.parent;if(i<0||o.parent.type.spec.isolating||!o.parent.canReplace(o.index(),o.parent.childCount)||!a.type.validContent(o.parent.content.cutByIndex(o.index(),o.parent.childCount)))return!1;for(var s=o.depth-1,l=r-2;s>i;s--,l--){var c=o.node(s),u=o.index(s);if(c.type.spec.isolating)return!1;var h=c.content.cutByIndex(u,c.childCount),d=n&&n[l]||c;if(d!=c&&(h=h.replaceChild(0,d.type.create(d.attrs))),!c.canReplace(u+1,c.childCount)||!d.type.validContent(h))return!1}var p=o.indexAfter(i),f=n&&n[0];return o.node(i).canReplaceWith(p,p,f?f.type:o.node(i+1).type)}function ti(e,t){var r,n,o=e.resolve(t),i=o.index();return r=o.nodeBefore,n=o.nodeAfter,r&&n&&!r.isLeaf&&r.canAppend(n)&&o.parent.canReplace(i,i+1)}function ri(e,t,r){for(var n=[],o=0;o<e.childCount;o++){var i=e.child(o);i.content.size&&(i=i.copy(ri(i.content,t,i))),i.isInline&&(i=t(i,r,o)),n.push(i)}return kn.fromArray(n)}Ko.jsonID("replaceAround",Jo),_o.prototype.lift=function(e,t){for(var r=e.$from,n=e.$to,o=e.depth,i=r.before(o+1),a=n.after(o+1),s=i,l=a,c=kn.empty,u=0,h=o,d=!1;h>t;h--)d||r.index(h)>0?(d=!0,c=kn.from(r.node(h).copy(c)),u++):s--;for(var p=kn.empty,f=0,v=o,m=!1;v>t;v--)m||n.after(v+1)<n.end(v)?(m=!0,p=kn.from(n.node(v).copy(p)),f++):l++;return this.step(new Jo(s,l,i,a,new An(c.append(p),u,f),c.size-u,!0))},_o.prototype.wrap=function(e,t){for(var r=kn.empty,n=t.length-1;n>=0;n--)r=kn.from(t[n].type.create(t[n].attrs,r));var o=e.start,i=e.end;return this.step(new Jo(o,i,o,i,new An(r,0,0),t.length,!0))},_o.prototype.setBlockType=function(e,t,r,n){var o=this;if(void 0===t&&(t=e),!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");var i=this.steps.length;return this.doc.nodesBetween(e,t,(function(e,t){if(e.isTextblock&&!e.hasMarkup(r,n)&&function(e,t,r){var n=e.resolve(t),o=n.index();return n.parent.canReplaceWith(o,o+1,r)}(o.doc,o.mapping.slice(i).map(t),r)){o.clearIncompatible(o.mapping.slice(i).map(t,1),r);var a=o.mapping.slice(i),s=a.map(t,1),l=a.map(t+e.nodeSize,1);return o.step(new Jo(s,l,s+1,l-1,new An(kn.from(r.create(n,null,e.marks)),0,0),1,!0)),!1}})),this},_o.prototype.setNodeMarkup=function(e,t,r,n){var o=this.doc.nodeAt(e);if(!o)throw new RangeError("No node at given position");t||(t=o.type);var i=t.create(r,null,n||o.marks);if(o.isLeaf)return this.replaceWith(e,e+o.nodeSize,i);if(!t.validContent(o.content))throw new RangeError("Invalid content for node type "+t.name);return this.step(new Jo(e,e+o.nodeSize,e+1,e+o.nodeSize-1,new An(kn.from(i),0,0),1,!0))},_o.prototype.split=function(e,t,r){void 0===t&&(t=1);for(var n=this.doc.resolve(e),o=kn.empty,i=kn.empty,a=n.depth,s=n.depth-t,l=t-1;a>s;a--,l--){o=kn.from(n.node(a).copy(o));var c=r&&r[l];i=kn.from(c?c.type.create(c.attrs,i):n.node(a).copy(i))}return this.step(new qo(e,e,new An(o.append(i),t,t),!0))},_o.prototype.join=function(e,t){void 0===t&&(t=1);var r=new qo(e-t,e+t,An.empty,!0);return this.step(r)};var ni=function(e){function t(t,r,n){e.call(this),this.from=t,this.to=r,this.mark=n}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.apply=function(e){var t=this,r=e.slice(this.from,this.to),n=e.resolve(this.from),o=n.node(n.sharedDepth(this.to)),i=new An(ri(r.content,(function(e,r){return e.isAtom&&r.type.allowsMarkType(t.mark.type)?e.mark(t.mark.addToSet(e.marks)):e}),o),r.openStart,r.openEnd);return Uo.fromReplace(e,this.from,this.to,i)},t.prototype.invert=function(){return new oi(this.from,this.to,this.mark)},t.prototype.map=function(e){var r=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return r.deleted&&n.deleted||r.pos>=n.pos?null:new t(r.pos,n.pos,this.mark)},t.prototype.merge=function(e){if(e instanceof t&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from)return new t(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark)},t.prototype.toJSON=function(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},t.fromJSON=function(e,r){if("number"!=typeof r.from||"number"!=typeof r.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new t(r.from,r.to,e.markFromJSON(r.mark))},t}(Ko);Ko.jsonID("addMark",ni);var oi=function(e){function t(t,r,n){e.call(this),this.from=t,this.to=r,this.mark=n}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.apply=function(e){var t=this,r=e.slice(this.from,this.to),n=new An(ri(r.content,(function(e){return e.mark(t.mark.removeFromSet(e.marks))})),r.openStart,r.openEnd);return Uo.fromReplace(e,this.from,this.to,n)},t.prototype.invert=function(){return new ni(this.from,this.to,this.mark)},t.prototype.map=function(e){var r=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return r.deleted&&n.deleted||r.pos>=n.pos?null:new t(r.pos,n.pos,this.mark)},t.prototype.merge=function(e){if(e instanceof t&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from)return new t(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark)},t.prototype.toJSON=function(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},t.fromJSON=function(e,r){if("number"!=typeof r.from||"number"!=typeof r.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new t(r.from,r.to,e.markFromJSON(r.mark))},t}(Ko);function ii(e,t,r){return!r.openStart&&!r.openEnd&&e.start()==t.start()&&e.parent.canReplace(e.index(),t.index(),r.content)}Ko.jsonID("removeMark",oi),_o.prototype.addMark=function(e,t,r){var n=this,o=[],i=[],a=null,s=null;return this.doc.nodesBetween(e,t,(function(n,l,c){if(n.isInline){var u=n.marks;if(!r.isInSet(u)&&c.type.allowsMarkType(r.type)){for(var h=Math.max(l,e),d=Math.min(l+n.nodeSize,t),p=r.addToSet(u),f=0;f<u.length;f++)u[f].isInSet(p)||(a&&a.to==h&&a.mark.eq(u[f])?a.to=d:o.push(a=new oi(h,d,u[f])));s&&s.to==h?s.to=d:i.push(s=new ni(h,d,r))}}})),o.forEach((function(e){return n.step(e)})),i.forEach((function(e){return n.step(e)})),this},_o.prototype.removeMark=function(e,t,r){var n=this;void 0===r&&(r=null);var o=[],i=0;return this.doc.nodesBetween(e,t,(function(n,a){if(n.isInline){i++;var s=null;if(r instanceof yo)for(var l,c=n.marks;l=r.isInSet(c);)(s||(s=[])).push(l),c=l.removeFromSet(c);else r?r.isInSet(n.marks)&&(s=[r]):s=n.marks;if(s&&s.length)for(var u=Math.min(a+n.nodeSize,t),h=0;h<s.length;h++){for(var d=s[h],p=void 0,f=0;f<o.length;f++){var v=o[f];v.step==i-1&&d.eq(o[f].style)&&(p=v)}p?(p.to=u,p.step=i):o.push({style:d,from:Math.max(a,e),to:u,step:i})}}})),o.forEach((function(e){return n.step(new oi(e.from,e.to,e.style))})),this},_o.prototype.clearIncompatible=function(e,t,r){void 0===r&&(r=t.contentMatch);for(var n=this.doc.nodeAt(e),o=[],i=e+1,a=0;a<n.childCount;a++){var s=n.child(a),l=i+s.nodeSize,c=r.matchType(s.type,s.attrs);if(c){r=c;for(var u=0;u<s.marks.length;u++)t.allowsMarkType(s.marks[u].type)||this.step(new oi(i,l,s.marks[u]))}else o.push(new qo(i,l,An.empty));i=l}if(!r.validEnd){var h=r.fillBefore(kn.empty,!0);this.replace(i,i,new An(h,0,0))}for(var d=o.length-1;d>=0;d--)this.step(o[d]);return this},_o.prototype.replace=function(e,t,r){void 0===t&&(t=e),void 0===r&&(r=An.empty);var n=function(e,t,r,n){if(void 0===r&&(r=t),void 0===n&&(n=An.empty),t==r&&!n.size)return null;var o=e.resolve(t),i=e.resolve(r);return ii(o,i,n)?new qo(t,r,n):new ai(o,i,n).fit()}(this.doc,e,t,r);return n&&this.step(n),this},_o.prototype.replaceWith=function(e,t,r){return this.replace(e,t,new An(kn.from(r),0,0))},_o.prototype.delete=function(e,t){return this.replace(e,t,An.empty)},_o.prototype.insert=function(e,t){return this.replaceWith(e,e,t)};var ai=function(e,t,r){this.$to=t,this.$from=e,this.unplaced=r,this.frontier=[];for(var n=0;n<=e.depth;n++){var o=e.node(n);this.frontier.push({type:o.type,match:o.contentMatchAt(e.indexAfter(n))})}this.placed=kn.empty;for(var i=e.depth;i>0;i--)this.placed=kn.from(e.node(i).copy(this.placed))},si={depth:{configurable:!0}};function li(e,t,r){return 0==t?e.cutByIndex(r):e.replaceChild(0,e.firstChild.copy(li(e.firstChild.content,t-1,r)))}function ci(e,t,r){return 0==t?e.append(r):e.replaceChild(e.childCount-1,e.lastChild.copy(ci(e.lastChild.content,t-1,r)))}function ui(e,t){for(var r=0;r<t;r++)e=e.firstChild.content;return e}function hi(e,t,r){if(t<=0)return e;var n=e.content;return t>1&&(n=n.replaceChild(0,hi(n.firstChild,t-1,1==n.childCount?r-1:0))),t>0&&(n=e.type.contentMatch.fillBefore(n).append(n),r<=0&&(n=n.append(e.type.contentMatch.matchFragment(n).fillBefore(kn.empty,!0)))),e.copy(n)}function di(e,t,r,n,o){var i=e.node(t),a=o?e.indexAfter(t):e.index(t);if(a==i.childCount&&!r.compatibleContent(i.type))return null;var s=n.fillBefore(i.content,!0,a);return s&&!function(e,t,r){for(var n=r;n<t.childCount;n++)if(!e.allowsMarks(t.child(n).marks))return!0;return!1}(r,i.content,a)?s:null}function pi(e,t,r,n,o){if(t<r){var i=e.firstChild;e=e.replaceChild(0,i.copy(pi(i.content,t+1,r,n,i)))}if(t>n){var a=o.contentMatchAt(0),s=a.fillBefore(e).append(e);e=s.append(a.matchFragment(s).fillBefore(kn.empty,!0))}return e}function fi(e,t){for(var r=[],n=Math.min(e.depth,t.depth);n>=0;n--){var o=e.start(n);if(o<e.pos-(e.depth-n)||t.end(n)>t.pos+(t.depth-n)||e.node(n).type.spec.isolating||t.node(n).type.spec.isolating)break;o==t.start(n)&&r.push(n)}return r}si.depth.get=function(){return this.frontier.length-1},ai.prototype.fit=function(){for(;this.unplaced.size;){var e=this.findFittable();e?this.placeNodes(e):this.openMore()||this.dropNode()}var t=this.mustMoveInline(),r=this.placed.size-this.depth-this.$from.depth,n=this.$from,o=this.close(t<0?this.$to:n.doc.resolve(t));if(!o)return null;for(var i=this.placed,a=n.depth,s=o.depth;a&&s&&1==i.childCount;)i=i.firstChild.content,a--,s--;var l=new An(i,a,s);return t>-1?new Jo(n.pos,t,this.$to.pos,this.$to.end(),l,r):l.size||n.pos!=this.$to.pos?new qo(n.pos,o.pos,l):void 0},ai.prototype.findFittable=function(){for(var e=1;e<=2;e++)for(var t=this.unplaced.openStart;t>=0;t--)for(var r=void 0,n=(t?(r=ui(this.unplaced.content,t-1).firstChild).content:this.unplaced.content).firstChild,o=this.depth;o>=0;o--){var i=this.frontier[o],a=i.type,s=i.match,l=void 0,c=void 0;if(1==e&&(n?s.matchType(n.type)||(c=s.fillBefore(kn.from(n),!1)):a.compatibleContent(r.type)))return{sliceDepth:t,frontierDepth:o,parent:r,inject:c};if(2==e&&n&&(l=s.findWrapping(n.type)))return{sliceDepth:t,frontierDepth:o,parent:r,wrap:l};if(r&&s.matchType(r.type))break}},ai.prototype.openMore=function(){var e=this.unplaced,t=e.content,r=e.openStart,n=e.openEnd,o=ui(t,r);return!(!o.childCount||o.firstChild.isLeaf)&&(this.unplaced=new An(t,r+1,Math.max(n,o.size+r>=t.size-n?r+1:0)),!0)},ai.prototype.dropNode=function(){var e=this.unplaced,t=e.content,r=e.openStart,n=e.openEnd,o=ui(t,r);if(o.childCount<=1&&r>0){var i=t.size-r<=r+o.size;this.unplaced=new An(li(t,r-1,1),r-1,i?r-1:n)}else this.unplaced=new An(li(t,r,1),r,n)},ai.prototype.placeNodes=function(e){for(var t=e.sliceDepth,r=e.frontierDepth,n=e.parent,o=e.inject,i=e.wrap;this.depth>r;)this.closeFrontierNode();if(i)for(var a=0;a<i.length;a++)this.openFrontierNode(i[a]);var s=this.unplaced,l=n?n.content:s.content,c=s.openStart-t,u=0,h=[],d=this.frontier[r],p=d.match,f=d.type;if(o){for(var v=0;v<o.childCount;v++)h.push(o.child(v));p=p.matchFragment(o)}for(var m=l.size+t-(s.content.size-s.openEnd);u<l.childCount;){var g=l.child(u),y=p.matchType(g.type);if(!y)break;(++u>1||0==c||g.content.size)&&(p=y,h.push(hi(g.mark(f.allowedMarks(g.marks)),1==u?c:0,u==l.childCount?m:-1)))}var w=u==l.childCount;w||(m=-1),this.placed=ci(this.placed,r,kn.from(h)),this.frontier[r].match=p,w&&m<0&&n&&n.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(var b=0,k=l;b<m;b++){var x=k.lastChild;this.frontier.push({type:x.type,match:x.contentMatchAt(x.childCount)}),k=x.content}this.unplaced=w?0==t?An.empty:new An(li(s.content,t-1,1),t-1,m<0?s.openEnd:t-1):new An(li(s.content,t,u),s.openStart,s.openEnd)},ai.prototype.mustMoveInline=function(){if(!this.$to.parent.isTextblock||this.$to.end()==this.$to.pos)return-1;var e,t=this.frontier[this.depth];if(!t.type.isTextblock||!di(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(e=this.findCloseLevel(this.$to))&&e.depth==this.depth)return-1;for(var r=this.$to.depth,n=this.$to.after(r);r>1&&n==this.$to.end(--r);)++n;return n},ai.prototype.findCloseLevel=function(e){e:for(var t=Math.min(this.depth,e.depth);t>=0;t--){var r=this.frontier[t],n=r.match,o=r.type,i=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),a=di(e,t,o,n,i);if(a){for(var s=t-1;s>=0;s--){var l=this.frontier[s],c=l.match,u=di(e,s,l.type,c,!0);if(!u||u.childCount)continue e}return{depth:t,fit:a,move:i?e.doc.resolve(e.after(t+1)):e}}}},ai.prototype.close=function(e){var t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=ci(this.placed,t.depth,t.fit)),e=t.move;for(var r=t.depth+1;r<=e.depth;r++){var n=e.node(r),o=n.type.contentMatch.fillBefore(n.content,!0,e.index(r));this.openFrontierNode(n.type,n.attrs,o)}return e},ai.prototype.openFrontierNode=function(e,t,r){var n=this.frontier[this.depth];n.match=n.match.matchType(e),this.placed=ci(this.placed,this.depth,kn.from(e.create(t,r))),this.frontier.push({type:e,match:e.contentMatch})},ai.prototype.closeFrontierNode=function(){var e=this.frontier.pop().match.fillBefore(kn.empty,!0);e.childCount&&(this.placed=ci(this.placed,this.frontier.length,e))},Object.defineProperties(ai.prototype,si),_o.prototype.replaceRange=function(e,t,r){if(!r.size)return this.deleteRange(e,t);var n=this.doc.resolve(e),o=this.doc.resolve(t);if(ii(n,o,r))return this.step(new qo(e,t,r));var i=fi(n,this.doc.resolve(t));0==i[i.length-1]&&i.pop();var a=-(n.depth+1);i.unshift(a);for(var s=n.depth,l=n.pos-1;s>0;s--,l--){var c=n.node(s).type.spec;if(c.defining||c.isolating)break;i.indexOf(s)>-1?a=s:n.before(s)==l&&i.splice(1,0,-s)}for(var u=i.indexOf(a),h=[],d=r.openStart,p=r.content,f=0;;f++){var v=p.firstChild;if(h.push(v),f==r.openStart)break;p=v.content}d>0&&h[d-1].type.spec.defining&&n.node(u).type!=h[d-1].type?d-=1:d>=2&&h[d-1].isTextblock&&h[d-2].type.spec.defining&&n.node(u).type!=h[d-2].type&&(d-=2);for(var m=r.openStart;m>=0;m--){var g=(m+d+1)%(r.openStart+1),y=h[g];if(y)for(var w=0;w<i.length;w++){var b=i[(w+u)%i.length],k=!0;b<0&&(k=!1,b=-b);var x=n.node(b-1),S=n.index(b-1);if(x.canReplaceWith(S,S,y.type,y.marks))return this.replace(n.before(b),k?o.after(b):t,new An(pi(r.content,0,r.openStart,g),g,r.openEnd))}}for(var M=this.steps.length,C=i.length-1;C>=0&&(this.replace(e,t,r),!(this.steps.length>M));C--){var O=i[C];O<0||(e=n.before(O),t=o.after(O))}return this},_o.prototype.replaceRangeWith=function(e,t,r){if(!r.isInline&&e==t&&this.doc.resolve(e).parent.content.size){var n=function(e,t,r){var n=e.resolve(t);if(n.parent.canReplaceWith(n.index(),n.index(),r))return t;if(0==n.parentOffset)for(var o=n.depth-1;o>=0;o--){var i=n.index(o);if(n.node(o).canReplaceWith(i,i,r))return n.before(o+1);if(i>0)return null}if(n.parentOffset==n.parent.content.size)for(var a=n.depth-1;a>=0;a--){var s=n.indexAfter(a);if(n.node(a).canReplaceWith(s,s,r))return n.after(a+1);if(s<n.node(a).childCount)return null}}(this.doc,e,r.type);null!=n&&(e=t=n)}return this.replaceRange(e,t,new An(kn.from(r),0,0))},_o.prototype.deleteRange=function(e,t){for(var r=this.doc.resolve(e),n=this.doc.resolve(t),o=fi(r,n),i=0;i<o.length;i++){var a=o[i],s=i==o.length-1;if(s&&0==a||r.node(a).type.contentMatch.validEnd)return this.delete(r.start(a),n.end(a));if(a>0&&(s||r.node(a-1).canReplace(r.index(a-1),n.indexAfter(a-1))))return this.delete(r.before(a),n.after(a))}for(var l=1;l<=r.depth&&l<=n.depth;l++)if(e-r.start(l)==r.depth-l&&t>r.end(l)&&n.end(l)-t!=n.depth-l)return this.delete(r.before(l),t);return this.delete(e,t)};var vi=Object.create(null),mi=function(e,t,r){this.ranges=r||[new yi(e.min(t),e.max(t))],this.$anchor=e,this.$head=t},gi={anchor:{configurable:!0},head:{configurable:!0},from:{configurable:!0},to:{configurable:!0},$from:{configurable:!0},$to:{configurable:!0},empty:{configurable:!0}};gi.anchor.get=function(){return this.$anchor.pos},gi.head.get=function(){return this.$head.pos},gi.from.get=function(){return this.$from.pos},gi.to.get=function(){return this.$to.pos},gi.$from.get=function(){return this.ranges[0].$from},gi.$to.get=function(){return this.ranges[0].$to},gi.empty.get=function(){for(var e=this.ranges,t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0},mi.prototype.content=function(){return this.$from.node(0).slice(this.from,this.to,!0)},mi.prototype.replace=function(e,t){void 0===t&&(t=An.empty);for(var r=t.content.lastChild,n=null,o=0;o<t.openEnd;o++)n=r,r=r.lastChild;for(var i=e.steps.length,a=this.ranges,s=0;s<a.length;s++){var l=a[s],c=l.$from,u=l.$to,h=e.mapping.slice(i);e.replaceRange(h.map(c.pos),h.map(u.pos),s?An.empty:t),0==s&&Oi(e,i,(r?r.isInline:n&&n.isTextblock)?-1:1)}},mi.prototype.replaceWith=function(e,t){for(var r=e.steps.length,n=this.ranges,o=0;o<n.length;o++){var i=n[o],a=i.$from,s=i.$to,l=e.mapping.slice(r),c=l.map(a.pos),u=l.map(s.pos);o?e.deleteRange(c,u):(e.replaceRangeWith(c,u,t),Oi(e,r,t.isInline?-1:1))}},mi.findFrom=function(e,t,r){var n=e.parent.inlineContent?new wi(e):Ci(e.node(0),e.parent,e.pos,e.index(),t,r);if(n)return n;for(var o=e.depth-1;o>=0;o--){var i=t<0?Ci(e.node(0),e.node(o),e.before(o+1),e.index(o),t,r):Ci(e.node(0),e.node(o),e.after(o+1),e.index(o)+1,t,r);if(i)return i}},mi.near=function(e,t){return void 0===t&&(t=1),this.findFrom(e,t)||this.findFrom(e,-t)||new Si(e.node(0))},mi.atStart=function(e){return Ci(e,e,0,0,1)||new Si(e)},mi.atEnd=function(e){return Ci(e,e,e.content.size,e.childCount,-1)||new Si(e)},mi.fromJSON=function(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");var r=vi[t.type];if(!r)throw new RangeError("No selection type "+t.type+" defined");return r.fromJSON(e,t)},mi.jsonID=function(e,t){if(e in vi)throw new RangeError("Duplicate use of selection JSON ID "+e);return vi[e]=t,t.prototype.jsonID=e,t},mi.prototype.getBookmark=function(){return wi.between(this.$anchor,this.$head).getBookmark()},Object.defineProperties(mi.prototype,gi),mi.prototype.visible=!0;var yi=function(e,t){this.$from=e,this.$to=t},wi=function(e){function t(t,r){void 0===r&&(r=t),e.call(this,t,r)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var r={$cursor:{configurable:!0}};return r.$cursor.get=function(){return this.$anchor.pos==this.$head.pos?this.$head:null},t.prototype.map=function(r,n){var o=r.resolve(n.map(this.head));if(!o.parent.inlineContent)return e.near(o);var i=r.resolve(n.map(this.anchor));return new t(i.parent.inlineContent?i:o,o)},t.prototype.replace=function(t,r){if(void 0===r&&(r=An.empty),e.prototype.replace.call(this,t,r),r==An.empty){var n=this.$from.marksAcross(this.$to);n&&t.ensureMarks(n)}},t.prototype.eq=function(e){return e instanceof t&&e.anchor==this.anchor&&e.head==this.head},t.prototype.getBookmark=function(){return new bi(this.anchor,this.head)},t.prototype.toJSON=function(){return{type:"text",anchor:this.anchor,head:this.head}},t.fromJSON=function(e,r){if("number"!=typeof r.anchor||"number"!=typeof r.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new t(e.resolve(r.anchor),e.resolve(r.head))},t.create=function(e,t,r){void 0===r&&(r=t);var n=e.resolve(t);return new this(n,r==t?n:e.resolve(r))},t.between=function(r,n,o){var i=r.pos-n.pos;if(o&&!i||(o=i>=0?1:-1),!n.parent.inlineContent){var a=e.findFrom(n,o,!0)||e.findFrom(n,-o,!0);if(!a)return e.near(n,o);n=a.$head}return r.parent.inlineContent||(0==i||(r=(e.findFrom(r,-o,!0)||e.findFrom(r,o,!0)).$anchor).pos<n.pos!=i<0)&&(r=n),new t(r,n)},Object.defineProperties(t.prototype,r),t}(mi);mi.jsonID("text",wi);var bi=function(e,t){this.anchor=e,this.head=t};bi.prototype.map=function(e){return new bi(e.map(this.anchor),e.map(this.head))},bi.prototype.resolve=function(e){return wi.between(e.resolve(this.anchor),e.resolve(this.head))};var ki=function(e){function t(t){var r=t.nodeAfter,n=t.node(0).resolve(t.pos+r.nodeSize);e.call(this,t,n),this.node=r}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.map=function(r,n){var o=n.mapResult(this.anchor),i=o.deleted,a=o.pos,s=r.resolve(a);return i?e.near(s):new t(s)},t.prototype.content=function(){return new An(kn.from(this.node),0,0)},t.prototype.eq=function(e){return e instanceof t&&e.anchor==this.anchor},t.prototype.toJSON=function(){return{type:"node",anchor:this.anchor}},t.prototype.getBookmark=function(){return new xi(this.anchor)},t.fromJSON=function(e,r){if("number"!=typeof r.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new t(e.resolve(r.anchor))},t.create=function(e,t){return new this(e.resolve(t))},t.isSelectable=function(e){return!e.isText&&!1!==e.type.spec.selectable},t}(mi);ki.prototype.visible=!1,mi.jsonID("node",ki);var xi=function(e){this.anchor=e};xi.prototype.map=function(e){var t=e.mapResult(this.anchor),r=t.deleted,n=t.pos;return r?new bi(n,n):new xi(n)},xi.prototype.resolve=function(e){var t=e.resolve(this.anchor),r=t.nodeAfter;return r&&ki.isSelectable(r)?new ki(t):mi.near(t)};var Si=function(e){function t(t){e.call(this,t.resolve(0),t.resolve(t.content.size))}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.replace=function(t,r){if(void 0===r&&(r=An.empty),r==An.empty){t.delete(0,t.doc.content.size);var n=e.atStart(t.doc);n.eq(t.selection)||t.setSelection(n)}else e.prototype.replace.call(this,t,r)},t.prototype.toJSON=function(){return{type:"all"}},t.fromJSON=function(e){return new t(e)},t.prototype.map=function(e){return new t(e)},t.prototype.eq=function(e){return e instanceof t},t.prototype.getBookmark=function(){return Mi},t}(mi);mi.jsonID("all",Si);var Mi={map:function(){return this},resolve:function(e){return new Si(e)}};function Ci(e,t,r,n,o,i){if(t.inlineContent)return wi.create(e,r);for(var a=n-(o>0?0:1);o>0?a<t.childCount:a>=0;a+=o){var s=t.child(a);if(s.isAtom){if(!i&&ki.isSelectable(s))return ki.create(e,r-(o<0?s.nodeSize:0))}else{var l=Ci(e,s,r+o,o<0?s.childCount:0,o,i);if(l)return l}r+=s.nodeSize*o}}function Oi(e,t,r){var n=e.steps.length-1;if(!(n<t)){var o,i=e.steps[n];if(i instanceof qo||i instanceof Jo)e.mapping.maps[n].forEach((function(e,t,r,n){null==o&&(o=n)})),e.setSelection(mi.near(e.doc.resolve(o),r))}}var Ei=function(e){function t(t){e.call(this,t.doc),this.time=Date.now(),this.curSelection=t.selection,this.curSelectionFor=0,this.storedMarks=t.storedMarks,this.updated=0,this.meta=Object.create(null)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var r={selection:{configurable:!0},selectionSet:{configurable:!0},storedMarksSet:{configurable:!0},isGeneric:{configurable:!0},scrolledIntoView:{configurable:!0}};return r.selection.get=function(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection},t.prototype.setSelection=function(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this},r.selectionSet.get=function(){return(1&this.updated)>0},t.prototype.setStoredMarks=function(e){return this.storedMarks=e,this.updated|=2,this},t.prototype.ensureMarks=function(e){return On.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this},t.prototype.addStoredMark=function(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))},t.prototype.removeStoredMark=function(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))},r.storedMarksSet.get=function(){return(2&this.updated)>0},t.prototype.addStep=function(t,r){e.prototype.addStep.call(this,t,r),this.updated=-3&this.updated,this.storedMarks=null},t.prototype.setTime=function(e){return this.time=e,this},t.prototype.replaceSelection=function(e){return this.selection.replace(this,e),this},t.prototype.replaceSelectionWith=function(e,t){var r=this.selection;return!1!==t&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||On.none))),r.replaceWith(this,e),this},t.prototype.deleteSelection=function(){return this.selection.replace(this),this},t.prototype.insertText=function(e,t,r){void 0===r&&(r=t);var n=this.doc.type.schema;if(null==t)return e?this.replaceSelectionWith(n.text(e),!0):this.deleteSelection();if(!e)return this.deleteRange(t,r);var o=this.storedMarks;if(!o){var i=this.doc.resolve(t);o=r==t?i.marks():i.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(t,r,n.text(e,o)),this.selection.empty||this.setSelection(mi.near(this.selection.$to)),this},t.prototype.setMeta=function(e,t){return this.meta["string"==typeof e?e:e.key]=t,this},t.prototype.getMeta=function(e){return this.meta["string"==typeof e?e:e.key]},r.isGeneric.get=function(){for(var e in this.meta)return!1;return!0},t.prototype.scrollIntoView=function(){return this.updated|=4,this},r.scrolledIntoView.get=function(){return(4&this.updated)>0},Object.defineProperties(t.prototype,r),t}(_o);function Ai(e,t){return t&&e?e.bind(t):e}var Ni=function(e,t,r){this.name=e,this.init=Ai(t.init,r),this.apply=Ai(t.apply,r)},Ri=[new Ni("doc",{init:function(e){return e.doc||e.schema.topNodeType.createAndFill()},apply:function(e){return e.doc}}),new Ni("selection",{init:function(e,t){return e.selection||mi.atStart(t.doc)},apply:function(e){return e.selection}}),new Ni("storedMarks",{init:function(e){return e.storedMarks||null},apply:function(e,t,r,n){return n.selection.$cursor?e.storedMarks:null}}),new Ni("scrollToSelection",{init:function(){return 0},apply:function(e,t){return e.scrolledIntoView?t+1:t}})],Ti=function(e,t){var r=this;this.schema=e,this.fields=Ri.concat(),this.plugins=[],this.pluginsByKey=Object.create(null),t&&t.forEach((function(e){if(r.pluginsByKey[e.key])throw new RangeError("Adding different instances of a keyed plugin ("+e.key+")");r.plugins.push(e),r.pluginsByKey[e.key]=e,e.spec.state&&r.fields.push(new Ni(e.key,e.spec.state,e))}))},Di=function(e){this.config=e},Pi={schema:{configurable:!0},plugins:{configurable:!0},tr:{configurable:!0}};Pi.schema.get=function(){return this.config.schema},Pi.plugins.get=function(){return this.config.plugins},Di.prototype.apply=function(e){return this.applyTransaction(e).state},Di.prototype.filterTransaction=function(e,t){void 0===t&&(t=-1);for(var r=0;r<this.config.plugins.length;r++)if(r!=t){var n=this.config.plugins[r];if(n.spec.filterTransaction&&!n.spec.filterTransaction.call(n,e,this))return!1}return!0},Di.prototype.applyTransaction=function(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};for(var t=[e],r=this.applyInner(e),n=null;;){for(var o=!1,i=0;i<this.config.plugins.length;i++){var a=this.config.plugins[i];if(a.spec.appendTransaction){var s=n?n[i].n:0,l=n?n[i].state:this,c=s<t.length&&a.spec.appendTransaction.call(a,s?t.slice(s):t,l,r);if(c&&r.filterTransaction(c,i)){if(c.setMeta("appendedTransaction",e),!n){n=[];for(var u=0;u<this.config.plugins.length;u++)n.push(u<i?{state:r,n:t.length}:{state:this,n:0})}t.push(c),r=r.applyInner(c),o=!0}n&&(n[i]={state:r,n:t.length})}}if(!o)return{state:r,transactions:t}}},Di.prototype.applyInner=function(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");for(var t=new Di(this.config),r=this.config.fields,n=0;n<r.length;n++){var o=r[n];t[o.name]=o.apply(e,this[o.name],this,t)}for(var i=0;i<Ii.length;i++)Ii[i](this,e,t);return t},Pi.tr.get=function(){return new Ei(this)},Di.create=function(e){for(var t=new Ti(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new Di(t),n=0;n<t.fields.length;n++)r[t.fields[n].name]=t.fields[n].init(e,r);return r},Di.prototype.reconfigure=function(e){for(var t=new Ti(this.schema,e.plugins),r=t.fields,n=new Di(t),o=0;o<r.length;o++){var i=r[o].name;n[i]=this.hasOwnProperty(i)?this[i]:r[o].init(e,n)}return n},Di.prototype.toJSON=function(e){var t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map((function(e){return e.toJSON()}))),e&&"object"==typeof e)for(var r in e){if("doc"==r||"selection"==r)throw new RangeError("The JSON fields `doc` and `selection` are reserved");var n=e[r],o=n.spec.state;o&&o.toJSON&&(t[r]=o.toJSON.call(n,this[n.key]))}return t},Di.fromJSON=function(e,t,r){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");var n=new Ti(e.schema,e.plugins),o=new Di(n);return n.fields.forEach((function(n){if("doc"==n.name)o.doc=Zn.fromJSON(e.schema,t.doc);else if("selection"==n.name)o.selection=mi.fromJSON(o.doc,t.selection);else if("storedMarks"==n.name)t.storedMarks&&(o.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(r)for(var i in r){var a=r[i],s=a.spec.state;if(a.key==n.name&&s&&s.fromJSON&&Object.prototype.hasOwnProperty.call(t,i))return void(o[n.name]=s.fromJSON.call(a,e,t[i],o))}o[n.name]=n.init(e,o)}})),o},Di.addApplyListener=function(e){Ii.push(e)},Di.removeApplyListener=function(e){var t=Ii.indexOf(e);t>-1&&Ii.splice(t,1)},Object.defineProperties(Di.prototype,Pi);var Ii=[];function Vi(e,t,r){for(var n in e){var o=e[n];o instanceof Function?o=o.bind(t):"handleDOMEvents"==n&&(o=Vi(o,t,{})),r[n]=o}return r}var zi=function(e){this.props={},e.props&&Vi(e.props,this,this.props),this.spec=e,this.key=e.key?e.key.key:Bi("plugin")};zi.prototype.getState=function(e){return e[this.key]};var $i=Object.create(null);function Bi(e){return e in $i?e+"$"+ ++$i[e]:($i[e]=0,e+"$")}var Hi=function(e){void 0===e&&(e="key"),this.key=Bi(e)};Hi.prototype.get=function(e){return e.config.pluginsByKey[this.key]},Hi.prototype.getState=function(e){return e[this.key]};var Li=function(e,t){var r;this.match=e,this.handler="string"==typeof t?(r=t,function(e,t,n,o){var i=r;if(t[1]){var a=t[0].lastIndexOf(t[1]);i+=t[0].slice(a+t[1].length);var s=(n+=a)-o;s>0&&(i=t[0].slice(a-s,a)+i,n=o)}return e.tr.insertText(i,n,o)}):t};function _i(e,t,r,n,o,i){if(e.composing)return!1;var a=e.state,s=a.doc.resolve(t);if(s.parent.type.spec.code)return!1;for(var l=s.parent.textBetween(Math.max(0,s.parentOffset-500),s.parentOffset,null,"￼")+n,c=0;c<o.length;c++){var u=o[c].match.exec(l),h=u&&o[c].handler(a,u,t-(u[0].length-n.length),r);if(h)return e.dispatch(h.setMeta(i,{transform:h,from:t,to:r,text:n})),!0}return!1}function Fi(e,t){for(var r=e.plugins,n=0;n<r.length;n++){var o=r[n],i=void 0;if(o.spec.isInputRules&&(i=o.getState(e))){if(t){for(var a=e.tr,s=i.transform,l=s.steps.length-1;l>=0;l--)a.step(s.steps[l].invert(s.docs[l]));if(i.text){var c=a.doc.resolve(i.from).marks();a.replaceWith(i.from,i.to,e.schema.text(i.text,c))}else a.delete(i.from,i.to);t(a)}return!0}}return!1}function ji(e,t,r,n){return new Li(e,(function(e,o,i,a){var s=r instanceof Function?r(o):r,l=e.tr.delete(i,a),c=l.doc.resolve(i).blockRange(),u=c&&Yo(c,t,s);if(!u)return null;l.wrap(c,u);var h=l.doc.resolve(i-1).nodeBefore;return h&&h.type==t&&ti(l.doc,i-1)&&(!n||n(o,h))&&l.join(i-1),l}))}function Wi(e,t,r){return function(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}(e,Ht(e,t,"set"),r),r}new Li(/--$/,"—"),new Li(/\.\.\.$/,"…"),new Li(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(")$/,"“"),new Li(/"$/,"”"),new Li(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(')$/,"‘"),new Li(/'$/,"’");var Ki={};if("undefined"!=typeof navigator&&"undefined"!=typeof document){var Ui=/Edge\/(\d+)/.exec(navigator.userAgent),qi=/MSIE \d/.test(navigator.userAgent),Ji=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);Ki.mac=/Mac/.test(navigator.platform);var Zi=Ki.ie=!!(qi||Ji||Ui);Ki.ie_version=qi?document.documentMode||6:Ji?+Ji[1]:Ui?+Ui[1]:null,Ki.gecko=!Zi&&/gecko\/(\d+)/i.test(navigator.userAgent),Ki.gecko_version=Ki.gecko&&+(/Firefox\/(\d+)/.exec(navigator.userAgent)||[0,0])[1];var Gi=!Zi&&/Chrome\/(\d+)/.exec(navigator.userAgent);Ki.chrome=!!Gi,Ki.chrome_version=Gi&&+Gi[1],Ki.safari=!Zi&&/Apple Computer/.test(navigator.vendor),Ki.ios=Ki.safari&&(/Mobile\/\w+/.test(navigator.userAgent)||navigator.maxTouchPoints>2),Ki.android=/Android \d/.test(navigator.userAgent),Ki.webkit="webkitFontSmoothing"in document.documentElement.style,Ki.webkit_version=Ki.webkit&&+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]}var Xi=function(e){for(var t=0;;t++)if(!(e=e.previousSibling))return t},Yi=function(e){var t=e.assignedSlot||e.parentNode;return t&&11==t.nodeType?t.host:t},Qi=null,ea=function(e,t,r){var n=Qi||(Qi=document.createRange());return n.setEnd(e,null==r?e.nodeValue.length:r),n.setStart(e,t||0),n},ta=function(e,t,r,n){return r&&(na(e,t,r,n,-1)||na(e,t,r,n,1))},ra=/^(img|br|input|textarea|hr)$/i;function na(e,t,r,n,o){for(;;){if(e==r&&t==n)return!0;if(t==(o<0?0:oa(e))){var i=e.parentNode;if(1!=i.nodeType||ia(e)||ra.test(e.nodeName)||"false"==e.contentEditable)return!1;t=Xi(e)+(o<0?0:1),e=i}else{if(1!=e.nodeType)return!1;if("false"==(e=e.childNodes[t+(o<0?-1:0)]).contentEditable)return!1;t=o<0?oa(e):0}}}function oa(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function ia(e){for(var t,r=e;r&&!(t=r.pmViewDesc);r=r.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==e||t.contentDOM==e)}var aa=function(e){var t=e.isCollapsed;return t&&Ki.chrome&&e.rangeCount&&!e.getRangeAt(0).collapsed&&(t=!1),t};function sa(e,t){var r=document.createEvent("Event");return r.initEvent("keydown",!0,!0),r.keyCode=e,r.key=r.code=t,r}function la(e){return{left:0,right:e.documentElement.clientWidth,top:0,bottom:e.documentElement.clientHeight}}function ca(e,t){return"number"==typeof e?e:e[t]}function ua(e){var t=e.getBoundingClientRect(),r=t.width/e.offsetWidth||1,n=t.height/e.offsetHeight||1;return{left:t.left,right:t.left+e.clientWidth*r,top:t.top,bottom:t.top+e.clientHeight*n}}function ha(e,t,r){for(var n=e.someProp("scrollThreshold")||0,o=e.someProp("scrollMargin")||5,i=e.dom.ownerDocument,a=r||e.dom;a;a=Yi(a))if(1==a.nodeType){var s=a==i.body||1!=a.nodeType,l=s?la(i):ua(a),c=0,u=0;if(t.top<l.top+ca(n,"top")?u=-(l.top-t.top+ca(o,"top")):t.bottom>l.bottom-ca(n,"bottom")&&(u=t.bottom-l.bottom+ca(o,"bottom")),t.left<l.left+ca(n,"left")?c=-(l.left-t.left+ca(o,"left")):t.right>l.right-ca(n,"right")&&(c=t.right-l.right+ca(o,"right")),c||u)if(s)i.defaultView.scrollBy(c,u);else{var h=a.scrollLeft,d=a.scrollTop;u&&(a.scrollTop+=u),c&&(a.scrollLeft+=c);var p=a.scrollLeft-h,f=a.scrollTop-d;t={left:t.left-p,top:t.top-f,right:t.right-p,bottom:t.bottom-f}}if(s)break}}function da(e){for(var t=[],r=e.ownerDocument;e&&(t.push({dom:e,top:e.scrollTop,left:e.scrollLeft}),e!=r);e=Yi(e));return t}function pa(e,t){for(var r=0;r<e.length;r++){var n=e[r],o=n.dom,i=n.top,a=n.left;o.scrollTop!=i+t&&(o.scrollTop=i+t),o.scrollLeft!=a&&(o.scrollLeft=a)}}var fa=null;function va(e,t){for(var r,n,o=2e8,i=0,a=t.top,s=t.top,l=e.firstChild,c=0;l;l=l.nextSibling,c++){var u=void 0;if(1==l.nodeType)u=l.getClientRects();else{if(3!=l.nodeType)continue;u=ea(l).getClientRects()}for(var h=0;h<u.length;h++){var d=u[h];if(d.top<=a&&d.bottom>=s){a=Math.max(d.bottom,a),s=Math.min(d.top,s);var p=d.left>t.left?d.left-t.left:d.right<t.left?t.left-d.right:0;if(p<o){r=l,o=p,n=p&&3==r.nodeType?{left:d.right<t.left?d.right:d.left,top:t.top}:t,1==l.nodeType&&p&&(i=c+(t.left>=(d.left+d.right)/2?1:0));continue}}!r&&(t.left>=d.right&&t.top>=d.top||t.left>=d.left&&t.top>=d.bottom)&&(i=c+1)}}return r&&3==r.nodeType?function(e,t){for(var r=e.nodeValue.length,n=document.createRange(),o=0;o<r;o++){n.setEnd(e,o+1),n.setStart(e,o);var i=wa(n,1);if(i.top!=i.bottom&&ma(t,i))return{node:e,offset:o+(t.left>=(i.left+i.right)/2?1:0)}}return{node:e,offset:0}}(r,n):!r||o&&1==r.nodeType?{node:e,offset:i}:va(r,n)}function ma(e,t){return e.left>=t.left-1&&e.left<=t.right+1&&e.top>=t.top-1&&e.top<=t.bottom+1}function ga(e,t,r){var n=e.childNodes.length;if(n&&r.top<r.bottom)for(var o=Math.max(0,Math.min(n-1,Math.floor(n*(t.top-r.top)/(r.bottom-r.top))-2)),i=o;;){var a=e.childNodes[i];if(1==a.nodeType)for(var s=a.getClientRects(),l=0;l<s.length;l++){var c=s[l];if(ma(t,c))return ga(a,t,c)}if((i=(i+1)%n)==o)break}return e}function ya(e,t){var r,n,o,i,a=e.root;if(a.caretPositionFromPoint)try{var s=a.caretPositionFromPoint(t.left,t.top);s&&(o=(r=s).offsetNode,i=r.offset)}catch(m){}if(!o&&a.caretRangeFromPoint){var l=a.caretRangeFromPoint(t.left,t.top);l&&(o=(n=l).startContainer,i=n.startOffset)}var c,u=a.elementFromPoint(t.left,t.top+1);if(!u||!e.dom.contains(1!=u.nodeType?u.parentNode:u)){var h=e.dom.getBoundingClientRect();if(!ma(t,h))return null;if(!(u=ga(e.dom,t,h)))return null}if(Ki.safari)for(var d=u;o&&d;d=Yi(d))d.draggable&&(o=i=null);if(u=function(e,t){var r=e.parentNode;return r&&/^li$/i.test(r.nodeName)&&t.left<e.getBoundingClientRect().left?r:e}(u,t),o){if(Ki.gecko&&1==o.nodeType&&(i=Math.min(i,o.childNodes.length))<o.childNodes.length){var p,f=o.childNodes[i];"IMG"==f.nodeName&&(p=f.getBoundingClientRect()).right<=t.left&&p.bottom>t.top&&i++}o==e.dom&&i==o.childNodes.length-1&&1==o.lastChild.nodeType&&t.top>o.lastChild.getBoundingClientRect().bottom?c=e.state.doc.content.size:0!=i&&1==o.nodeType&&"BR"==o.childNodes[i-1].nodeName||(c=function(e,t,r,n){for(var o=-1,i=t;i!=e.dom;){var a=e.docView.nearestDesc(i,!0);if(!a)return null;if(a.node.isBlock&&a.parent){var s=a.dom.getBoundingClientRect();if(s.left>n.left||s.top>n.top)o=a.posBefore;else{if(!(s.right<n.left||s.bottom<n.top))break;o=a.posAfter}}i=a.dom.parentNode}return o>-1?o:e.docView.posFromDOM(t,r)}(e,o,i,t))}null==c&&(c=function(e,t,r){var n=va(t,r),o=n.node,i=n.offset,a=-1;if(1==o.nodeType&&!o.firstChild){var s=o.getBoundingClientRect();a=s.left!=s.right&&r.left>(s.left+s.right)/2?1:-1}return e.docView.posFromDOM(o,i,a)}(e,u,t));var v=e.docView.nearestDesc(u,!0);return{pos:c,inside:v?v.posAtStart-v.border:-1}}function wa(e,t){var r=e.getClientRects();return r.length?r[t<0?0:r.length-1]:e.getBoundingClientRect()}var ba=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function ka(e,t,r){var n=e.docView.domFromPos(t,r<0?-1:1),o=n.node,i=n.offset,a=Ki.webkit||Ki.gecko;if(3==o.nodeType){if(!a||!ba.test(o.nodeValue)&&(r<0?i:i!=o.nodeValue.length)){var s=i,l=i,c=r<0?1:-1;return r<0&&!i?(l++,c=-1):r>=0&&i==o.nodeValue.length?(s--,c=1):r<0?s--:l++,xa(wa(ea(o,s,l),c),c<0)}var u=wa(ea(o,i,i),r);if(Ki.gecko&&i&&/\s/.test(o.nodeValue[i-1])&&i<o.nodeValue.length){var h=wa(ea(o,i-1,i-1),-1);if(h.top==u.top){var d=wa(ea(o,i,i+1),-1);if(d.top!=u.top)return xa(d,d.left<h.left)}}return u}if(!e.state.doc.resolve(t).parent.inlineContent){if(i&&(r<0||i==oa(o))){var p=o.childNodes[i-1];if(1==p.nodeType)return Sa(p.getBoundingClientRect(),!1)}if(i<oa(o)){var f=o.childNodes[i];if(1==f.nodeType)return Sa(f.getBoundingClientRect(),!0)}return Sa(o.getBoundingClientRect(),r>=0)}if(i&&(r<0||i==oa(o))){var v=o.childNodes[i-1],m=3==v.nodeType?ea(v,oa(v)-(a?0:1)):1!=v.nodeType||"BR"==v.nodeName&&v.nextSibling?null:v;if(m)return xa(wa(m,1),!1)}if(i<oa(o)){var g=o.childNodes[i],y=3==g.nodeType?ea(g,0,a?0:1):1==g.nodeType?g:null;if(y)return xa(wa(y,-1),!0)}return xa(wa(3==o.nodeType?ea(o):o,-r),r>=0)}function xa(e,t){if(0==e.width)return e;var r=t?e.left:e.right;return{top:e.top,bottom:e.bottom,left:r,right:r}}function Sa(e,t){if(0==e.height)return e;var r=t?e.top:e.bottom;return{top:r,bottom:r,left:e.left,right:e.right}}function Ma(e,t,r){var n=e.state,o=e.root.activeElement;n!=t&&e.updateState(t),o!=e.dom&&e.focus();try{return r()}finally{n!=t&&e.updateState(n),o!=e.dom&&o&&o.focus()}}var Ca=/[\u0590-\u08ac]/;var Oa=null,Ea=null,Aa=!1;function Na(e,t,r){return Oa==t&&Ea==r?Aa:(Oa=t,Ea=r,Aa="up"==r||"down"==r?function(e,t,r){var n=t.selection,o="up"==r?n.$from:n.$to;return Ma(e,t,(function(){for(var t=e.docView.domFromPos(o.pos,"up"==r?-1:1).node;;){var n=e.docView.nearestDesc(t,!0);if(!n)break;if(n.node.isBlock){t=n.dom;break}t=n.dom.parentNode}for(var i=ka(e,o.pos,1),a=t.firstChild;a;a=a.nextSibling){var s=void 0;if(1==a.nodeType)s=a.getClientRects();else{if(3!=a.nodeType)continue;s=ea(a,0,a.nodeValue.length).getClientRects()}for(var l=0;l<s.length;l++){var c=s[l];if(c.bottom>c.top&&("up"==r?c.bottom<i.top+1:c.top>i.bottom-1))return!1}}return!0}))}(e,t,r):function(e,t,r){var n=t.selection.$head;if(!n.parent.isTextblock)return!1;var o=n.parentOffset,i=!o,a=o==n.parent.content.size,s=getSelection();return Ca.test(n.parent.textContent)&&s.modify?Ma(e,t,(function(){var t=s.getRangeAt(0),o=s.focusNode,i=s.focusOffset,a=s.caretBidiLevel;s.modify("move",r,"character");var l=!(n.depth?e.docView.domAfterPos(n.before()):e.dom).contains(1==s.focusNode.nodeType?s.focusNode:s.focusNode.parentNode)||o==s.focusNode&&i==s.focusOffset;return s.removeAllRanges(),s.addRange(t),null!=a&&(s.caretBidiLevel=a),l})):"left"==r||"backward"==r?i:a}(e,t,r))}var Ra=function(e,t,r,n){this.parent=e,this.children=t,this.dom=r,r.pmViewDesc=this,this.contentDOM=n,this.dirty=0},Ta={beforePosition:{configurable:!0},size:{configurable:!0},border:{configurable:!0},posBefore:{configurable:!0},posAtStart:{configurable:!0},posAfter:{configurable:!0},posAtEnd:{configurable:!0},contentLost:{configurable:!0},domAtom:{configurable:!0}};Ra.prototype.matchesWidget=function(){return!1},Ra.prototype.matchesMark=function(){return!1},Ra.prototype.matchesNode=function(){return!1},Ra.prototype.matchesHack=function(){return!1},Ta.beforePosition.get=function(){return!1},Ra.prototype.parseRule=function(){return null},Ra.prototype.stopEvent=function(){return!1},Ta.size.get=function(){for(var e=0,t=0;t<this.children.length;t++)e+=this.children[t].size;return e},Ta.border.get=function(){return 0},Ra.prototype.destroy=function(){this.parent=null,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=null);for(var e=0;e<this.children.length;e++)this.children[e].destroy()},Ra.prototype.posBeforeChild=function(e){for(var t=0,r=this.posAtStart;t<this.children.length;t++){var n=this.children[t];if(n==e)return r;r+=n.size}},Ta.posBefore.get=function(){return this.parent.posBeforeChild(this)},Ta.posAtStart.get=function(){return this.parent?this.parent.posBeforeChild(this)+this.border:0},Ta.posAfter.get=function(){return this.posBefore+this.size},Ta.posAtEnd.get=function(){return this.posAtStart+this.size-2*this.border},Ra.prototype.localPosFromDOM=function(e,t,r){if(this.contentDOM&&this.contentDOM.contains(1==e.nodeType?e:e.parentNode)){if(r<0){var n,o;if(e==this.contentDOM)n=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;n=e.previousSibling}for(;n&&(!(o=n.pmViewDesc)||o.parent!=this);)n=n.previousSibling;return n?this.posBeforeChild(o)+o.size:this.posAtStart}var i,a;if(e==this.contentDOM)i=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;i=e.nextSibling}for(;i&&(!(a=i.pmViewDesc)||a.parent!=this);)i=i.nextSibling;return i?this.posBeforeChild(a):this.posAtEnd}var s;if(e==this.dom&&this.contentDOM)s=t>Xi(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))s=2&e.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==t)for(var l=e;;l=l.parentNode){if(l==this.dom){s=!1;break}if(l.parentNode.firstChild!=l)break}if(null==s&&t==e.childNodes.length)for(var c=e;;c=c.parentNode){if(c==this.dom){s=!0;break}if(c.parentNode.lastChild!=c)break}}return(null==s?r>0:s)?this.posAtEnd:this.posAtStart},Ra.prototype.nearestDesc=function(e,t){for(var r=!0,n=e;n;n=n.parentNode){var o=this.getDesc(n);if(o&&(!t||o.node)){if(!r||!o.nodeDOM||(1==o.nodeDOM.nodeType?o.nodeDOM.contains(1==e.nodeType?e:e.parentNode):o.nodeDOM==e))return o;r=!1}}},Ra.prototype.getDesc=function(e){for(var t=e.pmViewDesc,r=t;r;r=r.parent)if(r==this)return t},Ra.prototype.posFromDOM=function(e,t,r){for(var n=e;n;n=n.parentNode){var o=this.getDesc(n);if(o)return o.localPosFromDOM(e,t,r)}return-1},Ra.prototype.descAt=function(e){for(var t=0,r=0;t<this.children.length;t++){var n=this.children[t],o=r+n.size;if(r==e&&o!=r){for(;!n.border&&n.children.length;)n=n.children[0];return n}if(e<o)return n.descAt(e-r-n.border);r=o}},Ra.prototype.domFromPos=function(e,t){if(!this.contentDOM)return{node:this.dom,offset:0};for(var r=0,n=0,o=!0;;n++,o=!1){for(;n<this.children.length&&(this.children[n].beforePosition||this.children[n].dom.parentNode!=this.contentDOM);)r+=this.children[n++].size;var i=n==this.children.length?null:this.children[n];if(r==e&&(0==t||!i||!i.size||i.border||t<0&&o)||i&&i.domAtom&&e<r+i.size)return{node:this.contentDOM,offset:i?Xi(i.dom):this.contentDOM.childNodes.length};if(!i)throw new Error("Invalid position "+e);var a=r+i.size;if(!i.domAtom&&(t<0&&!i.border?a>=e:a>e)&&(a>e||n+1>=this.children.length||!this.children[n+1].beforePosition))return i.domFromPos(e-r-i.border,t);r=a}},Ra.prototype.parseRange=function(e,t,r){if(void 0===r&&(r=0),0==this.children.length)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};for(var n=-1,o=-1,i=r,a=0;;a++){var s=this.children[a],l=i+s.size;if(-1==n&&e<=l){var c=i+s.border;if(e>=c&&t<=l-s.border&&s.node&&s.contentDOM&&this.contentDOM.contains(s.contentDOM))return s.parseRange(e,t,c);e=i;for(var u=a;u>0;u--){var h=this.children[u-1];if(h.size&&h.dom.parentNode==this.contentDOM&&!h.emptyChildAt(1)){n=Xi(h.dom)+1;break}e-=h.size}-1==n&&(n=0)}if(n>-1&&(l>t||a==this.children.length-1)){t=l;for(var d=a+1;d<this.children.length;d++){var p=this.children[d];if(p.size&&p.dom.parentNode==this.contentDOM&&!p.emptyChildAt(-1)){o=Xi(p.dom);break}t+=p.size}-1==o&&(o=this.contentDOM.childNodes.length);break}i=l}return{node:this.contentDOM,from:e,to:t,fromOffset:n,toOffset:o}},Ra.prototype.emptyChildAt=function(e){if(this.border||!this.contentDOM||!this.children.length)return!1;var t=this.children[e<0?0:this.children.length-1];return 0==t.size||t.emptyChildAt(e)},Ra.prototype.domAfterPos=function(e){var t=this.domFromPos(e,0),r=t.node,n=t.offset;if(1!=r.nodeType||n==r.childNodes.length)throw new RangeError("No node after pos "+e);return r.childNodes[n]},Ra.prototype.setSelection=function(e,t,r,n){for(var o=Math.min(e,t),i=Math.max(e,t),a=0,s=0;a<this.children.length;a++){var l=this.children[a],c=s+l.size;if(o>s&&i<c)return l.setSelection(e-s-l.border,t-s-l.border,r,n);s=c}var u=this.domFromPos(e,e?-1:1),h=t==e?u:this.domFromPos(t,t?-1:1),d=r.getSelection(),p=!1;if((Ki.gecko||Ki.safari)&&e==t){var f=u.node,v=u.offset;if(3==f.nodeType)(p=v&&"\n"==f.nodeValue[v-1])&&v==f.nodeValue.length&&f.nextSibling&&"BR"==f.nextSibling.nodeName&&(u=h={node:f.parentNode,offset:Xi(f)+1});else{var m=f.childNodes[v-1];p=m&&("BR"==m.nodeName||"false"==m.contentEditable)}}if(Ki.gecko&&d.focusNode&&d.focusNode!=h.node&&1==d.focusNode.nodeType){var g=d.focusNode.childNodes[d.focusOffset];g&&"false"==g.contentEditable&&(n=!0)}if(n||p&&Ki.safari||!ta(u.node,u.offset,d.anchorNode,d.anchorOffset)||!ta(h.node,h.offset,d.focusNode,d.focusOffset)){var y=!1;if((d.extend||e==t)&&!p){d.collapse(u.node,u.offset);try{e!=t&&d.extend(h.node,h.offset),y=!0}catch(k){if(!(k instanceof DOMException))throw k}}if(!y){if(e>t){var w=u;u=h,h=w}var b=document.createRange();b.setEnd(h.node,h.offset),b.setStart(u.node,u.offset),d.removeAllRanges(),d.addRange(b)}}},Ra.prototype.ignoreMutation=function(e){return!this.contentDOM&&"selection"!=e.type},Ta.contentLost.get=function(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)},Ra.prototype.markDirty=function(e,t){for(var r=0,n=0;n<this.children.length;n++){var o=this.children[n],i=r+o.size;if(r==i?e<=i&&t>=r:e<i&&t>r){var a=r+o.border,s=i-o.border;if(e>=a&&t<=s)return this.dirty=e==r||t==i?2:1,void(e!=a||t!=s||!o.contentLost&&o.dom.parentNode==this.contentDOM?o.markDirty(e-a,t-a):o.dirty=3);o.dirty=3}r=i}this.dirty=2},Ra.prototype.markParentsDirty=function(){for(var e=1,t=this.parent;t;t=t.parent,e++){var r=1==e?2:1;t.dirty<r&&(t.dirty=r)}},Ta.domAtom.get=function(){return!1},Object.defineProperties(Ra.prototype,Ta);var Da=[],Pa=function(e){function t(t,r,n,o){var i,a=r.type.toDOM;if("function"==typeof a&&(a=a(n,(function(){return i?i.parent?i.parent.posBeforeChild(i):void 0:o}))),!r.type.spec.raw){if(1!=a.nodeType){var s=document.createElement("span");s.appendChild(a),a=s}a.contentEditable=!1,a.classList.add("ProseMirror-widget")}e.call(this,t,Da,a,null),this.widget=r,i=this}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var r={beforePosition:{configurable:!0},domAtom:{configurable:!0}};return r.beforePosition.get=function(){return this.widget.type.side<0},t.prototype.matchesWidget=function(e){return 0==this.dirty&&e.type.eq(this.widget.type)},t.prototype.parseRule=function(){return{ignore:!0}},t.prototype.stopEvent=function(e){var t=this.widget.spec.stopEvent;return!!t&&t(e)},t.prototype.ignoreMutation=function(e){return"selection"!=e.type||this.widget.spec.ignoreSelection},r.domAtom.get=function(){return!0},Object.defineProperties(t.prototype,r),t}(Ra),Ia=function(e){function t(t,r,n,o){e.call(this,t,Da,r,null),this.textDOM=n,this.text=o}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var r={size:{configurable:!0}};return r.size.get=function(){return this.text.length},t.prototype.localPosFromDOM=function(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t},t.prototype.domFromPos=function(e){return{node:this.textDOM,offset:e}},t.prototype.ignoreMutation=function(e){return"characterData"===e.type&&e.target.nodeValue==e.oldValue},Object.defineProperties(t.prototype,r),t}(Ra),Va=function(e){function t(t,r,n,o){e.call(this,t,[],n,o),this.mark=r}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.create=function(e,r,n,o){var i=o.nodeViews[r.type.name],a=i&&i(r,o,n);return a&&a.dom||(a=Do.renderSpec(document,r.type.spec.toDOM(r,n))),new t(e,r,a.dom,a.contentDOM||a.dom)},t.prototype.parseRule=function(){return{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}},t.prototype.matchesMark=function(e){return 3!=this.dirty&&this.mark.eq(e)},t.prototype.markDirty=function(t,r){if(e.prototype.markDirty.call(this,t,r),0!=this.dirty){for(var n=this.parent;!n.node;)n=n.parent;n.dirty<this.dirty&&(n.dirty=this.dirty),this.dirty=0}},t.prototype.slice=function(e,r,n){var o=t.create(this.parent,this.mark,!0,n),i=this.children,a=this.size;r<a&&(i=Ya(i,r,a,n)),e>0&&(i=Ya(i,0,e,n));for(var s=0;s<i.length;s++)i[s].parent=o;return o.children=i,o},t}(Ra),za=function(e){function t(t,r,n,o,i,a,s,l,c){e.call(this,t,r.isLeaf?Da:[],i,a),this.nodeDOM=s,this.node=r,this.outerDeco=n,this.innerDeco=o,a&&this.updateChildren(l,c)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var r={size:{configurable:!0},border:{configurable:!0},domAtom:{configurable:!0}};return t.create=function(e,r,n,o,i,a){var s,l,c=i.nodeViews[r.type.name],u=c&&c(r,i,(function(){return l?l.parent?l.parent.posBeforeChild(l):void 0:a}),n,o),h=u&&u.dom,d=u&&u.contentDOM;if(r.isText)if(h){if(3!=h.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else h=document.createTextNode(r.text);else h||(h=(s=Do.renderSpec(document,r.type.spec.toDOM(r))).dom,d=s.contentDOM);d||r.isText||"BR"==h.nodeName||(h.hasAttribute("contenteditable")||(h.contentEditable=!1),r.type.spec.draggable&&(h.draggable=!0));var p=h;return h=qa(h,n,r),u?l=new La(e,r,n,o,h,d,p,u,i,a+1):r.isText?new Ba(e,r,n,o,h,p,i):new t(e,r,n,o,h,d,p,i,a+1)},t.prototype.parseRule=function(){var e=this;if(this.node.type.spec.reparseInView)return null;var t={node:this.node.type.name,attrs:this.node.attrs};return this.node.type.spec.code&&(t.preserveWhitespace="full"),this.contentDOM&&!this.contentLost?t.contentElement=this.contentDOM:t.getContent=function(){return e.contentDOM?kn.empty:e.node.content},t},t.prototype.matchesNode=function(e,t,r){return 0==this.dirty&&e.eq(this.node)&&Ja(t,this.outerDeco)&&r.eq(this.innerDeco)},r.size.get=function(){return this.node.nodeSize},r.border.get=function(){return this.node.isLeaf?0:1},t.prototype.updateChildren=function(e,t){var r=this,n=this.node.inlineContent,o=t,i=n&&e.composing&&this.localCompositionNode(e,t),a=new Ga(this,i&&i.node);!function(e,t,r,n){var o=t.locals(e),i=0;if(0==o.length){for(var a=0;a<e.childCount;a++){var s=e.child(a);n(s,o,t.forChild(i,s),a),i+=s.nodeSize}return}for(var l=0,c=[],u=null,h=0;;){if(l<o.length&&o[l].to==i){for(var d=o[l++],p=void 0;l<o.length&&o[l].to==i;)(p||(p=[d])).push(o[l++]);if(p){p.sort(Xa);for(var f=0;f<p.length;f++)r(p[f],h,!!u)}else r(d,h,!!u)}var v=void 0,m=void 0;if(u)m=-1,v=u,u=null;else{if(!(h<e.childCount))break;m=h,v=e.child(h++)}for(var g=0;g<c.length;g++)c[g].to<=i&&c.splice(g--,1);for(;l<o.length&&o[l].from<=i&&o[l].to>i;)c.push(o[l++]);var y=i+v.nodeSize;if(v.isText){var w=y;l<o.length&&o[l].from<w&&(w=o[l].from);for(var b=0;b<c.length;b++)c[b].to<w&&(w=c[b].to);w<y&&(u=v.cut(w-i),v=v.cut(0,w-i),y=w,m=-1)}n(v,c.length?v.isInline&&!v.isLeaf?c.filter((function(e){return!e.inline})):c.slice():Da,t.forChild(i,v),m),i=y}}(this.node,this.innerDeco,(function(t,i,s){t.spec.marks?a.syncToMarks(t.spec.marks,n,e):t.type.side>=0&&!s&&a.syncToMarks(i==r.node.childCount?On.none:r.node.child(i).marks,n,e),a.placeWidget(t,e,o)}),(function(t,r,i,s){a.syncToMarks(t.marks,n,e),a.findNodeMatch(t,r,i,s)||a.updateNextNode(t,r,i,e,s)||a.addNode(t,r,i,e,o),o+=t.nodeSize})),a.syncToMarks(Da,n,e),this.node.isTextblock&&a.addTextblockHacks(),a.destroyRest(),(a.changed||2==this.dirty)&&(i&&this.protectLocalComposition(e,i),_a(this.contentDOM,this.children,e),Ki.ios&&function(e){if("UL"==e.nodeName||"OL"==e.nodeName){var t=e.style.cssText;e.style.cssText=t+"; list-style: square !important",window.getComputedStyle(e).listStyle,e.style.cssText=t}}(this.dom))},t.prototype.localCompositionNode=function(e,t){var r=e.state.selection,n=r.from,o=r.to;if(!(!(e.state.selection instanceof wi)||n<t||o>t+this.node.content.size)){var i=e.root.getSelection(),a=function(e,t){for(;;){if(3==e.nodeType)return e;if(1==e.nodeType&&t>0){if(e.childNodes.length>t&&3==e.childNodes[t].nodeType)return e.childNodes[t];t=oa(e=e.childNodes[t-1])}else{if(!(1==e.nodeType&&t<e.childNodes.length))return null;e=e.childNodes[t],t=0}}}(i.focusNode,i.focusOffset);if(a&&this.dom.contains(a.parentNode)){var s=a.nodeValue,l=function(e,t,r,n){for(var o=0,i=0;o<e.childCount&&i<=n;){var a=e.child(o++),s=i;if(i+=a.nodeSize,a.isText){for(var l=a.text;o<e.childCount;){var c=e.child(o++);if(i+=c.nodeSize,!c.isText)break;l+=c.text}if(i>=r){var u=l.lastIndexOf(t,n-s);if(u>=0&&u+t.length+s>=r)return s+u}}}return-1}(this.node.content,s,n-t,o-t);return l<0?null:{node:a,pos:l,text:s}}}},t.prototype.protectLocalComposition=function(e,t){var r=t.node,n=t.pos,o=t.text;if(!this.getDesc(r)){for(var i=r;i.parentNode!=this.contentDOM;i=i.parentNode){for(;i.previousSibling;)i.parentNode.removeChild(i.previousSibling);for(;i.nextSibling;)i.parentNode.removeChild(i.nextSibling);i.pmViewDesc&&(i.pmViewDesc=null)}var a=new Ia(this,i,r,o);e.compositionNodes.push(a),this.children=Ya(this.children,n,n+o.length,e,a)}},t.prototype.update=function(e,t,r,n){return!(3==this.dirty||!e.sameMarkup(this.node))&&(this.updateInner(e,t,r,n),!0)},t.prototype.updateInner=function(e,t,r,n){this.updateOuterDeco(t),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(n,this.posAtStart),this.dirty=0},t.prototype.updateOuterDeco=function(e){if(!Ja(e,this.outerDeco)){var t=1!=this.nodeDOM.nodeType,r=this.dom;this.dom=Ka(this.dom,this.nodeDOM,Wa(this.outerDeco,this.node,t),Wa(e,this.node,t)),this.dom!=r&&(r.pmViewDesc=null,this.dom.pmViewDesc=this),this.outerDeco=e}},t.prototype.selectNode=function(){this.nodeDOM.classList.add("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||(this.dom.draggable=!0)},t.prototype.deselectNode=function(){this.nodeDOM.classList.remove("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||this.dom.removeAttribute("draggable")},r.domAtom.get=function(){return this.node.isAtom},Object.defineProperties(t.prototype,r),t}(Ra);function $a(e,t,r,n,o){return qa(n,t,e),new za(null,e,t,r,n,n,n,o,0)}var Ba=function(e){function t(t,r,n,o,i,a,s){e.call(this,t,r,n,o,i,null,a,s)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var r={domAtom:{configurable:!0}};return t.prototype.parseRule=function(){for(var e=this.nodeDOM.parentNode;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}},t.prototype.update=function(e,t,r,n){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!e.sameMarkup(this.node))&&(this.updateOuterDeco(t),0==this.dirty&&e.text==this.node.text||e.text==this.nodeDOM.nodeValue||(this.nodeDOM.nodeValue=e.text,n.trackWrites==this.nodeDOM&&(n.trackWrites=null)),this.node=e,this.dirty=0,!0)},t.prototype.inParent=function(){for(var e=this.parent.contentDOM,t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1},t.prototype.domFromPos=function(e){return{node:this.nodeDOM,offset:e}},t.prototype.localPosFromDOM=function(t,r,n){return t==this.nodeDOM?this.posAtStart+Math.min(r,this.node.text.length):e.prototype.localPosFromDOM.call(this,t,r,n)},t.prototype.ignoreMutation=function(e){return"characterData"!=e.type&&"selection"!=e.type},t.prototype.slice=function(e,r,n){var o=this.node.cut(e,r),i=document.createTextNode(o.text);return new t(this.parent,o,this.outerDeco,this.innerDeco,i,i,n)},r.domAtom.get=function(){return!1},Object.defineProperties(t.prototype,r),t}(za),Ha=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var r={domAtom:{configurable:!0}};return t.prototype.parseRule=function(){return{ignore:!0}},t.prototype.matchesHack=function(){return 0==this.dirty},r.domAtom.get=function(){return!0},Object.defineProperties(t.prototype,r),t}(Ra),La=function(e){function t(t,r,n,o,i,a,s,l,c,u){e.call(this,t,r,n,o,i,a,s,c,u),this.spec=l}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.update=function(t,r,n,o){if(3==this.dirty)return!1;if(this.spec.update){var i=this.spec.update(t,r,n);return i&&this.updateInner(t,r,n,o),i}return!(!this.contentDOM&&!t.isLeaf)&&e.prototype.update.call(this,t,r,n,o)},t.prototype.selectNode=function(){this.spec.selectNode?this.spec.selectNode():e.prototype.selectNode.call(this)},t.prototype.deselectNode=function(){this.spec.deselectNode?this.spec.deselectNode():e.prototype.deselectNode.call(this)},t.prototype.setSelection=function(t,r,n,o){this.spec.setSelection?this.spec.setSelection(t,r,n):e.prototype.setSelection.call(this,t,r,n,o)},t.prototype.destroy=function(){this.spec.destroy&&this.spec.destroy(),e.prototype.destroy.call(this)},t.prototype.stopEvent=function(e){return!!this.spec.stopEvent&&this.spec.stopEvent(e)},t.prototype.ignoreMutation=function(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):e.prototype.ignoreMutation.call(this,t)},t}(za);function _a(e,t,r){for(var n=e.firstChild,o=!1,i=0;i<t.length;i++){var a=t[i],s=a.dom;if(s.parentNode==e){for(;s!=n;)n=Za(n),o=!0;n=n.nextSibling}else o=!0,e.insertBefore(s,n);if(a instanceof Va){var l=n?n.previousSibling:e.lastChild;_a(a.contentDOM,a.children,r),n=l?l.nextSibling:e.firstChild}}for(;n;)n=Za(n),o=!0;o&&r.trackWrites==e&&(r.trackWrites=null)}function Fa(e){e&&(this.nodeName=e)}Fa.prototype=Object.create(null);var ja=[new Fa];function Wa(e,t,r){if(0==e.length)return ja;for(var n=r?ja[0]:new Fa,o=[n],i=0;i<e.length;i++){var a=e[i].type.attrs;if(a)for(var s in a.nodeName&&o.push(n=new Fa(a.nodeName)),a){var l=a[s];null!=l&&(r&&1==o.length&&o.push(n=new Fa(t.isInline?"span":"div")),"class"==s?n.class=(n.class?n.class+" ":"")+l:"style"==s?n.style=(n.style?n.style+";":"")+l:"nodeName"!=s&&(n[s]=l))}}return o}function Ka(e,t,r,n){if(r==ja&&n==ja)return t;for(var o=t,i=0;i<n.length;i++){var a=n[i],s=r[i];if(i){var l=void 0;s&&s.nodeName==a.nodeName&&o!=e&&(l=o.parentNode)&&l.tagName.toLowerCase()==a.nodeName||((l=document.createElement(a.nodeName)).pmIsDeco=!0,l.appendChild(o),s=ja[0]),o=l}Ua(o,s||ja[0],a)}return o}function Ua(e,t,r){for(var n in t)"class"==n||"style"==n||"nodeName"==n||n in r||e.removeAttribute(n);for(var o in r)"class"!=o&&"style"!=o&&"nodeName"!=o&&r[o]!=t[o]&&e.setAttribute(o,r[o]);if(t.class!=r.class){for(var i=t.class?t.class.split(" ").filter(Boolean):Da,a=r.class?r.class.split(" ").filter(Boolean):Da,s=0;s<i.length;s++)-1==a.indexOf(i[s])&&e.classList.remove(i[s]);for(var l=0;l<a.length;l++)-1==i.indexOf(a[l])&&e.classList.add(a[l])}if(t.style!=r.style){if(t.style)for(var c,u=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;c=u.exec(t.style);)e.style.removeProperty(c[1]);r.style&&(e.style.cssText+=r.style)}}function qa(e,t,r){return Ka(e,e,ja,Wa(t,r,1!=e.nodeType))}function Ja(e,t){if(e.length!=t.length)return!1;for(var r=0;r<e.length;r++)if(!e[r].type.eq(t[r].type))return!1;return!0}function Za(e){var t=e.nextSibling;return e.parentNode.removeChild(e),t}var Ga=function(e,t){this.top=e,this.lock=t,this.index=0,this.stack=[],this.changed=!1,this.preMatch=function(e,t){for(var r=e.childCount,n=t.length,o=new Map;r>0&&n>0;n--){var i=t[n-1],a=i.node;if(a){if(a!=e.child(r-1))break;--r,o.set(i,r)}}return{index:r,matched:o}}(e.node.content,e.children)};function Xa(e,t){return e.type.side-t.type.side}function Ya(e,t,r,n,o){for(var i=[],a=0,s=0;a<e.length;a++){var l=e[a],c=s,u=s+=l.size;c>=r||u<=t?i.push(l):(c<t&&i.push(l.slice(0,t-c,n)),o&&(i.push(o),o=null),u>r&&i.push(l.slice(r-c,l.size,n)))}return i}function Qa(e,t){var r=e.root.getSelection(),n=e.state.doc;if(!r.focusNode)return null;var o=e.docView.nearestDesc(r.focusNode),i=o&&0==o.size,a=e.docView.posFromDOM(r.focusNode,r.focusOffset);if(a<0)return null;var s,l,c=n.resolve(a);if(aa(r)){for(s=c;o&&!o.node;)o=o.parent;if(o&&o.node.isAtom&&ki.isSelectable(o.node)&&o.parent&&(!o.node.isInline||!function(e,t,r){for(var n=0==t,o=t==oa(e);n||o;){if(e==r)return!0;var i=Xi(e);if(!(e=e.parentNode))return!1;n=n&&0==i,o=o&&i==oa(e)}}(r.focusNode,r.focusOffset,o.dom))){var u=o.posBefore;l=new ki(a==u?c:n.resolve(u))}}else{var h=e.docView.posFromDOM(r.anchorNode,r.anchorOffset);if(h<0)return null;s=n.resolve(h)}l||(l=cs(e,s,c,"pointer"==t||e.state.selection.head<c.pos&&!i?1:-1));return l}function es(e){return e.editable?e.hasFocus():us(e)&&document.activeElement&&document.activeElement.contains(e.dom)}function ts(e,t){var r=e.state.selection;if(ss(e,r),es(e)){if(e.domObserver.disconnectSelection(),e.cursorWrapper)!function(e){var t=e.root.getSelection(),r=document.createRange(),n=e.cursorWrapper.dom,o="IMG"==n.nodeName;o?r.setEnd(n.parentNode,Xi(n)+1):r.setEnd(n,0);r.collapse(!1),t.removeAllRanges(),t.addRange(r),!o&&!e.state.selection.visible&&Ki.ie&&Ki.ie_version<=11&&(n.disabled=!0,n.disabled=!1)}(e);else{var n,o,i=r.anchor,a=r.head;!rs||r instanceof wi||(r.$from.parent.inlineContent||(n=ns(e,r.from)),r.empty||r.$from.parent.inlineContent||(o=ns(e,r.to))),e.docView.setSelection(i,a,e.root,t),rs&&(n&&as(n),o&&as(o)),r.visible?e.dom.classList.remove("ProseMirror-hideselection"):(e.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function(e){var t=e.dom.ownerDocument;t.removeEventListener("selectionchange",e.hideSelectionGuard);var r=e.root.getSelection(),n=r.anchorNode,o=r.anchorOffset;t.addEventListener("selectionchange",e.hideSelectionGuard=function(){r.anchorNode==n&&r.anchorOffset==o||(t.removeEventListener("selectionchange",e.hideSelectionGuard),setTimeout((function(){es(e)&&!e.state.selection.visible||e.dom.classList.remove("ProseMirror-hideselection")}),20))})}(e))}e.domObserver.setCurSelection(),e.domObserver.connectSelection()}}Ga.prototype.destroyBetween=function(e,t){if(e!=t){for(var r=e;r<t;r++)this.top.children[r].destroy();this.top.children.splice(e,t-e),this.changed=!0}},Ga.prototype.destroyRest=function(){this.destroyBetween(this.index,this.top.children.length)},Ga.prototype.syncToMarks=function(e,t,r){for(var n=0,o=this.stack.length>>1,i=Math.min(o,e.length);n<i&&(n==o-1?this.top:this.stack[n+1<<1]).matchesMark(e[n])&&!1!==e[n].type.spec.spanning;)n++;for(;n<o;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<e.length;){this.stack.push(this.top,this.index+1);for(var a=-1,s=this.index;s<Math.min(this.index+3,this.top.children.length);s++)if(this.top.children[s].matchesMark(e[o])){a=s;break}if(a>-1)a>this.index&&(this.changed=!0,this.destroyBetween(this.index,a)),this.top=this.top.children[this.index];else{var l=Va.create(this.top,e[o],t,r);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,o++}},Ga.prototype.findNodeMatch=function(e,t,r,n){var o=this.top.children,i=-1;if(n>=this.preMatch.index){for(var a=this.index;a<o.length;a++)if(o[a].matchesNode(e,t,r)){i=a;break}}else for(var s=this.index,l=Math.min(o.length,s+1);s<l;s++){var c=o[s];if(c.matchesNode(e,t,r)&&!this.preMatch.matched.has(c)){i=s;break}}return!(i<0)&&(this.destroyBetween(this.index,i),this.index++,!0)},Ga.prototype.updateNextNode=function(e,t,r,n,o){for(var i=this.index;i<this.top.children.length;i++){var a=this.top.children[i];if(a instanceof za){var s=this.preMatch.matched.get(a);if(null!=s&&s!=o)return!1;var l=a.dom;if(!(this.lock&&(l==this.lock||1==l.nodeType&&l.contains(this.lock.parentNode))&&!(e.isText&&a.node&&a.node.isText&&a.nodeDOM.nodeValue==e.text&&3!=a.dirty&&Ja(t,a.outerDeco)))&&a.update(e,t,r,n))return this.destroyBetween(this.index,i),a.dom!=l&&(this.changed=!0),this.index++,!0;break}}return!1},Ga.prototype.addNode=function(e,t,r,n,o){this.top.children.splice(this.index++,0,za.create(this.top,e,t,r,n,o)),this.changed=!0},Ga.prototype.placeWidget=function(e,t,r){var n=this.index<this.top.children.length?this.top.children[this.index]:null;if(!n||!n.matchesWidget(e)||e!=n.widget&&n.widget.type.toDOM.parentNode){var o=new Pa(this.top,e,t,r);this.top.children.splice(this.index++,0,o),this.changed=!0}else this.index++},Ga.prototype.addTextblockHacks=function(){for(var e=this.top.children[this.index-1];e instanceof Va;)e=e.children[e.children.length-1];if(!e||!(e instanceof Ba)||/\n$/.test(e.node.text))if(this.index<this.top.children.length&&this.top.children[this.index].matchesHack())this.index++;else{var t=document.createElement("br");this.top.children.splice(this.index++,0,new Ha(this.top,Da,t,null)),this.changed=!0}};var rs=Ki.safari||Ki.chrome&&Ki.chrome_version<63;function ns(e,t){var r=e.docView.domFromPos(t,0),n=r.node,o=r.offset,i=o<n.childNodes.length?n.childNodes[o]:null,a=o?n.childNodes[o-1]:null;if(Ki.safari&&i&&"false"==i.contentEditable)return is(i);if(!(i&&"false"!=i.contentEditable||a&&"false"!=a.contentEditable)){if(i)return is(i);if(a)return is(a)}}function is(e){return e.contentEditable="true",Ki.safari&&e.draggable&&(e.draggable=!1,e.wasDraggable=!0),e}function as(e){e.contentEditable="false",e.wasDraggable&&(e.draggable=!0,e.wasDraggable=null)}function ss(e,t){if(t instanceof ki){var r=e.docView.descAt(t.from);r!=e.lastSelectedViewDesc&&(ls(e),r&&r.selectNode(),e.lastSelectedViewDesc=r)}else ls(e)}function ls(e){e.lastSelectedViewDesc&&(e.lastSelectedViewDesc.parent&&e.lastSelectedViewDesc.deselectNode(),e.lastSelectedViewDesc=null)}function cs(e,t,r,n){return e.someProp("createSelectionBetween",(function(n){return n(e,t,r)}))||wi.between(t,r,n)}function us(e){var t=e.root.getSelection();if(!t.anchorNode)return!1;try{return e.dom.contains(3==t.anchorNode.nodeType?t.anchorNode.parentNode:t.anchorNode)&&(e.editable||e.dom.contains(3==t.focusNode.nodeType?t.focusNode.parentNode:t.focusNode))}catch(r){return!1}}function hs(e,t){var r=e.selection,n=r.$anchor,o=r.$head,i=t>0?n.max(o):n.min(o),a=i.parent.inlineContent?i.depth?e.doc.resolve(t>0?i.after():i.before()):null:i;return a&&mi.findFrom(a,t)}function ds(e,t){return e.dispatch(e.state.tr.setSelection(t).scrollIntoView()),!0}function ps(e,t,r){var n=e.state.selection;if(!(n instanceof wi)){if(n instanceof ki&&n.node.isInline)return ds(e,new wi(t>0?n.$to:n.$from));var o=hs(e.state,t);return!!o&&ds(e,o)}if(!n.empty||r.indexOf("s")>-1)return!1;if(e.endOfTextblock(t>0?"right":"left")){var i=hs(e.state,t);return!!(i&&i instanceof ki)&&ds(e,i)}if(!(Ki.mac&&r.indexOf("m")>-1)){var a,s=n.$head,l=s.textOffset?null:t<0?s.nodeBefore:s.nodeAfter;if(!l||l.isText)return!1;var c=t<0?s.pos-l.nodeSize:s.pos;return!!(l.isAtom||(a=e.docView.descAt(c))&&!a.contentDOM)&&(ki.isSelectable(l)?ds(e,new ki(t<0?e.state.doc.resolve(s.pos-l.nodeSize):s)):!!Ki.webkit&&ds(e,new wi(e.state.doc.resolve(t<0?c:c+l.nodeSize))))}}function fs(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function vs(e){var t=e.pmViewDesc;return t&&0==t.size&&(e.nextSibling||"BR"!=e.nodeName)}function ms(e){var t=e.root.getSelection(),r=t.focusNode,n=t.focusOffset;if(r){var o,i,a=!1;for(Ki.gecko&&1==r.nodeType&&n<fs(r)&&vs(r.childNodes[n])&&(a=!0);;)if(n>0){if(1!=r.nodeType)break;var s=r.childNodes[n-1];if(vs(s))o=r,i=--n;else{if(3!=s.nodeType)break;n=(r=s).nodeValue.length}}else{if(ys(r))break;for(var l=r.previousSibling;l&&vs(l);)o=r.parentNode,i=Xi(l),l=l.previousSibling;if(l)n=fs(r=l);else{if((r=r.parentNode)==e.dom)break;n=0}}a?ws(e,t,r,n):o&&ws(e,t,o,i)}}function gs(e){var t=e.root.getSelection(),r=t.focusNode,n=t.focusOffset;if(r){for(var o,i,a=fs(r);;)if(n<a){if(1!=r.nodeType)break;if(!vs(r.childNodes[n]))break;o=r,i=++n}else{if(ys(r))break;for(var s=r.nextSibling;s&&vs(s);)o=s.parentNode,i=Xi(s)+1,s=s.nextSibling;if(s)n=0,a=fs(r=s);else{if((r=r.parentNode)==e.dom)break;n=a=0}}o&&ws(e,t,o,i)}}function ys(e){var t=e.pmViewDesc;return t&&t.node&&t.node.isBlock}function ws(e,t,r,n){if(aa(t)){var o=document.createRange();o.setEnd(r,n),o.setStart(r,n),t.removeAllRanges(),t.addRange(o)}else t.extend&&t.extend(r,n);e.domObserver.setCurSelection();var i=e.state;setTimeout((function(){e.state==i&&ts(e)}),50)}function bs(e,t,r){var n=e.state.selection;if(n instanceof wi&&!n.empty||r.indexOf("s")>-1)return!1;if(Ki.mac&&r.indexOf("m")>-1)return!1;var o=n.$from,i=n.$to;if(!o.parent.inlineContent||e.endOfTextblock(t<0?"up":"down")){var a=hs(e.state,t);if(a&&a instanceof ki)return ds(e,a)}if(!o.parent.inlineContent){var s=t<0?o:i,l=n instanceof Si?mi.near(s,t):mi.findFrom(s,t);return!!l&&ds(e,l)}return!1}function ks(e,t){if(!(e.state.selection instanceof wi))return!0;var r=e.state.selection,n=r.$head,o=r.$anchor,i=r.empty;if(!n.sameParent(o))return!0;if(!i)return!1;if(e.endOfTextblock(t>0?"forward":"backward"))return!0;var a=!n.textOffset&&(t<0?n.nodeBefore:n.nodeAfter);if(a&&!a.isText){var s=e.state.tr;return t<0?s.delete(n.pos-a.nodeSize,n.pos):s.delete(n.pos,n.pos+a.nodeSize),e.dispatch(s),!0}return!1}function xs(e,t,r){e.domObserver.stop(),t.contentEditable=r,e.domObserver.start()}function Ss(e,t){var r=t.keyCode,n=function(e){var t="";return e.ctrlKey&&(t+="c"),e.metaKey&&(t+="m"),e.altKey&&(t+="a"),e.shiftKey&&(t+="s"),t}(t);return 8==r||Ki.mac&&72==r&&"c"==n?ks(e,-1)||ms(e):46==r||Ki.mac&&68==r&&"c"==n?ks(e,1)||gs(e):13==r||27==r||(37==r?ps(e,-1,n)||ms(e):39==r?ps(e,1,n)||gs(e):38==r?bs(e,-1,n)||ms(e):40==r?function(e){if(Ki.safari&&!(e.state.selection.$head.parentOffset>0)){var t=e.root.getSelection(),r=t.focusNode,n=t.focusOffset;if(r&&1==r.nodeType&&0==n&&r.firstChild&&"false"==r.firstChild.contentEditable){var o=r.firstChild;xs(e,o,!0),setTimeout((function(){return xs(e,o,!1)}),20)}}}(e)||bs(e,1,n)||gs(e):n==(Ki.mac?"m":"c")&&(66==r||73==r||89==r||90==r))}function Ms(e){var t=e.pmViewDesc;if(t)return t.parseRule();if("BR"==e.nodeName&&e.parentNode){if(Ki.safari&&/^(ul|ol)$/i.test(e.parentNode.nodeName)){var r=document.createElement("div");return r.appendChild(document.createElement("li")),{skip:r}}if(e.parentNode.lastChild==e||Ki.safari&&/^(tr|table)$/i.test(e.parentNode.nodeName))return{ignore:!0}}else if("IMG"==e.nodeName&&e.getAttribute("mark-placeholder"))return{ignore:!0}}function Cs(e,t,r,n,o){if(t<0){var i=e.lastSelectionTime>Date.now()-50?e.lastSelectionOrigin:null,a=Qa(e,i);if(a&&!e.state.selection.eq(a)){var s=e.state.tr.setSelection(a);"pointer"==i?s.setMeta("pointer",!0):"key"==i&&s.scrollIntoView(),e.dispatch(s)}}else{var l=e.state.doc.resolve(t),c=l.sharedDepth(r);t=l.before(c+1),r=e.state.doc.resolve(r).after(c+1);var u=e.state.selection,h=function(e,t,r){var n=e.docView.parseRange(t,r),o=n.node,i=n.fromOffset,a=n.toOffset,s=n.from,l=n.to,c=e.root.getSelection(),u=null,h=c.anchorNode;if(h&&e.dom.contains(1==h.nodeType?h:h.parentNode)&&(u=[{node:h,offset:c.anchorOffset}],aa(c)||u.push({node:c.focusNode,offset:c.focusOffset})),Ki.chrome&&8===e.lastKeyCode)for(var d=a;d>i;d--){var p=o.childNodes[d-1],f=p.pmViewDesc;if("BR"==p.nodeName&&!f){a=d;break}if(!f||f.size)break}var v=e.state.doc,m=e.someProp("domParser")||ko.fromSchema(e.state.schema),g=v.resolve(s),y=null,w=m.parse(o,{topNode:g.parent,topMatch:g.parent.contentMatchAt(g.index()),topOpen:!0,from:i,to:a,preserveWhitespace:!g.parent.type.spec.code||"full",editableContent:!0,findPositions:u,ruleFromNode:Ms,context:g});if(u&&null!=u[0].pos){var b=u[0].pos,k=u[1]&&u[1].pos;null==k&&(k=b),y={anchor:b+s,head:k+s}}return{doc:w,sel:y,from:s,to:l}}(e,t,r);if(Ki.chrome&&e.cursorWrapper&&h.sel&&h.sel.anchor==e.cursorWrapper.deco.from){var d=e.cursorWrapper.deco.type.toDOM.nextSibling,p=d&&d.nodeValue?d.nodeValue.length:1;h.sel={anchor:h.sel.anchor+p,head:h.sel.anchor+p}}var f,v,m=e.state.doc,g=m.slice(h.from,h.to);8===e.lastKeyCode&&Date.now()-100<e.lastKeyCodeTime?(f=e.state.selection.to,v="end"):(f=e.state.selection.from,v="start"),e.lastKeyCode=null;var y=function(e,t,r,n,o){var i=e.findDiffStart(t,r);if(null==i)return null;var a=e.findDiffEnd(t,r+e.size,r+t.size),s=a.a,l=a.b;if("end"==o){n-=s+Math.max(0,i-Math.min(s,l))-i}if(s<i&&e.size<t.size){l=(i-=n<=i&&n>=s?i-n:0)+(l-s),s=i}else if(l<i){s=(i-=n<=i&&n>=l?i-n:0)+(s-l),l=i}return{start:i,endA:s,endB:l}}(g.content,h.doc.content,h.from,f,v);if(!y){if(!(n&&u instanceof wi&&!u.empty&&u.$head.sameParent(u.$anchor))||e.composing||h.sel&&h.sel.anchor!=h.sel.head){if((Ki.ios&&e.lastIOSEnter>Date.now()-225||Ki.android)&&o.some((function(e){return"DIV"==e.nodeName||"P"==e.nodeName}))&&e.someProp("handleKeyDown",(function(t){return t(e,sa(13,"Enter"))})))return void(e.lastIOSEnter=0);if(h.sel){var w=Os(e,e.state.doc,h.sel);w&&!w.eq(e.state.selection)&&e.dispatch(e.state.tr.setSelection(w))}return}y={start:u.from,endA:u.to,endB:u.to}}e.domChangeCount++,e.state.selection.from<e.state.selection.to&&y.start==y.endB&&e.state.selection instanceof wi&&(y.start>e.state.selection.from&&y.start<=e.state.selection.from+2?y.start=e.state.selection.from:y.endA<e.state.selection.to&&y.endA>=e.state.selection.to-2&&(y.endB+=e.state.selection.to-y.endA,y.endA=e.state.selection.to)),Ki.ie&&Ki.ie_version<=11&&y.endB==y.start+1&&y.endA==y.start&&y.start>h.from&&"  "==h.doc.textBetween(y.start-h.from-1,y.start-h.from+1)&&(y.start--,y.endA--,y.endB--);var b,k=h.doc.resolveNoCache(y.start-h.from),x=h.doc.resolveNoCache(y.endB-h.from),S=k.sameParent(x)&&k.parent.inlineContent;if((Ki.ios&&e.lastIOSEnter>Date.now()-225&&(!S||o.some((function(e){return"DIV"==e.nodeName||"P"==e.nodeName})))||!S&&k.pos<h.doc.content.size&&(b=mi.findFrom(h.doc.resolve(k.pos+1),1,!0))&&b.head==x.pos)&&e.someProp("handleKeyDown",(function(t){return t(e,sa(13,"Enter"))})))e.lastIOSEnter=0;else if(e.state.selection.anchor>y.start&&function(e,t,r,n,o){if(!n.parent.isTextblock||r-t<=o.pos-n.pos||Es(n,!0,!1)<o.pos)return!1;var i=e.resolve(t);if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;var a=e.resolve(Es(i,!0,!0));if(!a.parent.isTextblock||a.pos>r||Es(a,!0,!1)<r)return!1;return n.parent.content.cut(n.parentOffset).eq(a.parent.content)}(m,y.start,y.endA,k,x)&&e.someProp("handleKeyDown",(function(t){return t(e,sa(8,"Backspace"))})))Ki.android&&Ki.chrome&&e.domObserver.suppressSelectionUpdates();else{Ki.chrome&&Ki.android&&y.toB==y.from&&(e.lastAndroidDelete=Date.now()),Ki.android&&!S&&k.start()!=x.start()&&0==x.parentOffset&&k.depth==x.depth&&h.sel&&h.sel.anchor==h.sel.head&&h.sel.head==y.endA&&(y.endB-=2,x=h.doc.resolveNoCache(y.endB-h.from),setTimeout((function(){e.someProp("handleKeyDown",(function(t){return t(e,sa(13,"Enter"))}))}),20));var M,C,O,E,A=y.start,N=y.endA;if(S)if(k.pos==x.pos)Ki.ie&&Ki.ie_version<=11&&0==k.parentOffset&&(e.domObserver.suppressSelectionUpdates(),setTimeout((function(){return ts(e)}),20)),M=e.state.tr.delete(A,N),C=m.resolve(y.start).marksAcross(m.resolve(y.endA));else if(y.endA==y.endB&&(E=m.resolve(y.start))&&(O=function(e,t){for(var r,n,o,i=e.firstChild.marks,a=t.firstChild.marks,s=i,l=a,c=0;c<a.length;c++)s=a[c].removeFromSet(s);for(var u=0;u<i.length;u++)l=i[u].removeFromSet(l);if(1==s.length&&0==l.length)n=s[0],r="add",o=function(e){return e.mark(n.addToSet(e.marks))};else{if(0!=s.length||1!=l.length)return null;n=l[0],r="remove",o=function(e){return e.mark(n.removeFromSet(e.marks))}}for(var h=[],d=0;d<t.childCount;d++)h.push(o(t.child(d)));if(kn.from(h).eq(e))return{mark:n,type:r}}(k.parent.content.cut(k.parentOffset,x.parentOffset),E.parent.content.cut(E.parentOffset,y.endA-E.start()))))M=e.state.tr,"add"==O.type?M.addMark(A,N,O.mark):M.removeMark(A,N,O.mark);else if(k.parent.child(k.index()).isText&&k.index()==x.index()-(x.textOffset?0:1)){var R=k.parent.textBetween(k.parentOffset,x.parentOffset);if(e.someProp("handleTextInput",(function(t){return t(e,A,N,R)})))return;M=e.state.tr.insertText(R,A,N)}if(M||(M=e.state.tr.replace(A,N,h.doc.slice(y.start-h.from,y.endB-h.from))),h.sel){var T=Os(e,M.doc,h.sel);T&&!(Ki.chrome&&Ki.android&&e.composing&&T.empty&&(y.start!=y.endB||e.lastAndroidDelete<Date.now()-100)&&(T.head==A||T.head==M.mapping.map(N)-1)||Ki.ie&&T.empty&&T.head==A)&&M.setSelection(T)}C&&M.ensureMarks(C),e.dispatch(M.scrollIntoView())}}}function Os(e,t,r){return Math.max(r.anchor,r.head)>t.content.size?null:cs(e,t.resolve(r.anchor),t.resolve(r.head))}function Es(e,t,r){for(var n=e.depth,o=t?e.end():e.pos;n>0&&(t||e.indexAfter(n)==e.node(n).childCount);)n--,o++,t=!1;if(r)for(var i=e.node(n).maybeChild(e.indexAfter(n));i&&!i.isLeaf;)i=i.firstChild,o++;return o}function As(e,t){for(var r=[],n=t.content,o=t.openStart,i=t.openEnd;o>1&&i>1&&1==n.childCount&&1==n.firstChild.childCount;){o--,i--;var a=n.firstChild;r.push(a.type.name,a.attrs!=a.type.defaultAttrs?a.attrs:null),n=a.content}var s=e.someProp("clipboardSerializer")||Do.fromSchema(e.state.schema),l=zs(),c=l.createElement("div");c.appendChild(s.serializeFragment(n,{document:l}));for(var u,h=c.firstChild;h&&1==h.nodeType&&(u=Is[h.nodeName.toLowerCase()]);){for(var d=u.length-1;d>=0;d--){for(var p=l.createElement(u[d]);c.firstChild;)p.appendChild(c.firstChild);c.appendChild(p)}h=c.firstChild}return h&&1==h.nodeType&&h.setAttribute("data-pm-slice",o+" "+i+" "+JSON.stringify(r)),{dom:c,text:e.someProp("clipboardTextSerializer",(function(e){return e(t)}))||t.content.textBetween(0,t.content.size,"\n\n")}}function Ns(e,t,r,n,o){var i,a,s=o.parent.type.spec.code;if(!r&&!t)return null;var l=t&&(n||s||!r);if(l){if(e.someProp("transformPastedText",(function(e){t=e(t,s||n)})),s)return new An(kn.from(e.state.schema.text(t.replace(/\r\n?/g,"\n"))),0,0);var c=e.someProp("clipboardTextParser",(function(e){return e(t,o,n)}));c?a=c:(i=document.createElement("div"),t.trim().split(/(?:\r\n?|\n)+/).forEach((function(e){i.appendChild(document.createElement("p")).textContent=e})))}else e.someProp("transformPastedHTML",(function(e){r=e(r)})),i=function(e){var t=/^(\s*<meta [^>]*>)*/.exec(e);t&&(e=e.slice(t[0].length));var r,n=zs().createElement("div"),o=/<([a-z][^>\s]+)/i.exec(e);(r=o&&Is[o[1].toLowerCase()])&&(e=r.map((function(e){return"<"+e+">"})).join("")+e+r.map((function(e){return"</"+e+">"})).reverse().join(""));if(n.innerHTML=e,r)for(var i=0;i<r.length;i++)n=n.querySelector(r[i])||n;return n}(r);var u=i&&i.querySelector("[data-pm-slice]"),h=u&&/^(\d+) (\d+) (.*)/.exec(u.getAttribute("data-pm-slice"));if(!a){var d=e.someProp("clipboardParser")||e.someProp("domParser")||ko.fromSchema(e.state.schema);a=d.parseSlice(i,{preserveWhitespace:!(!l&&!h),context:o})}return a=h?function(e,t){if(!e.size)return e;var r,n=e.content.firstChild.type.schema;try{r=JSON.parse(t)}catch(c){return e}for(var o=e.content,i=e.openStart,a=e.openEnd,s=r.length-2;s>=0;s-=2){var l=n.nodes[r[s]];if(!l||l.hasRequiredAttrs())break;o=kn.from(l.create(r[s+1],o)),i++,a++}return new An(o,i,a)}(function(e,t,r){t<e.openStart&&(e=new An(Ps(e.content,-1,t,e.openStart,0,e.openEnd),t,e.openEnd));r<e.openEnd&&(e=new An(Ps(e.content,1,r,e.openEnd,0,0),e.openStart,r));return e}(a,+h[1],+h[2]),h[3]):An.maxOpen(function(e,t){if(e.childCount<2)return e;for(var r=function(r){var n=t.node(r).contentMatchAt(t.index(r)),o=void 0,i=[];if(e.forEach((function(e){if(i){var t,r=n.findWrapping(e.type);if(!r)return i=null;if(t=i.length&&o.length&&Ts(r,o,e,i[i.length-1],0))i[i.length-1]=t;else{i.length&&(i[i.length-1]=Ds(i[i.length-1],o.length));var a=Rs(e,r);i.push(a),n=n.matchType(a.type,a.attrs),o=r}}})),i)return{v:kn.from(i)}},n=t.depth;n>=0;n--){var o=r(n);if(o)return o.v}return e}(a.content,o),!1),e.someProp("transformPasted",(function(e){a=e(a)})),a}function Rs(e,t,r){void 0===r&&(r=0);for(var n=t.length-1;n>=r;n--)e=t[n].create(null,kn.from(e));return e}function Ts(e,t,r,n,o){if(o<e.length&&o<t.length&&e[o]==t[o]){var i=Ts(e,t,r,n.lastChild,o+1);if(i)return n.copy(n.content.replaceChild(n.childCount-1,i));if(n.contentMatchAt(n.childCount).matchType(o==e.length-1?r.type:e[o+1]))return n.copy(n.content.append(kn.from(Rs(r,e,o+1))))}}function Ds(e,t){if(0==t)return e;var r=e.content.replaceChild(e.childCount-1,Ds(e.lastChild,t-1)),n=e.contentMatchAt(e.childCount).fillBefore(kn.empty,!0);return e.copy(r.append(n))}function Ps(e,t,r,n,o,i){var a=t<0?e.firstChild:e.lastChild,s=a.content;return o<n-1&&(s=Ps(s,t,r,n,o+1,i)),o>=r&&(s=t<0?a.contentMatchAt(0).fillBefore(s,e.childCount>1||i<=o).append(s):s.append(a.contentMatchAt(a.childCount).fillBefore(kn.empty,!0))),e.replaceChild(t<0?0:e.childCount-1,a.copy(s))}var Is={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]},Vs=null;function zs(){return Vs||(Vs=document.implementation.createHTMLDocument("title"))}var $s={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},Bs=Ki.ie&&Ki.ie_version<=11,Hs=function(){this.anchorNode=this.anchorOffset=this.focusNode=this.focusOffset=null};Hs.prototype.set=function(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset},Hs.prototype.eq=function(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset};var Ls=function(e,t){var r=this;this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=window.MutationObserver&&new window.MutationObserver((function(e){for(var t=0;t<e.length;t++)r.queue.push(e[t]);Ki.ie&&Ki.ie_version<=11&&e.some((function(e){return"childList"==e.type&&e.removedNodes.length||"characterData"==e.type&&e.oldValue.length>e.target.nodeValue.length}))?r.flushSoon():r.flush()})),this.currentSelection=new Hs,Bs&&(this.onCharData=function(e){r.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),r.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.suppressingSelectionUpdates=!1};Ls.prototype.flushSoon=function(){var e=this;this.flushingSoon<0&&(this.flushingSoon=window.setTimeout((function(){e.flushingSoon=-1,e.flush()}),20))},Ls.prototype.forceFlush=function(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())},Ls.prototype.start=function(){this.observer&&this.observer.observe(this.view.dom,$s),Bs&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()},Ls.prototype.stop=function(){var e=this;if(this.observer){var t=this.observer.takeRecords();if(t.length){for(var r=0;r<t.length;r++)this.queue.push(t[r]);window.setTimeout((function(){return e.flush()}),20)}this.observer.disconnect()}Bs&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()},Ls.prototype.connectSelection=function(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)},Ls.prototype.disconnectSelection=function(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)},Ls.prototype.suppressSelectionUpdates=function(){var e=this;this.suppressingSelectionUpdates=!0,setTimeout((function(){return e.suppressingSelectionUpdates=!1}),50)},Ls.prototype.onSelectionChange=function(){if((!(e=this.view).editable||e.root.activeElement==e.dom)&&us(e)){var e;if(this.suppressingSelectionUpdates)return ts(this.view);if(Ki.ie&&Ki.ie_version<=11&&!this.view.state.selection.empty){var t=this.view.root.getSelection();if(t.focusNode&&ta(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}},Ls.prototype.setCurSelection=function(){this.currentSelection.set(this.view.root.getSelection())},Ls.prototype.ignoreSelectionChange=function(e){if(0==e.rangeCount)return!0;var t=e.getRangeAt(0).commonAncestorContainer,r=this.view.docView.nearestDesc(t);return r&&r.ignoreMutation({type:"selection",target:3==t.nodeType?t.parentNode:t})?(this.setCurSelection(),!0):void 0},Ls.prototype.flush=function(){if(this.view.docView&&!(this.flushingSoon>-1)){var e=this.observer?this.observer.takeRecords():[];this.queue.length&&(e=this.queue.concat(e),this.queue.length=0);var t=this.view.root.getSelection(),r=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(t)&&us(this.view)&&!this.ignoreSelectionChange(t),n=-1,o=-1,i=!1,a=[];if(this.view.editable)for(var s=0;s<e.length;s++){var l=this.registerMutation(e[s],a);l&&(n=n<0?l.from:Math.min(l.from,n),o=o<0?l.to:Math.max(l.to,o),l.typeOver&&(i=!0))}if(Ki.gecko&&a.length>1){var c=a.filter((function(e){return"BR"==e.nodeName}));if(2==c.length){var u=c[0],h=c[1];u.parentNode&&u.parentNode.parentNode==h.parentNode?h.remove():u.remove()}}(n>-1||r)&&(n>-1&&(this.view.docView.markDirty(n,o),function(e){if(_s)return;_s=!0,"normal"==getComputedStyle(e.dom).whiteSpace&&console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package.")}(this.view)),this.handleDOMChange(n,o,i,a),this.view.docView.dirty?this.view.updateState(this.view.state):this.currentSelection.eq(t)||ts(this.view),this.currentSelection.set(t))}},Ls.prototype.registerMutation=function(e,t){if(t.indexOf(e.target)>-1)return null;var r=this.view.docView.nearestDesc(e.target);if("attributes"==e.type&&(r==this.view.docView||"contenteditable"==e.attributeName||"style"==e.attributeName&&!e.oldValue&&!e.target.getAttribute("style")))return null;if(!r||r.ignoreMutation(e))return null;if("childList"==e.type){for(var n=0;n<e.addedNodes.length;n++)t.push(e.addedNodes[n]);if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};var o=e.previousSibling,i=e.nextSibling;if(Ki.ie&&Ki.ie_version<=11&&e.addedNodes.length)for(var a=0;a<e.addedNodes.length;a++){var s=e.addedNodes[a],l=s.previousSibling,c=s.nextSibling;(!l||Array.prototype.indexOf.call(e.addedNodes,l)<0)&&(o=l),(!c||Array.prototype.indexOf.call(e.addedNodes,c)<0)&&(i=c)}var u=o&&o.parentNode==e.target?Xi(o)+1:0,h=r.localPosFromDOM(e.target,u,-1),d=i&&i.parentNode==e.target?Xi(i):e.target.childNodes.length;return{from:h,to:r.localPosFromDOM(e.target,d,1)}}return"attributes"==e.type?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}};var _s=!1;var Fs={},js={};function Ws(e,t){e.lastSelectionOrigin=t,e.lastSelectionTime=Date.now()}function Ks(e){e.someProp("handleDOMEvents",(function(t){for(var r in t)e.eventHandlers[r]||e.dom.addEventListener(r,e.eventHandlers[r]=function(t){return Us(e,t)})}))}function Us(e,t){return e.someProp("handleDOMEvents",(function(r){var n=r[t.type];return!!n&&(n(e,t)||t.defaultPrevented)}))}function qs(e){return{left:e.clientX,top:e.clientY}}function Js(e,t,r,n,o){if(-1==n)return!1;for(var i=e.state.doc.resolve(n),a=function(n){if(e.someProp(t,(function(t){return n>i.depth?t(e,r,i.nodeAfter,i.before(n),o,!0):t(e,r,i.node(n),i.before(n),o,!1)})))return{v:!0}},s=i.depth+1;s>0;s--){var l=a(s);if(l)return l.v}return!1}function Zs(e,t,r){e.focused||e.focus();var n=e.state.tr.setSelection(t);"pointer"==r&&n.setMeta("pointer",!0),e.dispatch(n)}function Gs(e,t,r,n,o){return Js(e,"handleClickOn",t,r,n)||e.someProp("handleClick",(function(r){return r(e,t,n)}))||(o?function(e,t){if(-1==t)return!1;var r,n,o=e.state.selection;o instanceof ki&&(r=o.node);for(var i=e.state.doc.resolve(t),a=i.depth+1;a>0;a--){var s=a>i.depth?i.nodeAfter:i.node(a);if(ki.isSelectable(s)){n=r&&o.$from.depth>0&&a>=o.$from.depth&&i.before(o.$from.depth+1)==o.$from.pos?i.before(o.$from.depth):i.before(a);break}}return null!=n&&(Zs(e,ki.create(e.state.doc,n),"pointer"),!0)}(e,r):function(e,t){if(-1==t)return!1;var r=e.state.doc.resolve(t),n=r.nodeAfter;return!!(n&&n.isAtom&&ki.isSelectable(n))&&(Zs(e,new ki(r),"pointer"),!0)}(e,r))}function Xs(e,t,r,n){return Js(e,"handleDoubleClickOn",t,r,n)||e.someProp("handleDoubleClick",(function(r){return r(e,t,n)}))}function Ys(e,t,r,n){return Js(e,"handleTripleClickOn",t,r,n)||e.someProp("handleTripleClick",(function(r){return r(e,t,n)}))||function(e,t){var r=e.state.doc;if(-1==t)return!!r.inlineContent&&(Zs(e,wi.create(r,0,r.content.size),"pointer"),!0);for(var n=r.resolve(t),o=n.depth+1;o>0;o--){var i=o>n.depth?n.nodeAfter:n.node(o),a=n.before(o);if(i.inlineContent)Zs(e,wi.create(r,a+1,a+1+i.content.size),"pointer");else{if(!ki.isSelectable(i))continue;Zs(e,ki.create(r,a),"pointer")}return!0}}(e,r)}function Qs(e){return al(e)}js.keydown=function(e,t){if(e.shiftKey=16==t.keyCode||t.shiftKey,!rl(e,t))if(e.domObserver.forceFlush(),e.lastKeyCode=t.keyCode,e.lastKeyCodeTime=Date.now(),!Ki.ios||13!=t.keyCode||t.ctrlKey||t.altKey||t.metaKey)e.someProp("handleKeyDown",(function(r){return r(e,t)}))||Ss(e,t)?t.preventDefault():Ws(e,"key");else{var r=Date.now();e.lastIOSEnter=r,e.lastIOSEnterFallbackTimeout=setTimeout((function(){e.lastIOSEnter==r&&(e.someProp("handleKeyDown",(function(t){return t(e,sa(13,"Enter"))})),e.lastIOSEnter=0)}),200)}},js.keyup=function(e,t){16==t.keyCode&&(e.shiftKey=!1)},js.keypress=function(e,t){if(!(rl(e,t)||!t.charCode||t.ctrlKey&&!t.altKey||Ki.mac&&t.metaKey))if(e.someProp("handleKeyPress",(function(r){return r(e,t)})))t.preventDefault();else{var r=e.state.selection;if(!(r instanceof wi&&r.$from.sameParent(r.$to))){var n=String.fromCharCode(t.charCode);e.someProp("handleTextInput",(function(t){return t(e,r.$from.pos,r.$to.pos,n)}))||e.dispatch(e.state.tr.insertText(n).scrollIntoView()),t.preventDefault()}}};var el=Ki.mac?"metaKey":"ctrlKey";Fs.mousedown=function(e,t){e.shiftKey=t.shiftKey;var r=Qs(e),n=Date.now(),o="singleClick";n-e.lastClick.time<500&&function(e,t){var r=t.x-e.clientX,n=t.y-e.clientY;return r*r+n*n<100}(t,e.lastClick)&&!t[el]&&("singleClick"==e.lastClick.type?o="doubleClick":"doubleClick"==e.lastClick.type&&(o="tripleClick")),e.lastClick={time:n,x:t.clientX,y:t.clientY,type:o};var i=e.posAtCoords(qs(t));i&&("singleClick"==o?(e.mouseDown&&e.mouseDown.done(),e.mouseDown=new tl(e,i,t,r)):("doubleClick"==o?Xs:Ys)(e,i.pos,i.inside,t)?t.preventDefault():Ws(e,"pointer"))};var tl=function(e,t,r,n){var o,i,a=this;if(this.view=e,this.startDoc=e.state.doc,this.pos=t,this.event=r,this.flushed=n,this.selectNode=r[el],this.allowDefault=r.shiftKey,t.inside>-1)o=e.state.doc.nodeAt(t.inside),i=t.inside;else{var s=e.state.doc.resolve(t.pos);o=s.parent,i=s.depth?s.before():0}this.mightDrag=null;var l=n?null:r.target,c=l?e.docView.nearestDesc(l,!0):null;this.target=c?c.dom:null;var u=e.state.selection;(o.type.spec.draggable&&!1!==o.type.spec.selectable||u instanceof ki&&u.from<=i&&u.to>i)&&(this.mightDrag={node:o,pos:i,addAttr:this.target&&!this.target.draggable,setUneditable:this.target&&Ki.gecko&&!this.target.hasAttribute("contentEditable")}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout((function(){a.view.mouseDown==a&&a.target.setAttribute("contentEditable","false")}),20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),Ws(e,"pointer")};function rl(e,t){return!!e.composing||!!(Ki.safari&&Math.abs(t.timeStamp-e.compositionEndedAt)<500)&&(e.compositionEndedAt=-2e8,!0)}tl.prototype.done=function(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.view.mouseDown=null},tl.prototype.up=function(e){if(this.done(),this.view.dom.contains(3==e.target.nodeType?e.target.parentNode:e.target)){var t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(qs(e))),this.allowDefault||!t?Ws(this.view,"pointer"):Gs(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():this.flushed||Ki.safari&&this.mightDrag&&!this.mightDrag.node.isAtom||Ki.chrome&&!(this.view.state.selection instanceof wi)&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2?(Zs(this.view,mi.near(this.view.state.doc.resolve(t.pos)),"pointer"),e.preventDefault()):Ws(this.view,"pointer")}},tl.prototype.move=function(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0),Ws(this.view,"pointer"),0==e.buttons&&this.done()},Fs.touchdown=function(e){Qs(e),Ws(e,"pointer")},Fs.contextmenu=function(e){return Qs(e)};var nl=Ki.android?5e3:-1;function ol(e,t){clearTimeout(e.composingTimeout),t>-1&&(e.composingTimeout=setTimeout((function(){return al(e)}),t))}function il(e){for(e.composing=!1;e.compositionNodes.length>0;)e.compositionNodes.pop().markParentsDirty()}function al(e,t){if(e.domObserver.forceFlush(),il(e),t||e.docView.dirty){var r=Qa(e);return r&&!r.eq(e.state.selection)?e.dispatch(e.state.tr.setSelection(r)):e.updateState(e.state),!0}return!1}js.compositionstart=js.compositionupdate=function(e){if(!e.composing){e.domObserver.flush();var t=e.state,r=t.selection.$from;if(t.selection.empty&&(t.storedMarks||!r.textOffset&&r.parentOffset&&r.nodeBefore.marks.some((function(e){return!1===e.type.spec.inclusive}))))e.markCursor=e.state.storedMarks||r.marks(),al(e,!0),e.markCursor=null;else if(al(e),Ki.gecko&&t.selection.empty&&r.parentOffset&&!r.textOffset&&r.nodeBefore.marks.length)for(var n=e.root.getSelection(),o=n.focusNode,i=n.focusOffset;o&&1==o.nodeType&&0!=i;){var a=i<0?o.lastChild:o.childNodes[i-1];if(!a)break;if(3==a.nodeType){n.collapse(a,a.nodeValue.length);break}o=a,i=-1}e.composing=!0}ol(e,nl)},js.compositionend=function(e,t){e.composing&&(e.composing=!1,e.compositionEndedAt=t.timeStamp,ol(e,20))};var sl=Ki.ie&&Ki.ie_version<15||Ki.ios&&Ki.webkit_version<604;function ll(e,t,r,n){var o=Ns(e,t,r,e.shiftKey,e.state.selection.$from);if(e.someProp("handlePaste",(function(t){return t(e,n,o||An.empty)})))return!0;if(!o)return!1;var i=function(e){return 0==e.openStart&&0==e.openEnd&&1==e.content.childCount?e.content.firstChild:null}(o),a=i?e.state.tr.replaceSelectionWith(i,e.shiftKey):e.state.tr.replaceSelection(o);return e.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}Fs.copy=js.cut=function(e,t){var r=e.state.selection,n="cut"==t.type;if(!r.empty){var o=sl?null:t.clipboardData,i=As(e,r.content()),a=i.dom,s=i.text;o?(t.preventDefault(),o.clearData(),o.setData("text/html",a.innerHTML),o.setData("text/plain",s)):function(e,t){if(e.dom.parentNode){var r=e.dom.parentNode.appendChild(document.createElement("div"));r.appendChild(t),r.style.cssText="position: fixed; left: -10000px; top: 10px";var n=getSelection(),o=document.createRange();o.selectNodeContents(t),e.dom.blur(),n.removeAllRanges(),n.addRange(o),setTimeout((function(){r.parentNode&&r.parentNode.removeChild(r),e.focus()}),50)}}(e,a),n&&e.dispatch(e.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))}},js.paste=function(e,t){var r=sl?null:t.clipboardData;r&&ll(e,r.getData("text/plain"),r.getData("text/html"),t)?t.preventDefault():function(e,t){if(e.dom.parentNode){var r=e.shiftKey||e.state.selection.$from.parent.type.spec.code,n=e.dom.parentNode.appendChild(document.createElement(r?"textarea":"div"));r||(n.contentEditable="true"),n.style.cssText="position: fixed; left: -10000px; top: 10px",n.focus(),setTimeout((function(){e.focus(),n.parentNode&&n.parentNode.removeChild(n),r?ll(e,n.value,null,t):ll(e,n.textContent,n.innerHTML,t)}),50)}}(e,t)};var cl=function(e,t){this.slice=e,this.move=t},ul=Ki.mac?"altKey":"ctrlKey";for(var hl in Fs.dragstart=function(e,t){var r=e.mouseDown;if(r&&r.done(),t.dataTransfer){var n=e.state.selection,o=n.empty?null:e.posAtCoords(qs(t));if(o&&o.pos>=n.from&&o.pos<=(n instanceof ki?n.to-1:n.to));else if(r&&r.mightDrag)e.dispatch(e.state.tr.setSelection(ki.create(e.state.doc,r.mightDrag.pos)));else if(t.target&&1==t.target.nodeType){var i=e.docView.nearestDesc(t.target,!0);if(!i||!i.node.type.spec.draggable||i==e.docView)return;e.dispatch(e.state.tr.setSelection(ki.create(e.state.doc,i.posBefore)))}var a=e.state.selection.content(),s=As(e,a),l=s.dom,c=s.text;t.dataTransfer.clearData(),t.dataTransfer.setData(sl?"Text":"text/html",l.innerHTML),t.dataTransfer.effectAllowed="copyMove",sl||t.dataTransfer.setData("text/plain",c),e.dragging=new cl(a,!t[ul])}},Fs.dragend=function(e){var t=e.dragging;window.setTimeout((function(){e.dragging==t&&(e.dragging=null)}),50)},js.dragover=js.dragenter=function(e,t){return t.preventDefault()},js.drop=function(e,t){var r=e.dragging;if(e.dragging=null,t.dataTransfer){var n=e.posAtCoords(qs(t));if(n){var o=e.state.doc.resolve(n.pos);if(o){var i=r&&r.slice;i?e.someProp("transformPasted",(function(e){i=e(i)})):i=Ns(e,t.dataTransfer.getData(sl?"Text":"text/plain"),sl?null:t.dataTransfer.getData("text/html"),!1,o);var a=r&&!t[ul];if(e.someProp("handleDrop",(function(r){return r(e,t,i||An.empty,a)})))t.preventDefault();else if(i){t.preventDefault();var s=i?function(e,t,r){var n=e.resolve(t);if(!r.content.size)return t;for(var o=r.content,i=0;i<r.openStart;i++)o=o.firstChild.content;for(var a=1;a<=(0==r.openStart&&r.size?2:1);a++)for(var s=n.depth;s>=0;s--){var l=s==n.depth?0:n.pos<=(n.start(s+1)+n.end(s+1))/2?-1:1,c=n.index(s)+(l>0?1:0),u=n.node(s),h=!1;if(1==a)h=u.canReplace(c,c,o);else{var d=u.contentMatchAt(c).findWrapping(o.firstChild.type);h=d&&u.canReplaceWith(c,c,d[0])}if(h)return 0==l?n.pos:l<0?n.before(s+1):n.after(s+1)}return null}(e.state.doc,o.pos,i):o.pos;null==s&&(s=o.pos);var l=e.state.tr;a&&l.deleteSelection();var c=l.mapping.map(s),u=0==i.openStart&&0==i.openEnd&&1==i.content.childCount,h=l.doc;if(u?l.replaceRangeWith(c,c,i.content.firstChild):l.replaceRange(c,c,i),!l.doc.eq(h)){var d=l.doc.resolve(c);if(u&&ki.isSelectable(i.content.firstChild)&&d.nodeAfter&&d.nodeAfter.sameMarkup(i.content.firstChild))l.setSelection(new ki(d));else{var p=l.mapping.map(s);l.mapping.maps[l.mapping.maps.length-1].forEach((function(e,t,r,n){return p=n})),l.setSelection(cs(e,d,l.doc.resolve(p)))}e.focus(),e.dispatch(l.setMeta("uiEvent","drop"))}}}}}},Fs.focus=function(e){e.focused||(e.domObserver.stop(),e.dom.classList.add("ProseMirror-focused"),e.domObserver.start(),e.focused=!0,setTimeout((function(){e.docView&&e.hasFocus()&&!e.domObserver.currentSelection.eq(e.root.getSelection())&&ts(e)}),20))},Fs.blur=function(e){e.focused&&(e.domObserver.stop(),e.dom.classList.remove("ProseMirror-focused"),e.domObserver.start(),e.domObserver.currentSelection.set({}),e.focused=!1)},Fs.beforeinput=function(e,t){if(Ki.chrome&&Ki.android&&"deleteContentBackward"==t.inputType){var r=e.domChangeCount;setTimeout((function(){if(e.domChangeCount==r&&(e.dom.blur(),e.focus(),!e.someProp("handleKeyDown",(function(t){return t(e,sa(8,"Backspace"))})))){var t=e.state.selection.$cursor;t&&t.pos>0&&e.dispatch(e.state.tr.delete(t.pos-1,t.pos).scrollIntoView())}}),50)}},js)Fs[hl]=js[hl];function dl(e,t){if(e==t)return!0;for(var r in e)if(e[r]!==t[r])return!1;for(var n in t)if(!(n in e))return!1;return!0}var pl=function(e,t){this.spec=t||wl,this.side=this.spec.side||0,this.toDOM=e};pl.prototype.map=function(e,t,r,n){var o=e.mapResult(t.from+n,this.side<0?-1:1),i=o.pos;return o.deleted?null:new ml(i-r,i-r,this)},pl.prototype.valid=function(){return!0},pl.prototype.eq=function(e){return this==e||e instanceof pl&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&dl(this.spec,e.spec))};var fl=function(e,t){this.spec=t||wl,this.attrs=e};fl.prototype.map=function(e,t,r,n){var o=e.map(t.from+n,this.spec.inclusiveStart?-1:1)-r,i=e.map(t.to+n,this.spec.inclusiveEnd?1:-1)-r;return o>=i?null:new ml(o,i,this)},fl.prototype.valid=function(e,t){return t.from<t.to},fl.prototype.eq=function(e){return this==e||e instanceof fl&&dl(this.attrs,e.attrs)&&dl(this.spec,e.spec)},fl.is=function(e){return e.type instanceof fl};var vl=function(e,t){this.spec=t||wl,this.attrs=e};vl.prototype.map=function(e,t,r,n){var o=e.mapResult(t.from+n,1);if(o.deleted)return null;var i=e.mapResult(t.to+n,-1);return i.deleted||i.pos<=o.pos?null:new ml(o.pos-r,i.pos-r,this)},vl.prototype.valid=function(e,t){var r=e.content.findIndex(t.from),n=r.index,o=r.offset;return o==t.from&&o+e.child(n).nodeSize==t.to},vl.prototype.eq=function(e){return this==e||e instanceof vl&&dl(this.attrs,e.attrs)&&dl(this.spec,e.spec)};var ml=function(e,t,r){this.from=e,this.to=t,this.type=r},gl={spec:{configurable:!0},inline:{configurable:!0}};ml.prototype.copy=function(e,t){return new ml(e,t,this.type)},ml.prototype.eq=function(e,t){return void 0===t&&(t=0),this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to},ml.prototype.map=function(e,t,r){return this.type.map(e,this,t,r)},ml.widget=function(e,t,r){return new ml(e,e,new pl(t,r))},ml.inline=function(e,t,r,n){return new ml(e,t,new fl(r,n))},ml.node=function(e,t,r,n){return new ml(e,t,new vl(r,n))},gl.spec.get=function(){return this.type.spec},gl.inline.get=function(){return this.type instanceof fl},Object.defineProperties(ml.prototype,gl);var yl=[],wl={},bl=function(e,t){this.local=e&&e.length?e:yl,this.children=t&&t.length?t:yl};bl.create=function(e,t){return t.length?Ol(t,e,0,wl):kl},bl.prototype.find=function(e,t,r){var n=[];return this.findInner(null==e?0:e,null==t?1e9:t,n,0,r),n},bl.prototype.findInner=function(e,t,r,n,o){for(var i=0;i<this.local.length;i++){var a=this.local[i];a.from<=t&&a.to>=e&&(!o||o(a.spec))&&r.push(a.copy(a.from+n,a.to+n))}for(var s=0;s<this.children.length;s+=3)if(this.children[s]<t&&this.children[s+1]>e){var l=this.children[s]+1;this.children[s+2].findInner(e-l,t-l,r,n+l,o)}},bl.prototype.map=function(e,t,r){return this==kl||0==e.maps.length?this:this.mapInner(e,t,0,0,r||wl)},bl.prototype.mapInner=function(e,t,r,n,o){for(var i,a=0;a<this.local.length;a++){var s=this.local[a].map(e,r,n);s&&s.type.valid(t,s)?(i||(i=[])).push(s):o.onRemove&&o.onRemove(this.local[a].spec)}return this.children.length?function(e,t,r,n,o,i,a){for(var s=e.slice(),l=function(e,t,r,n){for(var a=0;a<s.length;a+=3){var l=s[a+1],c=void 0;-1==l||e>l+i||(t>=s[a]+i?s[a+1]=-1:r>=o&&(c=n-r-(t-e))&&(s[a]+=c,s[a+1]+=c))}},c=0;c<r.maps.length;c++)r.maps[c].forEach(l);for(var u=!1,h=0;h<s.length;h+=3)if(-1==s[h+1]){var d=r.map(e[h]+i),p=d-o;if(p<0||p>=n.content.size){u=!0;continue}var f=r.map(e[h+1]+i,-1)-o,v=n.content.findIndex(p),m=v.index,g=v.offset,y=n.maybeChild(m);if(y&&g==p&&g+y.nodeSize==f){var w=s[h+2].mapInner(r,y,d+1,e[h]+i+1,a);w!=kl?(s[h]=p,s[h+1]=f,s[h+2]=w):(s[h+1]=-2,u=!0)}else u=!0}if(u){var b=Ol(function(e,t,r,n,o,i,a){function s(e,t){for(var i=0;i<e.local.length;i++){var l=e.local[i].map(n,o,t);l?r.push(l):a.onRemove&&a.onRemove(e.local[i].spec)}for(var c=0;c<e.children.length;c+=3)s(e.children[c+2],e.children[c]+t+1)}for(var l=0;l<e.length;l+=3)-1==e[l+1]&&s(e[l+2],t[l]+i+1);return r}(s,e,t||[],r,o,i,a),n,0,a);t=b.local;for(var k=0;k<s.length;k+=3)s[k+1]<0&&(s.splice(k,3),k-=3);for(var x=0,S=0;x<b.children.length;x+=3){for(var M=b.children[x];S<s.length&&s[S]<M;)S+=3;s.splice(S,0,b.children[x],b.children[x+1],b.children[x+2])}}return new bl(t&&t.sort(El),s)}(this.children,i,e,t,r,n,o):i?new bl(i.sort(El)):kl},bl.prototype.add=function(e,t){return t.length?this==kl?bl.create(e,t):this.addInner(e,t,0):this},bl.prototype.addInner=function(e,t,r){var n,o=this,i=0;e.forEach((function(e,a){var s,l=a+r;if(s=Ml(t,e,l)){for(n||(n=o.children.slice());i<n.length&&n[i]<a;)i+=3;n[i]==a?n[i+2]=n[i+2].addInner(e,s,l+1):n.splice(i,0,a,a+e.nodeSize,Ol(s,e,l+1,wl)),i+=3}}));for(var a=Sl(i?Cl(t):t,-r),s=0;s<a.length;s++)a[s].type.valid(e,a[s])||a.splice(s--,1);return new bl(a.length?this.local.concat(a).sort(El):this.local,n||this.children)},bl.prototype.remove=function(e){return 0==e.length||this==kl?this:this.removeInner(e,0)},bl.prototype.removeInner=function(e,t){for(var r=this.children,n=this.local,o=0;o<r.length;o+=3){for(var i=void 0,a=r[o]+t,s=r[o+1]+t,l=0,c=void 0;l<e.length;l++)(c=e[l])&&c.from>a&&c.to<s&&(e[l]=null,(i||(i=[])).push(c));if(i){r==this.children&&(r=this.children.slice());var u=r[o+2].removeInner(i,a+1);u!=kl?r[o+2]=u:(r.splice(o,3),o-=3)}}if(n.length)for(var h=0,d=void 0;h<e.length;h++)if(d=e[h])for(var p=0;p<n.length;p++)n[p].eq(d,t)&&(n==this.local&&(n=this.local.slice()),n.splice(p--,1));return r==this.children&&n==this.local?this:n.length||r.length?new bl(n,r):kl},bl.prototype.forChild=function(e,t){if(this==kl)return this;if(t.isLeaf)return bl.empty;for(var r,n,o=0;o<this.children.length;o+=3)if(this.children[o]>=e){this.children[o]==e&&(r=this.children[o+2]);break}for(var i=e+1,a=i+t.content.size,s=0;s<this.local.length;s++){var l=this.local[s];if(l.from<a&&l.to>i&&l.type instanceof fl){var c=Math.max(i,l.from)-i,u=Math.min(a,l.to)-i;c<u&&(n||(n=[])).push(l.copy(c,u))}}if(n){var h=new bl(n.sort(El));return r?new xl([h,r]):h}return r||kl},bl.prototype.eq=function(e){if(this==e)return!0;if(!(e instanceof bl)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(var t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(var r=0;r<this.children.length;r+=3)if(this.children[r]!=e.children[r]||this.children[r+1]!=e.children[r+1]||!this.children[r+2].eq(e.children[r+2]))return!1;return!0},bl.prototype.locals=function(e){return Al(this.localsInner(e))},bl.prototype.localsInner=function(e){if(this==kl)return yl;if(e.inlineContent||!this.local.some(fl.is))return this.local;for(var t=[],r=0;r<this.local.length;r++)this.local[r].type instanceof fl||t.push(this.local[r]);return t};var kl=new bl;bl.empty=kl,bl.removeOverlap=Al;var xl=function(e){this.members=e};function Sl(e,t){if(!t||!e.length)return e;for(var r=[],n=0;n<e.length;n++){var o=e[n];r.push(new ml(o.from+t,o.to+t,o.type))}return r}function Ml(e,t,r){if(t.isLeaf)return null;for(var n=r+t.nodeSize,o=null,i=0,a=void 0;i<e.length;i++)(a=e[i])&&a.from>r&&a.to<n&&((o||(o=[])).push(a),e[i]=null);return o}function Cl(e){for(var t=[],r=0;r<e.length;r++)null!=e[r]&&t.push(e[r]);return t}function Ol(e,t,r,n){var o=[],i=!1;t.forEach((function(t,a){var s=Ml(e,t,a+r);if(s){i=!0;var l=Ol(s,t,r+a+1,n);l!=kl&&o.push(a,a+t.nodeSize,l)}}));for(var a=Sl(i?Cl(e):e,-r).sort(El),s=0;s<a.length;s++)a[s].type.valid(t,a[s])||(n.onRemove&&n.onRemove(a[s].spec),a.splice(s--,1));return a.length||o.length?new bl(a,o):kl}function El(e,t){return e.from-t.from||e.to-t.to}function Al(e){for(var t=e,r=0;r<t.length-1;r++){var n=t[r];if(n.from!=n.to)for(var o=r+1;o<t.length;o++){var i=t[o];if(i.from!=n.from){i.from<n.to&&(t==e&&(t=e.slice()),t[r]=n.copy(n.from,i.from),Nl(t,o,n.copy(i.from,n.to)));break}i.to!=n.to&&(t==e&&(t=e.slice()),t[o]=i.copy(i.from,n.to),Nl(t,o+1,i.copy(n.to,i.to)))}}return t}function Nl(e,t,r){for(;t<e.length&&El(r,e[t])>0;)t++;e.splice(t,0,r)}function Rl(e){var t=[];return e.someProp("decorations",(function(r){var n=r(e.state);n&&n!=kl&&t.push(n)})),e.cursorWrapper&&t.push(bl.create(e.state.doc,[e.cursorWrapper.deco])),xl.from(t)}xl.prototype.forChild=function(e,t){if(t.isLeaf)return bl.empty;for(var r=[],n=0;n<this.members.length;n++){var o=this.members[n].forChild(e,t);o!=kl&&(o instanceof xl?r=r.concat(o.members):r.push(o))}return xl.from(r)},xl.prototype.eq=function(e){if(!(e instanceof xl)||e.members.length!=this.members.length)return!1;for(var t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0},xl.prototype.locals=function(e){for(var t,r=!0,n=0;n<this.members.length;n++){var o=this.members[n].localsInner(e);if(o.length)if(t){r&&(t=t.slice(),r=!1);for(var i=0;i<o.length;i++)t.push(o[i])}else t=o}return t?Al(r?t:t.sort(El)):yl},xl.from=function(e){switch(e.length){case 0:return kl;case 1:return e[0];default:return new xl(e)}};var Tl=function(e,t){this._props=t,this.state=t.state,this.dispatch=this.dispatch.bind(this),this._root=null,this.focused=!1,this.trackWrites=null,this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):e.apply?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=Vl(this),this.markCursor=null,this.cursorWrapper=null,Il(this),this.nodeViews=zl(this),this.docView=$a(this.state.doc,Pl(this),Rl(this),this.dom,this),this.lastSelectedViewDesc=null,this.dragging=null,function(e){e.shiftKey=!1,e.mouseDown=null,e.lastKeyCode=null,e.lastKeyCodeTime=0,e.lastClick={time:0,x:0,y:0,type:""},e.lastSelectionOrigin=null,e.lastSelectionTime=0,e.lastIOSEnter=0,e.lastIOSEnterFallbackTimeout=null,e.lastAndroidDelete=0,e.composing=!1,e.composingTimeout=null,e.compositionNodes=[],e.compositionEndedAt=-2e8,e.domObserver=new Ls(e,(function(t,r,n,o){return Cs(e,t,r,n,o)})),e.domObserver.start(),e.domChangeCount=0,e.eventHandlers=Object.create(null);var t=function(t){var r=Fs[t];e.dom.addEventListener(t,e.eventHandlers[t]=function(t){!function(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(var r=t.target;r!=e.dom;r=r.parentNode)if(!r||11==r.nodeType||r.pmViewDesc&&r.pmViewDesc.stopEvent(t))return!1;return!0}(e,t)||Us(e,t)||!e.editable&&t.type in js||r(e,t)})};for(var r in Fs)t(r);Ki.safari&&e.dom.addEventListener("input",(function(){return null})),Ks(e)}(this),this.pluginViews=[],this.updatePluginViews()},Dl={props:{configurable:!0},root:{configurable:!0}};function Pl(e){var t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(e.editable),e.someProp("attributes",(function(r){if("function"==typeof r&&(r=r(e.state)),r)for(var n in r)"class"==n?t.class+=" "+r[n]:t[n]||"contenteditable"==n||"nodeName"==n||(t[n]=String(r[n]))})),[ml.node(0,e.state.doc.content.size,t)]}function Il(e){if(e.markCursor){var t=document.createElement("img");t.setAttribute("mark-placeholder","true"),e.cursorWrapper={dom:t,deco:ml.widget(e.state.selection.head,t,{raw:!0,marks:e.markCursor})}}else e.cursorWrapper=null}function Vl(e){return!e.someProp("editable",(function(t){return!1===t(e.state)}))}function zl(e){var t={};return e.someProp("nodeViews",(function(e){for(var r in e)Object.prototype.hasOwnProperty.call(t,r)||(t[r]=e[r])})),t}Dl.props.get=function(){if(this._props.state!=this.state){var e=this._props;for(var t in this._props={},e)this._props[t]=e[t];this._props.state=this.state}return this._props},Tl.prototype.update=function(e){e.handleDOMEvents!=this._props.handleDOMEvents&&Ks(this),this._props=e,this.updateStateInner(e.state,!0)},Tl.prototype.setProps=function(e){var t={};for(var r in this._props)t[r]=this._props[r];for(var n in t.state=this.state,e)t[n]=e[n];this.update(t)},Tl.prototype.updateState=function(e){this.updateStateInner(e,this.state.plugins!=e.plugins)},Tl.prototype.updateStateInner=function(e,t){var r=this,n=this.state,o=!1,i=!1;if(e.storedMarks&&this.composing&&(il(this),i=!0),this.state=e,t){var a=zl(this);(function(e,t){var r=0,n=0;for(var o in e){if(e[o]!=t[o])return!0;r++}for(var i in t)n++;return r!=n})(a,this.nodeViews)&&(this.nodeViews=a,o=!0),Ks(this)}this.editable=Vl(this),Il(this);var s=Rl(this),l=Pl(this),c=t?"reset":e.scrollToSelection>n.scrollToSelection?"to selection":"preserve",u=o||!this.docView.matchesNode(e.doc,l,s);!u&&e.selection.eq(n.selection)||(i=!0);var h,d,p,f,v,m,g,y,w,b,k,x="preserve"==c&&i&&null==this.dom.style.overflowAnchor&&function(e){for(var t,r,n=e.dom.getBoundingClientRect(),o=Math.max(0,n.top),i=(n.left+n.right)/2,a=o+1;a<Math.min(innerHeight,n.bottom);a+=5){var s=e.root.elementFromPoint(i,a);if(s!=e.dom&&e.dom.contains(s)){var l=s.getBoundingClientRect();if(l.top>=o-20){t=s,r=l.top;break}}}return{refDOM:t,refTop:r,stack:da(e.dom)}}(this);if(i){this.domObserver.stop();var S=u&&(Ki.ie||Ki.chrome)&&!this.composing&&!n.selection.empty&&!e.selection.empty&&(f=n.selection,v=e.selection,m=Math.min(f.$anchor.sharedDepth(f.head),v.$anchor.sharedDepth(v.head)),f.$anchor.start(m)!=v.$anchor.start(m));if(u){var M=Ki.chrome?this.trackWrites=this.root.getSelection().focusNode:null;!o&&this.docView.update(e.doc,l,s,this)||(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=$a(e.doc,l,s,this.dom,this)),M&&!this.trackWrites&&(S=!0)}S||!(this.mouseDown&&this.domObserver.currentSelection.eq(this.root.getSelection())&&(h=this,d=h.docView.domFromPos(h.state.selection.anchor,0),p=h.root.getSelection(),ta(d.node,d.offset,p.anchorNode,p.anchorOffset)))?ts(this,S):(ss(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}if(this.updatePluginViews(n),"reset"==c)this.dom.scrollTop=0;else if("to selection"==c){var C=this.root.getSelection().focusNode;this.someProp("handleScrollToSelection",(function(e){return e(r)}))||(e.selection instanceof ki?ha(this,this.docView.domAfterPos(e.selection.from).getBoundingClientRect(),C):ha(this,this.coordsAtPos(e.selection.head,1),C))}else x&&(y=(g=x).refDOM,w=g.refTop,b=g.stack,k=y?y.getBoundingClientRect().top:0,pa(b,0==k?0:k-w))},Tl.prototype.destroyPluginViews=function(){for(var e;e=this.pluginViews.pop();)e.destroy&&e.destroy()},Tl.prototype.updatePluginViews=function(e){if(e&&e.plugins==this.state.plugins)for(var t=0;t<this.pluginViews.length;t++){var r=this.pluginViews[t];r.update&&r.update(this,e)}else{this.destroyPluginViews();for(var n=0;n<this.state.plugins.length;n++){var o=this.state.plugins[n];o.spec.view&&this.pluginViews.push(o.spec.view(this))}}},Tl.prototype.someProp=function(e,t){var r,n=this._props&&this._props[e];if(null!=n&&(r=t?t(n):n))return r;var o=this.state.plugins;if(o)for(var i=0;i<o.length;i++){var a=o[i].props[e];if(null!=a&&(r=t?t(a):a))return r}},Tl.prototype.hasFocus=function(){return this.root.activeElement==this.dom},Tl.prototype.focus=function(){this.domObserver.stop(),this.editable&&function(e){if(e.setActive)return e.setActive();if(fa)return e.focus(fa);var t=da(e);e.focus(null==fa?{get preventScroll(){return fa={preventScroll:!0},!0}}:void 0),fa||(fa=!1,pa(t,0))}(this.dom),ts(this),this.domObserver.start()},Dl.root.get=function(){var e=this._root;if(null==e)for(var t=this.dom.parentNode;t;t=t.parentNode)if(9==t.nodeType||11==t.nodeType&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=function(){return document.getSelection()}),this._root=t;return e||document},Tl.prototype.posAtCoords=function(e){return ya(this,e)},Tl.prototype.coordsAtPos=function(e,t){return void 0===t&&(t=1),ka(this,e,t)},Tl.prototype.domAtPos=function(e,t){return void 0===t&&(t=0),this.docView.domFromPos(e,t)},Tl.prototype.nodeDOM=function(e){var t=this.docView.descAt(e);return t?t.nodeDOM:null},Tl.prototype.posAtDOM=function(e,t,r){void 0===r&&(r=-1);var n=this.docView.posFromDOM(e,t,r);if(null==n)throw new RangeError("DOM position not inside the editor");return n},Tl.prototype.endOfTextblock=function(e,t){return Na(this,t||this.state,e)},Tl.prototype.destroy=function(){this.docView&&(!function(e){for(var t in e.domObserver.stop(),e.eventHandlers)e.dom.removeEventListener(t,e.eventHandlers[t]);clearTimeout(e.composingTimeout),clearTimeout(e.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Rl(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)},Tl.prototype.dispatchEvent=function(e){return function(e,t){Us(e,t)||!Fs[t.type]||!e.editable&&t.type in js||Fs[t.type](e,t)}(this,e)},Tl.prototype.dispatch=function(e){var t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))},Object.defineProperties(Tl.prototype,Dl);var $l,Bl,Hl,Ll;function _l(e){return e===$l.InvalidSplit}(Bl=$l||($l={})).End="exit-end",Bl.Removed="delete",Bl.Split="exit-split",Bl.InvalidSplit="invalid-exit-split",Bl.MoveEnd="move-end",Bl.MoveStart="move-start",Bl.JumpForward="jump-forward-exit",Bl.JumpBackward="jump-backward-exit",Bl.SelectionOutside="selection-outside",(Ll=Hl||(Hl={})).Start="start",Ll.Text="change-character",Ll.SelectionInside="selection-inside",Ll.Move="move",Ll.JumpBackward="jump-backward-change",Ll.JumpForward="jump-forward-change",$l.MoveEnd,$l.MoveStart,$l.SelectionOutside,$l.JumpForward,$l.JumpBackward,Hl.JumpBackward,Hl.JumpForward,Hl.Move,Hl.SelectionInside;var Fl=[$l.JumpBackward,$l.JumpForward],jl=[Hl.JumpBackward,Hl.JumpForward];function Wl(e){return!!(e&&e.query.full.length>=e.suggester.matchOffset)}function Kl(e){return Wr(e)&&e instanceof wi}function Ul(e){var t=e.match,r=e.changeReason,n=e.exitReason;return zt(zt({},t),{},{changeReason:r,exitReason:n})}function ql(e){var t,r=e.text,n=e.regexp,o=e.$pos,i=e.suggester,a=o.start();return Yr(r,n).forEach((e=>{var r,n,s,l,c=e.input.slice(Math.max(0,e.index-1),e.index);if(r=c,s=(n=i).invalidPrefixCharacters,l=n.validPrefixCharacters,s?!new RegExp(nc(s)).test(r):new RegExp(nc(l)).test(r)){var u=e.index+a,h=u+e[0].length,d=Math.min(h,o.pos),p=d-u,f=e[1];u<o.pos&&h>=o.pos&&(t={range:{from:u,to:h,cursor:d},match:e,query:{partial:e[0].slice(f.length,p),full:e[0].slice(f.length)},text:{partial:e[0].slice(0,p),full:e[0]},textAfter:o.doc.textBetween(h,o.end(),"\0","\0"),textBefore:o.doc.textBetween(a,u,"\0","\0"),suggester:i})}})),t}function Jl(e){var t=e.$pos,r=e.suggester,n=r.char,o=r.name,i=r.startOfLine,a=r.supportedCharacters,s=function(e){var t=e.char,r=e.matchOffset,n=e.startOfLine,o=e.supportedCharacters,i=e.captureChar,a=void 0===i||i,s=e.caseInsensitive,l=void 0!==s&&s,c=e.multiline,u="g".concat(void 0!==c&&c?"m":"").concat(l?"i":""),h=function(e){return $r(e)?new RegExp((e=>{if("string"!=typeof e)throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")})(e)):e}(t).source;a&&(h="(".concat(h,")"));return new RegExp("".concat((d=n,d?"^":"")).concat(h).concat(function(e,t){return"(?:".concat(nc(e),"){").concat(t,",}")}(o,r)),u);var d}({char:n,matchOffset:r.matchOffset,startOfLine:i,supportedCharacters:a,multiline:r.multiline,caseInsensitive:r.caseInsensitive});return ql({suggester:r,text:t.doc.textBetween(t.before(),t.end(),"\0","\0"),regexp:s,$pos:t,char:n,name:o})}function Zl(e){var t=e.state,r=e.match;try{return Jl({$pos:t.doc.resolve(r.range.cursor),suggester:r.suggester})}catch(n){return}}function Gl(e){var t=e.prev,r=e.next,n=e.state;return!r&&t.range.from>=n.doc.nodeSize?{exit:Ul({match:t,exitReason:$l.Removed})}:r&&t.query.partial?t.range.to===r.range.cursor?{exit:Ul({match:r,exitReason:$l.End})}:t.query.partial?{exit:Ul({match:r,exitReason:$l.Split})}:{}:{exit:Ul({match:t,exitReason:$l.InvalidSplit})}}function Xl(e){var t=e.prev,r=e.next,n=e.state,o=e.$pos,i=Tr();if(!t&&!r)return i;var a={prev:t,next:r};return function(e){return!(!e.prev||!e.next||e.prev.range.from===e.next.range.from)}(a)?function(e){var t=e.prev,r=e.next,n=e.state,o=Tr(),i=Zl({state:n,match:t}),a=(i&&i.query.full!==t.query.full?Gl({prev:t,next:i,state:n}):o).exit;return t.range.from<r.range.from?{exit:null!=a?a:Ul({match:t,exitReason:$l.JumpForward}),change:Ul({match:r,changeReason:Hl.JumpForward})}:{exit:null!=a?a:Ul({match:t,exitReason:$l.JumpBackward}),change:Ul({match:r,changeReason:Hl.JumpBackward})}}({prev:a.prev,next:a.next,state:n}):function(e){return!(e.prev||!e.next)}(a)?{change:Ul({match:a.next,changeReason:Hl.Start})}:function(e){return!(!e.prev||e.next)}(a)?function(e){var t=e.match,r=e.state,n=e.$pos,o=r.selection,i=Zl({match:t,state:r});return i&&i.text.full===t.text.full?!r.selection.empty&&(o.from<=t.range.from||o.to>=t.range.to)?{exit:Ul({match:t,exitReason:$l.SelectionOutside})}:n.pos>t.range.to?{exit:Ul({match:t,exitReason:$l.MoveEnd})}:n.pos<=t.range.from?{exit:Ul({match:t,exitReason:$l.MoveStart})}:{}:Gl({prev:t,next:i,state:r})}({$pos:o,match:a.prev,state:n}):function(e){return!(!e.prev||!e.next||e.prev.text.full===e.next.text.full)}(a)?{change:Ul({match:a.next,changeReason:Hl.Text})}:function(e){return!(!e.prev||!e.next||e.prev.range.cursor===e.next.range.cursor)}(a)?{change:Ul({match:a.next,changeReason:n.selection.empty?Hl.Move:Hl.SelectionInside})}:i}function Yl(e,t){for(var r=e.depth;r>0;r--){var n=e.node(r);if(t.includes(n.type.name))return!0}return!1}function Ql(e,t){var r=e.$from,n=e.$to;return!!ec(e,t)||sn(r.pos,n.pos).some((e=>function(e,t){var r=new Set(e.marks().map((e=>e.type.name)));return t.some((e=>r.has(e)))}(r.doc.resolve(e),t)))}function ec(e,t){var r,n=e.$from,o=e.$to,i=new Set((null!==(r=n.marksAcross(o))&&void 0!==r?r:[]).map((e=>e.type.name)));return t.some((e=>i.has(e)))}function tc(e,t){var r=t.$cursor,n=e.validMarks,o=e.validNodes,i=e.invalidMarks,a=e.invalidNodes;return!(n||o||!Zr(i)||!Zr(a))||!(n&&!ec(t,n))&&(!(o&&!Yl(r,o))&&(!(!n&&Ql(t,i))&&!(!o&&Yl(r,a))))}function rc(e){var t,r=e.suggesters,n=e.$pos,o=e.selectionEmpty,i=Bt(r);try{for(i.s();!(t=i.n()).done;){var a=t.value;if(!a.emptySelectionsOnly||o)try{var s=Jl({suggester:a,$pos:n});if(!s)continue;var l={$from:n.doc.resolve(s.range.from),$to:n.doc.resolve(s.range.to),$cursor:n};if(tc(a,l)&&a.isValidPosition(l,s))return s}catch(c){}}}catch(u){i.e(u)}finally{i.f()}}function nc(e){return Ur(e)?e.source:e}var oc={appendTransaction:!1,priority:50,ignoredTag:"span",matchOffset:0,disableDecorations:!1,startOfLine:!1,suggestClassName:"suggest",suggestTag:"span",supportedCharacters:/\w+/,validPrefixCharacters:/^[\s\0]?$/,invalidPrefixCharacters:null,ignoredClassName:null,invalidMarks:[],invalidNodes:[],validMarks:null,validNodes:null,isValidPosition:()=>!0,checkNextValidSelection:null,emptySelectionsOnly:!1,caseInsensitive:!1,multiline:!1,captureChar:!0},ic=new WeakMap,ac=new WeakMap,sc=new WeakMap,lc=new WeakMap,cc=new WeakMap,uc=new WeakMap,hc=new WeakMap,dc=new WeakMap,pc=new WeakMap;class fc{static create(e){return new fc(e)}get decorationSet(){return Lt(this,hc)}get removed(){return Lt(this,dc)}get match(){return Lt(this,lc)?Lt(this,lc):Lt(this,cc)&&Lt(this,uc).exit?Lt(this,cc):void 0}constructor(e){ic.set(this,{writable:!0,value:!1}),ac.set(this,{writable:!0,value:!1}),sc.set(this,{writable:!0,value:void 0}),lc.set(this,{writable:!0,value:void 0}),cc.set(this,{writable:!0,value:void 0}),uc.set(this,{writable:!0,value:Tr()}),hc.set(this,{writable:!0,value:bl.empty}),dc.set(this,{writable:!0,value:!1}),pc.set(this,{writable:!0,value:!1}),It(this,"setMarkRemoved",(()=>{Wi(this,dc,!0)})),It(this,"findNextTextSelection",(e=>{var t=e.$from.doc,r=Math.min(t.nodeSize-2,e.to+1),n=t.resolve(r),o=mi.findFrom(n,1,!0);if(Kl(o))return o})),It(this,"ignoreNextExit",(()=>{Wi(this,ac,!0)})),It(this,"addIgnored",(e=>{var t=e.from,r=e.name,n=e.specific,o=void 0!==n&&n,i=Lt(this,sc).find((e=>e.name===r));if(!i)throw new Error("No suggester exists for the name provided: ".concat(r));var a=t+($r(i.char)?i.char.length:1),s=i.ignoredClassName?{class:i.ignoredClassName}:{},l=ml.inline(t,a,zt({nodeName:i.ignoredTag},s),{name:r,specific:o,char:i.char});Wi(this,hc,Lt(this,hc).add(this.view.state.doc,[l]))})),It(this,"removeIgnored",(e=>{var t=e.from,r=e.name,n=Lt(this,sc).find((e=>e.name===r));if(!n)throw new Error("No suggester exists for the name provided: ".concat(r));var o=$r(n.char)?n.char.length:1,i=Lt(this,hc).find(t,t+o)[0];Dr(i)&&i.spec.name===r&&Wi(this,hc,Lt(this,hc).remove([i]))})),It(this,"clearIgnored",(e=>{if(e){var t=Lt(this,hc).find().filter((t=>t.spec.name===e));Wi(this,hc,Lt(this,hc).remove(t))}else Wi(this,hc,bl.empty)})),It(this,"findMatchAtPosition",((e,t)=>rc({suggesters:t?Lt(this,sc).filter((e=>e.name===t)):Lt(this,sc),$pos:e,docChanged:!1,selectionEmpty:!0})));var t=vc();Wi(this,sc,e.map(t)),Wi(this,sc,nn(Lt(this,sc),((e,t)=>t.priority-e.priority)))}init(e){return this.view=e,this}createParameter(e){var t=e.suggester,r=t.name,n=t.char;return zt({view:this.view,addIgnored:this.addIgnored,clearIgnored:this.clearIgnored,ignoreNextExit:this.ignoreNextExit,setMarkRemoved:this.setMarkRemoved,name:r,char:n},e)}shouldRunExit(){return!Lt(this,ac)||(Wi(this,ac,!1),!1)}updateWithNextSelection(e){var t=this.findNextTextSelection(e.selection);if(t){var r,n=Bt(Lt(this,sc));try{for(n.s();!(r=n.n()).done;){var o,i,a,s=r.value,l=null===(o=Lt(this,uc).change)||void 0===o?void 0:o.suggester.name,c=null===(i=Lt(this,uc).exit)||void 0===i?void 0:i.suggester.name;null===(a=s.checkNextValidSelection)||void 0===a||a.call(s,t.$from,e,{change:l,exit:c})}}catch(u){n.e(u)}finally{n.f()}}}changeHandler(e,t){var r=Lt(this,uc),n=r.change,o=r.exit,i=this.match;if((n||o)&&Wl(i)){var a=t===(null==o?void 0:o.suggester.appendTransaction)&&this.shouldRunExit(),s=t===(null==n?void 0:n.suggester.appendTransaction);if(a||s){if(n&&o&&(Rr(Fl,null===(h=(u={change:n,exit:o}).exit)||void 0===h?void 0:h.exitReason)||Rr(jl,null===(d=u.change)||void 0===d?void 0:d.changeReason))){var l=this.createParameter(o),c=this.createParameter(n);o.range.from,n.range.from;return a&&o.suggester.onChange(l,e),s&&n.suggester.onChange(c,e),void(a&&Wi(this,dc,!1))}var u,h,d;n&&s&&n.suggester.onChange(this.createParameter(n),e),o&&a&&(o.suggester.onChange(this.createParameter(o),e),Wi(this,dc,!1),_l(o.exitReason)&&Wi(this,uc,Tr()))}}}mapIgnoredDecorations(e){var t=Lt(this,hc).map(e.mapping,e.doc),r=t.find().filter((e=>{var t=e.from,r=e.to,n=e.spec;return r-t!==($r(n.char)?n.char.length:1)}));Wi(this,hc,t.remove(r))}shouldIgnoreMatch(e){var t=e.range,r=e.suggester.name;return Lt(this,hc).find().some((e=>{var n=e.spec;return e.from===t.from&&(!n.specific||n.name===r)}))}resetState(){Wi(this,uc,Tr()),Wi(this,lc,void 0),Wi(this,dc,!1),Wi(this,pc,!1)}updateReasons(e){var t=e.$pos,r=e.state,n=Lt(this,ic),o=Lt(this,sc),i=r.selection.empty,a=Kl(r.selection)?rc({suggesters:o,$pos:t,docChanged:n,selectionEmpty:i}):void 0;Wi(this,lc,a&&this.shouldIgnoreMatch(a)?void 0:a),Wi(this,uc,Xl({next:Lt(this,lc),prev:Lt(this,cc),state:r,$pos:t}))}addSuggester(e){var t=Lt(this,sc).find((t=>t.name===e.name)),r=vc();if(t)Wi(this,sc,Lt(this,sc).map((n=>n===t?r(e):n)));else{var n=[...Lt(this,sc),r(e)];Wi(this,sc,nn(n,((e,t)=>t.priority-e.priority)))}return()=>this.removeSuggester(e.name)}removeSuggester(e){var t=$r(e)?e:e.name;Wi(this,sc,Lt(this,sc).filter((e=>e.name!==t))),this.clearIgnored(t)}toJSON(){return this.match}apply(e){if(Lt(this,pc))return Wi(this,pc,!1),this;var t=e.tr,r=e.state,n=Lt(this,uc).exit;return t.docChanged||t.selectionSet||Lt(this,dc)?(Wi(this,ic,t.docChanged),this.mapIgnoredDecorations(t),n&&this.resetState(),Wi(this,cc,Lt(this,lc)),this.updateReasons({$pos:t.selection.$from,state:r}),this):this}createDecorations(e){var t=this.match;if(!Wl(t))return Lt(this,hc);var r=t.suggester.disableDecorations;if(Hr(r)?r(e,t):r)return Lt(this,hc);var n=t.range,o=t.suggester,i=o.name,a=o.suggestTag,s=o.suggestClassName,l=n.from,c=n.to;return this.shouldIgnoreMatch(t)?Lt(this,hc):Lt(this,hc).add(e.doc,[ml.inline(l,c,{nodeName:a,class:i?"".concat(s," suggest-").concat(i):s},{name:i})])}setLastChangeFromAppend(){Wi(this,pc,!0)}}function vc(){var e=new Set;return t=>{if(e.has(t.name))throw new Error("A suggester already exists with the name '".concat(t.name,"'. The name provided must be unique."));var r=zt(zt({},oc),t);return e.add(t.name),r}}var mc=new Hi("suggest");function gc(e){return mc.getState(e)}function yc(e,t){return gc(e).addSuggester(t)}var wc={get isBrowser(){return Dr("undefined"!=="object".document&&window.navigator&&window.navigator.userAgent)},get isJSDOM(){return wc.isBrowser&&window.navigator.userAgent.includes("jsdom")},get isNode(){return"undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node},get isIos(){return wc.isBrowser&&/iPod|iPhone|iPad/.test(navigator.platform)},get isMac(){return wc.isBrowser&&/Mac|iPod|iPhone|iPad/.test(navigator.platform)},get isApple(){return wc.isNode?"darwin"===process.platform:!!wc.isBrowser&&/Mac|iPod|iPhone|iPad/.test(window.navigator.platform)},get isDevelopment(){return!1},get isTest(){return!1},get isProduction(){return!0}};function bc(e){return Wr(e)&&e instanceof Zn}function kc(e){return Wr(e)&&e instanceof Di}function xc(e){return Wr(e)&&e instanceof wi}function Sc(e){return Wr(e)&&e instanceof mi}function Mc(e){return Wr(e)&&e instanceof ki}function Cc(e){var t=e.trState,r=e.type,n=e.from,o=e.to,i=t.selection,a=t.doc,s=t.storedMarks,l=i.$from,c=i.empty;if(n&&o)try{return Math.max(n,o)<a.nodeSize&&a.rangeHasMark(n,o,r)}catch(u){return!1}return c?Dr(r.isInSet(null!=s?s:l.marks())):a.rangeHasMark(i.from,i.to,r)}function Oc(e){var t=e.content.firstChild;return!(1!==e.childCount||!t)&&(t.type.isBlock&&!t.childCount&&2===t.nodeSize&&(jr(t.marks)||0===t.marks.length))}function Ec(e,t,r){var n=e.parent.childAfter(e.parentOffset);if(n.node){var o=$r(t)?t:t.name,i=n.node.marks.find((e=>e.type.name===o)),a=e.index(),s=e.start()+n.offset,l=a+1,c=s+n.node.nodeSize;if(!i)return r&&c<r.pos?Ec(e.doc.resolve(c+1),t,r):void 0;for(;a>0&&i.isInSet(e.parent.child(a-1).marks);)a-=1,s-=e.parent.child(a).nodeSize;for(;l<e.parent.childCount&&i.isInSet(e.parent.child(l).marks);)c+=e.parent.child(l).nodeSize,l+=1;return{from:s,to:c,text:e.doc.textBetween(s,c,"￼","\n\n"),mark:i}}}function Ac(e){return function(e,t){if(!xc(e.selection))return!1;for(var r=e.selection,n=r.from,o=r.to,i=(t,r)=>{return null!==(n=null===(o=wi.create(e.doc,t,r).content().content.firstChild)||void 0===o?void 0:o.textContent)&&void 0!==n?n:"";var n,o},a=i(n-1,n);a&&!t.test(a);a=i(--n-1,n));for(var s=i(o,o+1);s&&!t.test(s);s=i(++o,o+1));return n!==o&&{from:n,to:o}}(e,/[\s\0]/)}function Nc(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Array.isArray(e)?e[t]:e}function Rc(e){return Wr(Node)?e instanceof Node:Wr(e)&&Br(e.nodeType)&&$r(e.nodeName)}function Tc(e){return Rc(e)&&e.nodeType===Node.ELEMENT_NODE}function Dc(e,t){var r,n,o=t.nodeSize-2,i=e=>function(e){var t=e.min,r=e.max,n=e.value;return n<t?t:n>r?r:n}({min:0,max:o,value:e});if(Sc(e))return e;if("all"===e)return new Si(t);if(Br(r="start"===e?0:"end"===e?o:e))return r=i(r),wi.near(t.resolve(r));if(Wr(n=r)&&Br(n.anchor)&&Br(n.head)){var a=i(r.anchor),s=i(r.head);return wi.create(t,a,s)}var l=i(r.from),c=i(r.to);return wi.create(t,l,c)}function Pc(e){var t=e.content,r=e.schema,n=e.document,o=e.stringHandler,i=e.onError,a=e.attempts,s=void 0===a?0:a;if(i&&s<=3||0===s||pn(!1),$r(t))return o||pn(!1),o({document:n,content:t,schema:r});if(kc(t))return t.doc;if(bc(t))return t;try{return r.nodeFromJSON(t)}catch(u){var l=function(e){var t=e.json,r=e.schema,n=$t(e,["json","schema"]),o=new Set(Ar(r.marks)),i=new Set(Ar(r.nodes)),a=Lc({json:t,path:[],validNodes:i,validMarks:o});return zt({json:t,invalidContent:a,transformers:Hc},n)}({schema:r,error:u,json:t}),c=null==i?void 0:i(l);return c||pn(!1),Pc(zt(zt({},e),{},{content:c,attempts:s+1}))}}function Ic(e){return"dom"===e||wc.isBrowser&&!e}function Vc(e){return document}function zc(e){var t=e.node,r=e.schema,n=e.document,o=function(e,t){return!!bc(e)&&(t?e.type===t.nodes.doc:"doc"===e.type.name)}(t,r)?t.content:kn.from(t);return Do.fromSchema(r).serializeFragment(o,{document:n})}function $c(e){var t=e.node,r=e.schema,n=e.document,o=void 0===n?Vc():n,i=o.createElement("div");return i.append(zc({node:t,schema:r,document:o})),i.innerHTML}function Bc(e,t){var r=Ar(t.defaults());return gr(zt({},e),r)}var Hc={remove(e,t){var r,n=e,o=Bt(t);try{for(o.s();!(r=o.n()).done;){var i=r.value;i.invalidParentNode||(n=on(i.path,n))}}catch(a){o.e(a)}finally{o.f()}return n}};function Lc(e){var t=e.json,r=e.validMarks,n=e.validNodes,o=e.path,i=void 0===o?[]:o,a={validMarks:r,validNodes:n},s=[],l=t.type,c=t.marks,u=t.content,h=e.invalidParentMark,d=void 0!==h&&h,p=e.invalidParentNode,f=void 0!==p&&p;if(c){var v,m=[],g=Bt(c.entries());try{for(g.s();!(v=g.n()).done;){var y=Pt(v.value,2),w=y[0],b=y[1],k=$r(b)?b:b.type;r.has(k)||(m.unshift({name:k,path:[...i,"marks","".concat(w)],type:"mark",invalidParentMark:d,invalidParentNode:f}),d=!0)}}catch(A){g.e(A)}finally{g.f()}s.push(...m)}if(n.has(l)||(s.push({name:l,type:"node",path:i,invalidParentMark:d,invalidParentNode:f}),f=!0),u){var x,S=[],M=Bt(u.entries());try{for(M.s();!(x=M.n()).done;){var C=Pt(x.value,2),O=C[0],E=C[1];S.unshift(...Lc(zt(zt({},a),{},{json:E,path:[...i,"content","".concat(O)],invalidParentMark:d,invalidParentNode:f})))}}catch(A){M.e(A)}finally{M.f()}s.unshift(...S)}return s}function _c(e){var t=e.types,r=e.node;if(!r)return!1;var n=e=>e===r.type||e===r.type.name;return Jr(t)?t.some(n):n(t)}function Fc(e){for(var t=e.predicate,r=e.selection,n=kc(r)?r.selection.$from:Sc(r)?r.$from:r,o=n.depth;o>0;o--){var i=n.node(o);if(t(i)){var a=o>0?n.before(o):0;return{pos:a,depth:o,node:i,start:n.start(o),end:a+i.nodeSize}}}}function jc(e){var t=e.depth,r=t>0?e.before(t):0,n=e.node(t);return{pos:r,start:e.start(t),node:n,end:r+n.nodeSize,depth:t}}function Wc(e){return Sc(e)?e.empty:!function(e){return Wr(e)&&e instanceof Ei}(e)&&!kc(e)||e.selection.empty}function Kc(e){return!!Uc(e)}function Uc(e){var t,r=e.state,n=e.type,o=e.attrs,i=r.selection,a=$r(n)?r.doc.type.schema.nodes[n]:n;a||pn(!1);var s=null!==(t=function(e){var t=e.types,r=e.selection;if(Mc(r)&&_c({types:t,node:r.node}))return{pos:r.$from.pos,depth:r.$from.depth,start:r.$from.start(),end:r.$from.pos+r.node.nodeSize,node:r.node}}({selection:i,types:n}))&&void 0!==t?t:Fc({predicate:e=>e.type===a,selection:i});return o&&!qr(o)&&s?s.node.hasMarkup(a,zt(zt({},s.node.attrs),o))?s:void 0:s}function qc(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return e=>{if(Zr(t))return!1;var r=t[0],n=t.slice(1),o=!1,i=function t(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return()=>{if(Zr(n))return!1;o=!0;var r=n.slice(1);return qc(...n)(zt(zt({},e),{},{next:t(...r)}))}}(...n),a=r(zt(zt({},e),{},{next:i}));return o||a?a:i()}}function Jc(e){return function(e,t){var r,n=new Map,o=Tr(),i=Bt(e);try{for(i.s();!(r=i.n()).done;){var a,s=Bt(Er(r.value));try{for(s.s();!(a=s.n()).done;){var l,c=Pt(a.value,2),u=c[0],h=c[1],d=[...null!==(l=n.get(u))&&void 0!==l?l:[],h],p=qc(...d);n.set(u,d),o[u]=t(p)}}catch(f){s.e(f)}finally{s.f()}}}catch(f){i.e(f)}finally{i.f()}return o}(e,(e=>(t,r,n)=>e({state:t,dispatch:r,view:n,tr:t.tr,next:()=>!1})))}function Zc(e){var t=e.tr,r=e.dispatch,n=t.selection,o=n.$from,i=n.$to,a=o.blockRange(i),s=a&&Xo(a);return!(!Br(s)||!a)&&(null==r||r(t.lift(a,s).scrollIntoView()),!0)}function Gc(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;return function(n){var o=n.tr,i=n.dispatch,a=n.state,s=$r(e)?a.schema.nodes[e]:e,l=null!=r?r:o.selection,c=l.from,u=l.to,h=o.doc.resolve(c),d=o.doc.resolve(u),p=h.blockRange(d),f=p&&Yo(p,s,t);return!(!f||!p)&&(null==i||i(o.wrap(p,f).scrollIntoView()),!0)}}function Xc(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r=>{var n=r.tr,o=r.state;return Kc({state:n,type:$r(e)?o.schema.nodes[e]:e})?Zc(r):Gc(e,t)(r)}}function Yc(e,t,r){return function(n){var o,i=n.tr,a=n.dispatch,s=n.state,l=$r(e)?s.schema.nodes[e]:e,c=null!=r?r:i.selection,u=c.from,h=c.to,d=!1;return i.doc.nodesBetween(u,h,((e,r)=>{if(d)return!1;if(e.isTextblock&&!e.hasMarkup(l,t)){if(e.type===l)return d=!0,void(o=e.attrs);var n=i.doc.resolve(r),a=n.index();(d=n.parent.canReplaceWith(a,a+1,l))&&(o=n.parent.attrs)}})),!!d&&(a&&a(i.setBlockType(u,h,l,zt(zt({},o),t)).scrollIntoView()),!0)}}function Qc(e){return t=>{var r=t.tr,n=e.type,o=e.toggleType,i=e.attrs,a=e.preserveAttrs,s=void 0===a||a,l=Uc({state:r,type:n,attrs:i});if(l)return Yc(o,zt(zt({},s?l.node.attrs:{}),i))(t);var c=Uc({state:r,type:o,attrs:i});return Yc(n,zt(zt({},s?null==c?void 0:c.node.attrs:{}),i))(t)}}function eu(e,t){var r,n=e.head,o=Bt(t.steps);try{for(o.s();!(r=o.n()).done;){n=r.value.getMap().map(n)}}catch(i){o.e(i)}finally{o.f()}e.empty?t.setSelection(wi.create(t.doc,n)):t.setSelection(wi.create(t.doc,e.anchor,n))}function tu(e){return t=>{var r=t.dispatch,n=t.tr,o=e.type,i=e.expand,a=void 0!==i&&i,s=e.range,l=n.selection,c=null!=s?s:l,u=c.from,h=c.to;if(a){var d,p=s?Ec(n.doc.resolve(s.from),o)||Br(s.to)&&Ec(n.doc.resolve(s.to),o)||{from:u,to:h}:Wc(n)&&null!==(d=Ec(l.$anchor,o))&&void 0!==d?d:{from:u,to:h};u=p.from,h=p.to}return null==r||r(n.removeMark(u,Br(h)?h:u,o)),!0}}function ru(e){var t=e.regexp,r=e.type,n=e.getAttributes,o=e=>{var i=[];return e.forEach((e=>{if(e.isText){var a,s=null!==(a=e.text)&&void 0!==a?a:"",l=0;Yr(s,t).forEach((t=>{if(t[1]){var o=t.index,a=o+t[0].length,s=Hr(n)?n(t):n;o>0&&i.push(e.cut(l,o)),i.push(e.cut(o,a).mark(r.create(s).addToSet(e.marks))),l=a}})),s&&l<s.length&&i.push(e.cut(l))}else i.push(e.copy(o(e.content)))})),kn.fromArray(i)};return new zi({key:new Hi("pasteRule"),props:{transformPasted:e=>new An(o(e.content),e.openStart,e.openEnd)}})}function nu(e){var t=e.regexp,r=e.type,n=e.getAttributes,o=e.ignoreWhitespace,i=void 0!==o&&o,a=e.beforeDispatch,s=e.updateCaptured,l=new Li(t,((e,t,o,c)=>{var u,h,d,p,f,v,m=e.tr,g=Hr(n)?n(t):n,y=e.doc.resolve(o),w=e.doc.resolve(c);if(l.invalidMarks&&Ql({$from:y,$to:w},l.invalidMarks))return null;var b=null!==(u=null==s?void 0:s({captureGroup:t[1],fullMatch:t[0],start:o,end:c}))&&void 0!==u?u:{},k=null!==(h=b.captureGroup)&&void 0!==h?h:t[1],x=null!==(d=b.fullMatch)&&void 0!==d?d:t[0];o=null!==(p=b.start)&&void 0!==p?p:o;var S=c=null!==(f=b.end)&&void 0!==f?f:c,M=[];if(i&&""===(null==k?void 0:k.trim()))return null;if(null===(v=l.shouldSkip)||void 0===v?void 0:v.call(l,{state:e,captureGroup:k,fullMatch:x,start:o,end:c,ruleType:"mark"}))return null;if(k){var C,O=x.search(/\S/),E=o+x.indexOf(k),A=E+k.length;M=null!==(C=m.storedMarks)&&void 0!==C?C:[],A<c&&m.delete(A,c),E>o&&m.delete(o+O,E),S=o+O+k.length}return m.addMark(o,S,r.create(g)),m.setStoredMarks(M),null==a||a({tr:m,match:t,start:o,end:c}),m}));return l}function ou(e,t){return!e.selection.empty&&(t&&t(e.tr.deleteSelection().scrollIntoView()),!0)}function iu(e,t){for(;e;e="start"==t?e.firstChild:e.lastChild)if(e.isTextblock)return!0;return!1}function au(e){if(!e.parent.type.spec.isolating)for(var t=e.depth-1;t>=0;t--){if(e.index(t)>0)return e.doc.resolve(e.before(t+1));if(e.node(t).type.spec.isolating)break}return null}function su(e){if(!e.parent.type.spec.isolating)for(var t=e.depth-1;t>=0;t--){var r=e.node(t);if(e.index(t)+1<r.childCount)return e.doc.resolve(e.after(t+1));if(r.type.spec.isolating)break}return null}function lu(e){for(var t=0;t<e.edgeCount;t++){var r=e.edge(t).type;if(r.isTextblock&&!r.hasRequiredAttrs())return r}return null}function cu(e,t){var r,n=e.selection,o=n.$from,i=n.to,a=o.sharedDepth(i);return 0!=a&&(r=o.before(a),t&&t(e.tr.setSelection(ki.create(e.doc,r))),!0)}function uu(e,t,r){var n,o,i=t.nodeBefore,a=t.nodeAfter;if(i.type.spec.isolating||a.type.spec.isolating)return!1;if(function(e,t,r){var n=t.nodeBefore,o=t.nodeAfter,i=t.index();return!(!(n&&o&&n.type.compatibleContent(o.type))||(!n.content.size&&t.parent.canReplace(i-1,i)?(r&&r(e.tr.delete(t.pos-n.nodeSize,t.pos).scrollIntoView()),0):!t.parent.canReplace(i,i+1)||!o.isTextblock&&!ti(e.doc,t.pos)||(r&&r(e.tr.clearIncompatible(t.pos,n.type,n.contentMatchAt(n.childCount)).join(t.pos).scrollIntoView()),0)))}(e,t,r))return!0;var s=t.parent.canReplace(t.index(),t.index()+1);if(s&&(n=(o=i.contentMatchAt(i.childCount)).findWrapping(a.type))&&o.matchType(n[0]||a.type).validEnd){if(r){for(var l=t.pos+a.nodeSize,c=kn.empty,u=n.length-1;u>=0;u--)c=kn.from(n[u].create(null,c));c=kn.from(i.copy(c));var h=e.tr.step(new Jo(t.pos-1,l,t.pos,l,new An(c,1,0),n.length,!0)),d=l+2*n.length;ti(h.doc,d)&&h.join(d),r(h.scrollIntoView())}return!0}var p=mi.findFrom(t,1),f=p&&p.$from.blockRange(p.$to),v=f&&Xo(f);if(null!=v&&v>=t.depth)return r&&r(e.tr.lift(f,v).scrollIntoView()),!0;if(s&&a.isTextblock&&iu(i,"end")){for(var m=i,g=[];g.push(m),!m.isTextblock;)m=m.lastChild;if(m.canReplace(m.childCount,m.childCount,a.content)){if(r){for(var y=kn.empty,w=g.length-1;w>=0;w--)y=kn.from(g[w].copy(y));r(e.tr.step(new Jo(t.pos-g.length,t.pos+a.nodeSize,t.pos+1,t.pos+a.nodeSize-1,new An(y,g.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function hu(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return function(t,r,n){for(var o=0;o<e.length;o++)if(e[o](t,r,n))return!0;return!1}}var du=hu(ou,(function(e,t,r){var n=e.selection.$cursor;if(!n||(r?!r.endOfTextblock("backward",e):n.parentOffset>0))return!1;var o=au(n);if(!o){var i=n.blockRange(),a=i&&Xo(i);return null!=a&&(t&&t(e.tr.lift(i,a).scrollIntoView()),!0)}var s=o.nodeBefore;if(!s.type.spec.isolating&&uu(e,o,t))return!0;if(0==n.parent.content.size&&(iu(s,"end")||ki.isSelectable(s))){if(t){var l=e.tr.deleteRange(n.before(),n.after());l.setSelection(iu(s,"end")?mi.findFrom(l.doc.resolve(l.mapping.map(o.pos,-1)),-1):ki.create(l.doc,o.pos-s.nodeSize)),t(l.scrollIntoView())}return!0}return!(!s.isAtom||o.depth!=n.depth-1)&&(t&&t(e.tr.delete(o.pos-s.nodeSize,o.pos).scrollIntoView()),!0)}),(function(e,t,r){var n=e.selection,o=n.$head,i=o;if(!n.empty)return!1;if(o.parent.isTextblock){if(r?!r.endOfTextblock("backward",e):o.parentOffset>0)return!1;i=au(o)}var a=i&&i.nodeBefore;return!(!a||!ki.isSelectable(a))&&(t&&t(e.tr.setSelection(ki.create(e.doc,i.pos-a.nodeSize)).scrollIntoView()),!0)})),pu=hu(ou,(function(e,t,r){var n=e.selection.$cursor;if(!n||(r?!r.endOfTextblock("forward",e):n.parentOffset<n.parent.content.size))return!1;var o=su(n);if(!o)return!1;var i=o.nodeAfter;if(uu(e,o,t))return!0;if(0==n.parent.content.size&&(iu(i,"start")||ki.isSelectable(i))){if(t){var a=e.tr.deleteRange(n.before(),n.after());a.setSelection(iu(i,"start")?mi.findFrom(a.doc.resolve(a.mapping.map(o.pos)),1):ki.create(a.doc,a.mapping.map(o.pos))),t(a.scrollIntoView())}return!0}return!(!i.isAtom||o.depth!=n.depth-1)&&(t&&t(e.tr.delete(o.pos,o.pos+i.nodeSize).scrollIntoView()),!0)}),(function(e,t,r){var n=e.selection,o=n.$head,i=o;if(!n.empty)return!1;if(o.parent.isTextblock){if(r?!r.endOfTextblock("forward",e):o.parentOffset<o.parent.content.size)return!1;i=su(o)}var a=i&&i.nodeAfter;return!(!a||!ki.isSelectable(a))&&(t&&t(e.tr.setSelection(ki.create(e.doc,i.pos)).scrollIntoView()),!0)})),fu={Enter:hu((function(e,t){var r=e.selection,n=r.$head,o=r.$anchor;return!(!n.parent.type.spec.code||!n.sameParent(o))&&(t&&t(e.tr.insertText("\n").scrollIntoView()),!0)}),(function(e,t){var r=e.selection,n=r.$from,o=r.$to;if(r instanceof Si||n.parent.inlineContent||o.parent.inlineContent)return!1;var i=lu(o.parent.contentMatchAt(o.indexAfter()));if(!i||!i.isTextblock)return!1;if(t){var a=(!n.parentOffset&&o.index()<o.parent.childCount?n:o).pos,s=e.tr.insert(a,i.createAndFill());s.setSelection(wi.create(s.doc,a+1)),t(s.scrollIntoView())}return!0}),(function(e,t){var r=e.selection.$cursor;if(!r||r.parent.content.size)return!1;if(r.depth>1&&r.after()!=r.end(-1)){var n=r.before();if(ei(e.doc,n))return t&&t(e.tr.split(n).scrollIntoView()),!0}var o=r.blockRange(),i=o&&Xo(o);return null!=i&&(t&&t(e.tr.lift(o,i).scrollIntoView()),!0)}),(function(e,t){var r=e.selection,n=r.$from,o=r.$to;if(e.selection instanceof ki&&e.selection.node.isBlock)return!(!n.parentOffset||!ei(e.doc,n.pos))&&(t&&t(e.tr.split(n.pos).scrollIntoView()),!0);if(!n.parent.isBlock)return!1;if(t){var i=o.parentOffset==o.parent.content.size,a=e.tr;(e.selection instanceof wi||e.selection instanceof Si)&&a.deleteSelection();var s=0==n.depth?null:lu(n.node(-1).contentMatchAt(n.indexAfter(-1))),l=i&&s?[{type:s}]:null,c=ei(a.doc,a.mapping.map(n.pos),1,l);if(l||c||!ei(a.doc,a.mapping.map(n.pos),1,s&&[{type:s}])||(l=[{type:s}],c=!0),c&&(a.split(a.mapping.map(n.pos),1,l),!i&&!n.parentOffset&&n.parent.type!=s)){var u=a.mapping.map(n.before()),h=a.doc.resolve(u);n.parent.canReplaceWith(h.index(),h.index()+1,s)&&a.setNodeMarkup(a.mapping.map(n.before()),s)}t(a.scrollIntoView())}return!0})),"Mod-Enter":function(e,t){var r=e.selection,n=r.$head,o=r.$anchor;if(!n.parent.type.spec.code||!n.sameParent(o))return!1;var i=n.node(-1),a=n.indexAfter(-1),s=lu(i.contentMatchAt(a));if(!i.canReplaceWith(a,a,s))return!1;if(t){var l=n.after(),c=e.tr.replaceWith(l,l,s.createAndFill());c.setSelection(mi.near(c.doc.resolve(l),1)),t(c.scrollIntoView())}return!0},Backspace:du,"Mod-Backspace":du,Delete:pu,"Mod-Delete":pu,"Mod-a":function(e,t){return t&&t(e.tr.setSelection(new Si(e.doc))),!0}},vu={"Ctrl-h":fu.Backspace,"Alt-Backspace":fu["Mod-Backspace"],"Ctrl-d":fu.Delete,"Ctrl-Alt-Backspace":fu["Mod-Delete"],"Alt-Delete":fu["Mod-Delete"],"Alt-d":fu["Mod-Delete"]};for(var mu in fu)vu[mu]=fu[mu];for(var gu=("undefined"!=typeof navigator?/Mac/.test(navigator.platform):"undefined"!=typeof os&&"darwin"==os.platform())?vu:fu,yu={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",229:"q"},wu={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"',229:"Q"},bu="undefined"!=typeof navigator&&/Chrome\/(\d+)/.exec(navigator.userAgent),ku="undefined"!=typeof navigator&&/Apple Computer/.test(navigator.vendor),xu="undefined"!=typeof navigator&&/Gecko\/\d+/.test(navigator.userAgent),Su="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),Mu="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Cu=bu&&(Su||+bu[1]<57)||xu&&Su,Ou=0;Ou<10;Ou++)yu[48+Ou]=yu[96+Ou]=String(Ou);for(Ou=1;Ou<=24;Ou++)yu[Ou+111]="F"+Ou;for(Ou=65;Ou<=90;Ou++)yu[Ou]=String.fromCharCode(Ou+32),wu[Ou]=String.fromCharCode(Ou);for(var Eu in yu)wu.hasOwnProperty(Eu)||(wu[Eu]=yu[Eu]);var Au="undefined"!=typeof navigator&&/Mac/.test(navigator.platform);function Nu(e){var t,r,n,o,i=e.split(/-(?!$)/),a=i[i.length-1];"Space"==a&&(a=" ");for(var s=0;s<i.length-1;s++){var l=i[s];if(/^(cmd|meta|m)$/i.test(l))o=!0;else if(/^a(lt)?$/i.test(l))t=!0;else if(/^(c|ctrl|control)$/i.test(l))r=!0;else if(/^s(hift)?$/i.test(l))n=!0;else{if(!/^mod$/i.test(l))throw new Error("Unrecognized modifier name: "+l);Au?o=!0:r=!0}}return t&&(a="Alt-"+a),r&&(a="Ctrl-"+a),o&&(a="Meta-"+a),n&&(a="Shift-"+a),a}function Ru(e,t,r){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),!1!==r&&t.shiftKey&&(e="Shift-"+e),e}function Tu(e){var t=function(e){var t=Object.create(null);for(var r in e)t[Nu(r)]=e[r];return t}(e);return function(e,r){var n,o=function(e){var t=!(Cu&&(e.ctrlKey||e.altKey||e.metaKey)||(ku||Mu)&&e.shiftKey&&e.key&&1==e.key.length)&&e.key||(e.shiftKey?wu:yu)[e.keyCode]||e.key||"Unidentified";return"Esc"==t&&(t="Escape"),"Del"==t&&(t="Delete"),"Left"==t&&(t="ArrowLeft"),"Up"==t&&(t="ArrowUp"),"Right"==t&&(t="ArrowRight"),"Down"==t&&(t="ArrowDown"),t}(r),i=1==o.length&&" "!=o,a=t[Ru(o,r,!i)];if(a&&a(e.state,e.dispatch,e))return!0;if(i&&(r.shiftKey||r.altKey||r.metaKey||o.charCodeAt(0)>127)&&(n=yu[r.keyCode])&&n!=o){var s=t[Ru(n,r,!0)];if(s&&s(e.state,e.dispatch,e))return!0}else if(i&&r.shiftKey){var l=t[Ru(o,r,!0)];if(l&&l(e.state,e.dispatch,e))return!0}return!1}}function Du(...e){return e.filter(Boolean).join(" ")}function Pu(e,t){return e===t}function Iu(e){var t,r=e.previousOptions,n=e.update,o=e.equals,i=void 0===o?Pu:o,a=zt(zt({},r),n),s=Tr(),l=Bt(Ar(r));try{for(l.s();!(t=l.n()).done;){var c=t.value,u=r[c],h=a[c];i(u,h)?s[c]={changed:!1}:s[c]={changed:!0,previousValue:u,value:h}}}catch(d){l.e(d)}finally{l.f()}return{changes:s,options:a,pickChanged:e=>{var t,r=Tr(),n=Bt(e);try{for(n.s();!(t=n.n()).done;){var o=t.value,i=s[o];(null==i?void 0:i.changed)&&(r[o]=i.value)}}catch(d){n.e(d)}finally{n.f()}return r}}}function Vu(e){var t=e.name,r=e.set;e.code,r.has(t)&&pn(!1),r.add(t)}Qt.DUPLICATE_HELPER_NAMES,Qt.DUPLICATE_COMMAND_NAMES;var zu=new WeakMap,$u=new WeakMap,Bu=new WeakMap,Hu=new WeakMap;class Lu{static get instanceName(){return br(this.name.split(/(?=[A-Z])/).slice(0,-1).join(""),!0).reduce((function(e,t,r){return 0===r?t.toLowerCase():e+kr(t)}),"")}get options(){return Lt(this,Bu)}get dynamicKeys(){return Lt(this,$u)}get initialOptions(){return Lt(this,zu)}constructor(e){var t=e.validator,r=e.defaultOptions,n=e.code;zu.set(this,{writable:!0,value:void 0}),$u.set(this,{writable:!0,value:void 0}),Bu.set(this,{writable:!0,value:void 0}),Hu.set(this,{writable:!0,value:void 0}),t(this.constructor,n);for(var o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];var s=i[0];Wi(this,Hu,Tr()),this.populateMappedHandlers(),Wi(this,Bu,Wi(this,zu,function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return hr.all(t,{isMergeableObject:_r})}(r,this.constructor.defaultOptions,null!=s?s:Tr(),this.createDefaultHandlerOptions()))),Wi(this,$u,this.getDynamicKeys()),this.init()}init(){}getDynamicKeys(){var e,t=[],r=this.constructor,n=r.customHandlerKeys,o=r.handlerKeys,i=r.staticKeys,a=Bt(Ar(Lt(this,Bu)));try{for(a.s();!(e=a.n()).done;){var s=e.value;i.includes(s)||o.includes(s)||n.includes(s)||t.push(s)}}catch(l){a.e(l)}finally{a.f()}return t}ensureAllKeysAreDynamic(e){}setOptions(e){var t,r=this.getDynamicOptions();this.ensureAllKeysAreDynamic(e);var n=Iu({previousOptions:r,update:e}),o=n.changes,i=n.options,a=n.pickChanged;this.updateDynamicOptions(i),null===(t=this.onSetOptions)||void 0===t||t.call(this,{reason:"set",changes:o,options:i,pickChanged:a,initialOptions:Lt(this,zu)})}resetOptions(){var e,t=Iu({previousOptions:this.getDynamicOptions(),update:Lt(this,zu)}),r=t.changes,n=t.options,o=t.pickChanged;this.updateDynamicOptions(n),null===(e=this.onSetOptions)||void 0===e||e.call(this,{reason:"reset",options:n,changes:r,pickChanged:o,initialOptions:Lt(this,zu)})}getDynamicOptions(){return gr(Lt(this,Bu),[...this.constructor.customHandlerKeys,...this.constructor.handlerKeys])}updateDynamicOptions(e){Wi(this,Bu,zt(zt({},Lt(this,Bu)),e))}populateMappedHandlers(){var e,t=Bt(this.constructor.handlerKeys);try{for(t.s();!(e=t.n()).done;){var r=e.value;Lt(this,Hu)[r]=[]}}catch(n){t.e(n)}finally{t.f()}}createDefaultHandlerOptions(){var e,t=this,r=Tr(),n=Bt(this.constructor.handlerKeys);try{var o=function(){var n=e.value;r[n]=function(){var e,r,o=Bt(Lt(t,Hu)[n]);try{for(o.s();!(r=o.n()).done;){var i=Pt(r.value,2),a=i[1];e=a(...arguments);var s=t.constructor.handlerKeyOptions;if(_u(s,e,n))return e}}catch(l){o.e(l)}finally{o.f()}return e}};for(n.s();!(e=n.n()).done;)o()}catch(i){n.e(i)}finally{n.f()}return r}addHandler(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Zt.Default;return Lt(this,Hu)[e].push([r,t]),this.sortHandlers(e),()=>Lt(this,Hu)[e]=Lt(this,Hu)[e].filter((e=>Pt(e,2)[1]!==t))}sortHandlers(e){Lt(this,Hu)[e]=nn(Lt(this,Hu)[e],((e,t)=>{var r=Pt(e,1)[0];return Pt(t,1)[0]-r}))}addCustomHandler(e,t){var r,n;return null!==(r=null===(n=this.onAddCustomHandler)||void 0===n?void 0:n.call(this,{[e]:t}))&&void 0!==r?r:rn}}function _u(e,t,r){var n=e.__ALL__,o=e[r];return!(!n&&!o)&&(!(!o||"__IGNORE__"===o.earlyReturnValue||(Hr(o.earlyReturnValue)?!0!==o.earlyReturnValue(t):t!==o.earlyReturnValue))||!(!n||"__IGNORE__"===n.earlyReturnValue||(Hr(n.earlyReturnValue)?!0!==n.earlyReturnValue(t):t!==n.earlyReturnValue)))}function Fu(e,t){_r(e.defaultOptions)||pn(!1),Jr(e.staticKeys)||pn(!1),Jr(e.handlerKeys)||pn(!1),Jr(e.customHandlerKeys)||pn(!1)}It(Lu,"defaultOptions",{}),It(Lu,"staticKeys",[]),It(Lu,"handlerKeys",[]),It(Lu,"handlerKeyOptions",{}),It(Lu,"customHandlerKeys",[]);var ju=new WeakMap,Wu=new WeakMap;class Ku extends Lu{get priority(){var e,t;return null!==(e=null!==(t=Lt(this,ju))&&void 0!==t?t:this.options.priority)&&void 0!==e?e:this.constructor.defaultPriority}get constructorName(){return"".concat(Mr(this.name),"Extension")}get store(){return Lt(this,Wu)||pn(!1),Lt(this,Wu)}constructor(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];super({validator:Gu,defaultOptions:Zu,code:Qt.INVALID_EXTENSION},...t),ju.set(this,{writable:!0,value:void 0}),Wu.set(this,{writable:!0,value:void 0})}isOfType(e){return this.constructor===e}setStore(e){Lt(this,Wu)||Wi(this,Wu,e)}clone(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new this.constructor(...t)}setPriority(e){Wi(this,ju,e)}}It(Ku,"defaultPriority",Zt.Default);class Uu extends Ku{static get[tr](){return qt.PlainExtensionConstructor}get[tr](){return qt.PlainExtension}}class qu extends Ku{static get[tr](){return qt.MarkExtensionConstructor}get[tr](){return qt.MarkExtension}get type(){return this.store.schema.marks[this.name]}constructor(){super(...arguments)}}It(qu,"disableExtraAttributes",!1);class Ju extends Ku{static get[tr](){return qt.NodeExtensionConstructor}get[tr](){return qt.NodeExtension}get type(){return this.store.schema.nodes[this.name]}constructor(){super(...arguments)}}It(Ju,"disableExtraAttributes",!1);var Zu={priority:void 0,extraAttributes:{},disableExtraAttributes:!1,exclude:{}};function Gu(e){var t;Qt.INVALID_EXTENSION,Gr(t=e)&&Xr(t,[qt.PlainExtensionConstructor,qt.MarkExtensionConstructor,qt.NodeExtensionConstructor])||pn(!1),Fu(e)}function Xu(e){return Gr(e)&&Xr(e,qt.PlainExtension)}function Yu(e){return Gr(e)&&Xr(e,qt.NodeExtension)}function Qu(e){return Gr(e)&&Xr(e,qt.MarkExtension)}var eh=new WeakMap,th=new WeakMap;class rh extends Uu{constructor(){var e;super(...arguments),e=this,eh.set(this,{writable:!0,value:[]}),th.set(this,{writable:!0,value:Tr()}),It(this,"updateAttributes",(function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e.transformAttributes(),t&&e.store.commands.forceUpdate("attributes")}))}get name(){return"attributes"}onCreate(){this.transformAttributes(),this.store.setExtensionStore("updateAttributes",this.updateAttributes)}transformAttributes(){Wi(this,eh,[]),Wi(this,th,Tr());var e,t=Bt(this.store.extensions);try{for(t.s();!(e=t.n()).done;){var r,n,o=e.value;!o.createAttributes||(null===(r=this.store.managerSettings.exclude)||void 0===r?void 0:r.attributes)||(null===(n=o.options.exclude)||void 0===n?void 0:n.attributes)||Lt(this,eh).unshift(o.createAttributes())}}catch(c){t.e(c)}finally{t.f()}var i,a=Bt(Lt(this,eh));try{for(a.s();!(i=a.n()).done;){var s,l=i.value;Wi(this,th,zt(zt(zt({},Lt(this,th)),l),{},{class:(null!==(s=Lt(this,th).class)&&void 0!==s?s:"")+(Dr(l.class)?l.class:"")||""}))}}catch(c){a.e(c)}finally{a.f()}this.store.setStoreKey("attributes",Lt(this,th))}}function nh(e){return t=>{var r=e.defaultOptions,n=e.customHandlerKeys,o=e.handlerKeys,i=e.staticKeys,a=e.defaultPriority,s=e.handlerKeyOptions,l=$t(e,["defaultOptions","customHandlerKeys","handlerKeys","staticKeys","defaultPriority","handlerKeyOptions"]),c=t;r&&(c.defaultOptions=r),a&&(c.defaultPriority=a),s&&(c.handlerKeyOptions=s),c.staticKeys=null!=i?i:[],c.handlerKeys=null!=o?o:[],c.customHandlerKeys=null!=n?n:[];var u,h=Bt(Er(l));try{for(h.s();!(u=h.n()).done;){var d=Pt(u.value,2),p=d[0],f=d[1];c[p]||(c[p]=f)}}catch(v){h.e(v)}finally{h.f()}return c}}function oh(e){return t=>{var r=e.defaultOptions,n=e.customHandlerKeys,o=e.handlerKeys,i=e.staticKeys,a=t;return r&&(a.defaultOptions=r),a.staticKeys=null!=i?i:[],a.handlerKeys=null!=o?o:[],a.customHandlerKeys=null!=n?n:[],a}}var ih,ah,sh,lh=new WeakMap,ch=new WeakMap,uh=new WeakMap;class hh extends Lu{static get[tr](){return qt.PresetConstructor}get[tr](){return qt.Preset}get extensions(){return Lt(this,ch)}get constructorName(){return"".concat(Mr(this.name),"Preset")}get extensionStore(){return Lt(this,lh)||pn(!1),Lt(this,lh)}constructor(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];super({validator:ph,defaultOptions:{},code:Qt.INVALID_PRESET},...t),lh.set(this,{writable:!0,value:void 0}),ch.set(this,{writable:!0,value:void 0}),uh.set(this,{writable:!0,value:void 0}),Wi(this,ch,function(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=[],i=new Set,a=Hr(t)?t:an(t),s=Bt(n?[...e].reverse():e);try{for(s.s();!(r=s.n()).done;){var l=r.value,c=a(l);i.has(c)||(i.add(c),o.push(l))}}catch(u){s.e(u)}finally{s.f()}return n?o.reverse():o}(this.createExtensions(),(e=>e.constructor))),Wi(this,uh,new Map);var n,o=Bt(Lt(this,ch));try{for(o.s();!(n=o.n()).done;){var i=n.value;Lt(this,uh).set(i.constructor,i)}}catch(a){o.e(a)}finally{o.f()}}isOfType(e){return this.constructor===e}replaceExtension(e,t){Lt(this,uh).has(e)&&Lt(this,uh).set(e,t)}getExtension(e){var t=Lt(this,uh).get(e);return t||pn(!1),t}setExtensionStore(e){Lt(this,lh)||Wi(this,lh,e)}clone(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new this.constructor(...t)}}function dh(e){return Gr(e)&&Xr(e,qt.Preset)}function ph(e){var t;Qt.INVALID_PRESET,Gr(t=e)&&Xr(t,qt.PresetConstructor)||pn(!1),Fu(e)}function fh(e){return Hr(e)||Kr(e)}function vh(e){var t=e.immediate,r=e.promise,n=e.onDone,o=e.onFail;return e=>{var i=e.view;return!1!==(null==t?void 0:t(e))&&(!i||((Hr(r)?r():r).then((e=>{n({state:i.state,tr:i.state.tr,dispatch:i.dispatch,view:i,value:e})})).catch((()=>{null==o||o({state:i.state,tr:i.state.tr,dispatch:i.dispatch,view:i})})),!0))}}function mh(e){var t=e.type,r=e.attrs,n=e.range;return e=>{var o=e.dispatch,i=e.tr;return n?(Cc(zt({trState:i,type:t},n))?null==o||o(i.removeMark(n.from,n.to,t)):null==o||o(i.addMark(n.from,n.to,t.create(r))),!0):vn(function(e,t){return function(r,n){var o=r.selection,i=o.empty,a=o.$cursor,s=o.ranges;if(i&&!a||!function(e,t,r){for(var n=function(n){var o=t[n],i=o.$from,a=o.$to,s=0==i.depth&&e.type.allowsMarkType(r);if(e.nodesBetween(i.pos,a.pos,(function(e){if(s)return!1;s=e.inlineContent&&e.type.allowsMarkType(r)})),s)return{v:!0}},o=0;o<t.length;o++){var i=n(o);if(i)return i.v}return!1}(r.doc,s,e))return!1;if(n)if(a)e.isInSet(r.storedMarks||a.marks())?n(r.tr.removeStoredMark(e)):n(r.tr.addStoredMark(e.create(t)));else{for(var l=!1,c=r.tr,u=0;!l&&u<s.length;u++){var h=s[u],d=h.$from,p=h.$to;l=r.doc.rangeHasMark(d.pos,p.pos,e)}for(var f=0;f<s.length;f++){var v=s[f],m=v.$from,g=v.$to;if(l)c.removeMark(m.pos,g.pos,e);else{var y=m.pos,w=g.pos,b=m.nodeAfter,k=g.nodeBefore,x=b&&b.isText?/^\s*/.exec(b.text)[0].length:0,S=k&&k.isText?/\s*$/.exec(k.text)[0].length:0;y+x<w&&(y+=x,w-=S),c.addMark(y,w,e.create(t))}}n(c.scrollIntoView())}return!0}}(t,r))(e)}}function gh(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r=>{var n=r.tr,o=r.dispatch,i=r.state.schema,a=n.selection,s=t.from,l=void 0===s?a.from:s,c=t.to,u=void 0===c?null!=l?l:a.to:c,h=t.marks,d=void 0===h?{}:h;if(!o)return!0;n.insertText(e,l,u);var p,f=n.steps[n.steps.length-1].getMap().map(u),v=Bt(Er(d));try{for(v.s();!(p=v.n()).done;){var m=Pt(p.value,2),g=m[0],y=m[1];n.addMark(l,f,i.marks[g].create(y))}}catch(w){v.e(w)}finally{v.f()}return o(n),!0}}It(hh,"defaultOptions",{});var yh,wh,bh,kh,xh,Sh=nh({defaultPriority:Zt.Highest,defaultOptions:{trackerClassName:"remirror-tracker-position",trackerNodeName:"span"},staticKeys:["trackerClassName","trackerNodeName"]})((ah=new WeakMap,sh=new WeakMap,ih=class extends Uu{constructor(){var e;super(...arguments),e=this,ah.set(this,{writable:!0,value:void 0}),sh.set(this,{writable:!0,value:void 0}),It(this,"forceUpdate",(function(t){for(var r=e.getMeta(t),n=r.forcedUpdates,o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];return e.setMeta(t,{forcedUpdates:tn([...n,...i])}),t})),It(this,"getForcedUpdates",(e=>this.getMeta(e).forcedUpdates))}get name(){return"commands"}get transaction(){if(Lt(this,sh))return Lt(this,sh);var e=this.store.getState();Lt(this,ah)||Wi(this,ah,e.tr);var t=Lt(this,ah).before.eq(e.doc),r=!Zr(Lt(this,ah).steps);if(!t){var n=e.tr;if(r){var o,i=Bt(Lt(this,ah).steps);try{for(i.s();!(o=i.n()).done;){var a=o.value;n.step(a)}}catch(s){i.e(s)}finally{i.f()}}Wi(this,ah,n)}return Lt(this,ah)}onCreate(){var e=this.store,t=e.setExtensionStore,r=e.setStoreKey;t("forceUpdate",this.forceUpdate),r("getForcedUpdates",this.getForcedUpdates),t("getTransaction",(()=>this.transaction)),t("getCommandParameter",(()=>({tr:this.transaction,dispatch:this.store.view.dispatch,state:this.store.view.state,view:this.store.view})))}onView(e){var t,r=this.store,n=r.setStoreKey,o=r.setExtensionStore,i=Tr(),a=new Set,s=Tr(),l=Tr(),c=Tr(),u=Bt(this.store.extensions);try{for(u.s();!(t=u.n()).done;){var h=t.value;h.createCommands&&this.addCommands({names:a,chained:s,unchained:l,original:c,commands:h.createCommands()})}}catch(w){u.e(w)}finally{u.f()}var d,p=Bt(Er(l));try{for(p.s();!(d=p.n()).done;){var f=Pt(d.value,2),v=f[0],m=f[1],g=m.command,y=m.isEnabled;i[v]=g,i[v].isEnabled=y}}catch(w){p.e(w)}finally{p.f()}s.run=()=>e.dispatch(this.transaction),n("rawCommands",c),n("commands",i),n("chain",s),o("rawCommands",c),o("commands",i),o("chain",s)}onStateUpdate(e){var t=e.state;Wi(this,sh,void 0),Wi(this,ah,t.tr)}createHelpers(){return{findPositionTracker:(e,t)=>this.findPositionTracker(e,t),findAllPositionTrackers:e=>this.findAllPositionTrackers(e)}}createCommands(){var e=this,t={customDispatch:e=>e,custom:e=>()=>(Wi(this,sh,e),!0),restore:()=>()=>(Wi(this,sh,void 0),!0),insertText:function(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return fh(r)?vh({promise:r,immediate:t.addPositionTracker(zt({id:r},n)),onDone:n=>{var o=n.value,i=$t(n,["value"]),a=e.findPositionTracker(r);return e.removePositionTracker({id:r,tr:i.tr}),!!a&&t.insertText(o,a)(i)},onFail:t.removePositionTracker(r)}):gh(r,n)},selectText:e=>t=>{var r=t.tr,n=t.dispatch,o=Dc(e,r.doc);return null==n||n(r.setSelection(o)),!0},delete:e=>t=>{var r=t.tr,n=t.dispatch,o=null!=e?e:r.selection,i=o.from,a=o.to;return null==n||n(r.delete(i,a)),!0},emptyUpdate:()=>e=>{var t=e.tr,r=e.dispatch;return null==r||r(t),!0},forceUpdate:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return t=>{var n=t.tr,o=t.dispatch;return null==o||o(e.forceUpdate(n,...r)),!0}},updateNodeAttributes:(e,t)=>r=>{var n=r.tr,o=r.dispatch;return null==o||o(n.setNodeMarkup(e,void 0,t)),!0},emptySelection:()=>e=>{var t=e.tr,r=e.dispatch;return!t.selection.empty&&(null==r||r(t.setSelection(wi.create(t.doc,t.selection.anchor))),!0)},addPositionTracker:e=>t=>{var r=t.dispatch,n=t.tr;return!!this.addPositionTracker(zt(zt({},e),{},{tr:n,checkOnly:!r}))&&(null==r||r(n),!0)},removePositionTracker:e=>t=>{var r=t.dispatch,n=t.tr;return!!this.removePositionTracker({id:e,tr:n,checkOnly:!r})&&(null==r||r(n),!0)},clearPositionTrackers:()=>e=>{var t=e.tr,r=e.dispatch;return!!this.clearPositionTrackers({tr:t,checkOnly:!r})&&(null==r||r(t),!0)},setBlockNodeType:Yc,toggleWrappingNode:Xc,toggleBlockNodeItem:Qc,wrapInNode:Gc,removeMark:tu};return t}createPlugin(){var e=this;return{state:{init:()=>bl.empty,apply:(t,r)=>{r=r.map(t.mapping,t.doc);var n=this.getMeta(t),o=n.added,i=n.clearTrackers,a=n.removed;if(i)return bl.empty;var s,l=Bt(o);try{for(l.s();!(s=l.n()).done;){var c=s.value,u=c.className,h=c.nodeName,d=c.id,p=c.from,f=c.to,v=c.pos,m=c.node,g=void 0;if(Br(v)){var y=t.doc.resolve(v);if(!y.nodeAfter)continue;g=ml.node(v,v+y.nodeAfter.nodeSize,{nodeName:h,class:u},{id:d,type:this.name})}else if(m){var w=jc(t.doc.resolve(p));if(!w)continue;g=ml.node(w.pos,w.end,{nodeName:h,class:u},{id:d,type:this.name})}else if(p===f){document.createElement(h).classList.add(u),g=ml.widget(p,document.createElement(h),{id:d,type:this.name})}else g=ml.inline(p,f,{nodeName:h,class:u},{id:d,type:this.name});r=r.add(t.doc,[g])}}catch(S){l.e(S)}finally{l.f()}var b,k=Bt(a);try{var x=function(){var t=b.value,n=r.find(void 0,void 0,(r=>r.id===t&&r.type===e.name));r=r.remove(n)};for(k.s();!(b=k.n()).done;)x()}catch(S){k.e(S)}finally{k.f()}return r}},props:{decorations:e=>this.getPluginState(e)}}}getMeta(e){var t,r=null!==(t=e.getMeta(this.pluginKey))&&void 0!==t?t:{};return zt(zt({},Mh),r)}setMeta(e,t){var r=this.getMeta(e);e.setMeta(this.pluginKey,zt(zt({},r),t))}addCommands(e){var t,r=e.chained,n=e.commands,o=e.names,i=e.unchained,a=e.original,s=Bt(Er(n));try{for(s.s();!(t=s.n()).done;){var l=Pt(t.value,2),c=l[0],u=l[1];Vu({name:c,set:o,code:Qt.DUPLICATE_COMMAND_NAMES}),Ch.has(c)&&pn(!1),a[c]=u,i[c]={command:this.unchainedFactory({command:u}),isEnabled:this.unchainedFactory({command:u,shouldDispatch:!1})},r[c]=this.chainedFactory({command:u,chained:r})}}catch(h){s.e(h)}finally{s.f()}}unchainedFactory(e){var t=this;return function(){var r,n=e.shouldDispatch,o=void 0===n||n,i=e.command,a=t.store.view,s=a.state;return o&&(r=a.dispatch),i(...arguments)({state:s,dispatch:r,view:a,tr:t.transaction})}}chainedFactory(e){var t=this;return function(){var r=e.chained,n=e.command,o=t.store.view,i=o.state,a=e=>{e!==t.transaction&&pn(!1)};return n(...arguments)({state:i,dispatch:a,view:o,tr:t.transaction}),r}}addPositionTracker(e){var t=e.tr,r=e.checkOnly,n=void 0!==r&&r,o=e.id,i=$t(e,["tr","checkOnly","id"]);if(this.findPositionTracker(o))return!1;if(n)return!0;var a=this.getMeta(t).added,s=this.options,l=s.trackerClassName,c=s.trackerNodeName,u=i.from,h=i.to,d=i.className,p=i.nodeName,f=void 0===p?c:p,v=i.pos,m=void 0===v?null:v,g=i.node,y=void 0!==g&&g,w=(d?[l,d]:[l]).join(" ");return this.setMeta(t,{added:[...a,{id:o,nodeName:f,pos:m,node:y,from:Br(u)?u:t.selection.from,to:Br(h)?h:t.selection.to,className:w}]}),!0}removePositionTracker(e){var t=e.id,r=e.tr,n=e.checkOnly,o=void 0!==n&&n;if(!this.findPositionTracker(t))return!1;if(o)return!0;var i=this.getMeta(r).removed;return this.setMeta(r,{removed:tn([...i,t])}),!0}clearPositionTrackers(e){var t=e.tr,r=e.checkOnly,n=void 0!==r&&r;return this.getPluginState()!==bl.empty&&(n||this.setMeta(t,{clearTrackers:!0}),!0)}findPositionTracker(e,t){return this.findAllPositionTrackers(t).get(e)}findAllPositionTrackers(e){var t,r=new Map,n=Bt(this.getPluginState(e).find(void 0,void 0,(e=>e.type===this.name)));try{for(n.s();!(t=n.n()).done;){var o=t.value;r.set(o.spec.id,{from:o.from,to:o.to})}}catch(i){n.e(i)}finally{n.f()}return r}}))||ih,Mh={added:[],clearTrackers:!1,forcedUpdates:[],removed:[]},Ch=new Set(["run","chain","original","raw"]),Oh=nh({defaultPriority:Zt.High})(yh=class extends Uu{get name(){return"helpers"}onView(){var e,t=this,r=Tr(),n=Tr(),o=new Set,i=Bt(this.store.extensions);try{var a=function(){var i=e.value;if(Yu(i)&&(n[i.name]=e=>Kc({state:t.store.getState(),type:i.type,attrs:e})),Qu(i)&&(n[i.name]=()=>Cc({trState:t.store.getState(),type:i.type})),!i.createHelpers)return"continue";var a,s=Bt(Er(i.createHelpers()));try{for(s.s();!(a=s.n()).done;){var l=Pt(a.value,2),c=l[0],u=l[1];Vu({name:c,set:o,code:Qt.DUPLICATE_HELPER_NAMES}),r[c]=u}}catch(h){s.e(h)}finally{s.f()}};for(i.s();!(e=i.n()).done;)a()}catch(s){i.e(s)}finally{i.f()}this.store.setStoreKey("active",n),this.store.setStoreKey("helpers",r),this.store.setExtensionStore("helpers",r)}createHelpers(){return{isSelectionEmpty:()=>Wc(this.store.view.state)}}})||yh,Eh=nh({defaultPriority:Zt.High,handlerKeys:["shouldSkipInputRule"],handlerKeyOptions:{shouldSkipInputRule:{earlyReturnValue:!0}}})(wh=class extends Uu{constructor(){super(...arguments),It(this,"rebuildInputRules",(()=>{var e=this.inputRulesPlugin;this.loopExtensions(),this.store.replacePlugin(e,this.inputRulesPlugin),this.store.reconfigureStatePlugins()}))}get name(){return"inputRules"}onCreate(){this.store.setExtensionStore("rebuildInputRules",this.rebuildInputRules),this.loopExtensions(),this.store.addPlugins(this.inputRulesPlugin)}loopExtensions(){var e,t=[],r=this.store.markTags[Ut.ExcludeInputRules],n=Bt(this.store.extensions);try{for(n.s();!(e=n.n()).done;){var o,i,a=e.value;if(!(null===(o=this.store.managerSettings.exclude)||void 0===o?void 0:o.inputRules)&&a.createInputRules&&!(null===(i=a.options.exclude)||void 0===i?void 0:i.inputRules)){var s,l=Bt(a.createInputRules());try{for(l.s();!(s=l.n()).done;){var c=s.value;c.shouldSkip=this.options.shouldSkipInputRule,c.invalidMarks=r,t.push(c)}}catch(u){l.e(u)}finally{l.f()}}}}catch(u){n.e(u)}finally{n.f()}this.inputRulesPlugin=function(e){var t=e.rules,r=new zi({state:{init:function(){return null},apply:function(e,t){return e.getMeta(this)||(e.selectionSet||e.docChanged?null:t)}},props:{handleTextInput:function(e,n,o,i){return _i(e,n,o,i,t,r)},handleDOMEvents:{compositionend:function(e){setTimeout((function(){var n=e.state.selection.$cursor;n&&_i(e,n.pos,n.pos,"",t,r)}))}}},isInputRules:!0});return r}({rules:t})}})||wh,Ah=nh({defaultPriority:Zt.Low,defaultOptions:{undoInputRuleOnBackspace:!0,selectParentNodeOnEscape:!1,excludeBaseKeymap:!1,exitMarksOnArrowPress:!0},customHandlerKeys:["keymap"]})((kh=new WeakMap,bh=class extends Uu{constructor(){super(...arguments),kh.set(this,{writable:!0,value:[]}),It(this,"rebuildKeymap",(()=>{var e=this.keymap;this.loopExtensions(),this.store.replacePlugin(e,this.keymap),this.store.reconfigureStatePlugins()})),It(this,"onAddCustomHandler",(e=>{var t,r,n=e.keymap;if(n)return Wi(this,kh,[...Lt(this,kh),n]),null===(t=(r=this.store).rebuildKeymap)||void 0===t||t.call(r),()=>{var e,t;Wi(this,kh,Lt(this,kh).filter((e=>e!==n))),null===(e=(t=this.store).rebuildKeymap)||void 0===e||e.call(t)}}))}get name(){return"keymap"}onCreate(){this.store.setExtensionStore("rebuildKeymap",this.rebuildKeymap),this.loopExtensions(),this.store.addPlugins(this.keymap)}loopExtensions(){var e,t=[],r=Bt(this.store.extensions);try{for(r.s();!(e=r.n()).done;){var n,o,i=e.value;(null===(n=this.store.managerSettings.exclude)||void 0===n?void 0:n.keymap)||!i.createKeymap||(null===(o=i.options.exclude)||void 0===o?void 0:o.keymap)||t.push(i.createKeymap())}}catch(s){r.e(s)}finally{r.f()}var a=Jc(this.sortKeymaps([...Lt(this,kh),...t]));this.keymap=new zi({props:{handleKeyDown:Tu(a)}})}createKeymap(){var e=this.options,t=e.selectParentNodeOnEscape,r=e.undoInputRuleOnBackspace,n=e.excludeBaseKeymap,o=e.exitMarksOnArrowPress,i=Tr();if(!n){var a,s=Bt(Er(gu));try{for(s.s();!(a=s.n()).done;){var l=Pt(a.value,2),c=l[0],u=l[1];i[c]=vn(u)}}catch(h){s.e(h)}finally{s.f()}}return r&&(i.Backspace=vn(hu(Fi,gu.Backspace))),t&&(i.Escape=vn(cu)),o&&this.addExitMarkHandler(i),[Zt.Low,i]}addExitMarkHandler(e){var t=this.store.markTags[Ut.MarkSupportsExit];e.ArrowLeft=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return r=>{if(t&&Rh(r.tr))return Nh(e,!1)(r);var n=r.tr,o=r.dispatch,i=r.state;if(!Dh(n.selection))return!1;var a=n.selection.$from,s=new Set(e.map((e=>i.schema.marks[e]))),l=a.marks().filter((e=>s.has(e.type)));if(Zr(l))return!1;if(!o)return!0;var c,u=Bt(l);try{for(u.s();!(c=u.n()).done;){var h=c.value;n.removeStoredMark(h)}}catch(d){u.e(d)}finally{u.f()}return o(n),!0}}(t),e.ArrowRight=Nh(t)}onSetOptions(e){var t,r,n=e.changes,o=!1;((n.excludeBaseKeymap.changed||n.selectParentNodeOnEscape.changed||n.undoInputRuleOnBackspace.changed)&&(o=!0),o)&&(null===(t=this.store)||void 0===t||null===(r=t.rebuildKeymap)||void 0===r||r.call(t))}sortKeymaps(e){return nn(e.map((e=>Jr(e)?e:[Zt.Default,e])),((e,t)=>t[0]-e[0])).map((e=>e[1]))}}))||bh;function Nh(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return r=>{if(t&&Rh(r.tr))return Nh(e,!1)(r);var n=r.tr,o=r.dispatch,i=r.state;if(!Th(n.selection))return!1;var a=n.selection.$from,s=new Set(e.map((e=>i.schema.marks[e]))),l=a.marks().filter((e=>s.has(e.type)));if(Zr(l))return!1;if(!o)return!0;var c,u=Bt(l);try{for(u.s();!(c=u.n()).done;){var h=c.value;n.removeStoredMark(h)}}catch(d){u.e(d)}finally{u.f()}return o(n.insertText(" ",n.selection.from)),!0}}function Rh(e){return"rtl"===e.selection.$from.parent.attrs.dir}function Th(e){var t=e.$from;return e.empty&&xc(e)&&t.parent.type.isBlock&&t.after()===t.pos+1}function Dh(e){var t=e.$from;return e.empty&&xc(e)&&t.parent.type.isBlock&&t.before()===t.pos-1}class Ph extends Uu{get name(){return"nodeViews"}onCreate(){var e,t,r=[],n=Tr(),o=Bt(this.store.extensions);try{for(o.s();!(t=o.n()).done;){var i,a,s=t.value;if(!(null===(i=this.store.managerSettings.exclude)||void 0===i?void 0:i.nodeViews)&&s.createNodeViews&&!(null===(a=s.options.exclude)||void 0===a?void 0:a.nodeViews)){var l=s.createNodeViews();r.unshift(Hr(l)?{[s.name]:l}:l)}}}catch(d){o.e(d)}finally{o.f()}r.unshift(null!==(e=this.store.managerSettings.nodeViews)&&void 0!==e?e:{});for(var c=0,u=r;c<u.length;c++){var h=u[c];Object.assign(n,h)}this.store.setStoreKey("nodeViews",n)}}class Ih extends Uu{get name(){return"pasteRules"}onCreate(){var e,t=[],r=Bt(this.store.extensions);try{for(r.s();!(e=r.n()).done;){var n,o,i=e.value;(null===(n=this.store.managerSettings.exclude)||void 0===n?void 0:n.pasteRules)||!i.createPasteRules||(null===(o=i.options.exclude)||void 0===o?void 0:o.pasteRules)||t.push(...i.createPasteRules())}}catch(a){r.e(a)}finally{r.f()}this.store.addPlugins(...t)}}var Vh,zh,$h,Bh,Hh,Lh,_h=nh({defaultOptions:{persistentSelectionClass:"selection"},defaultPriority:Zt.Medium,staticKeys:["persistentSelectionClass"]})(xh=class extends Uu{get name(){return"persistentSelection"}createPlugin(){return{props:{decorations:e=>{var t=e.doc,r=e.selection;if(this.options.persistentSelectionClass&&!r.empty){var n={class:this.options.persistentSelectionClass},o=Mc(r)?ml.node(r.from,r.to,n):ml.inline(r.from,r.to,n);return bl.create(t,[o])}}}}}})||xh,Fh=nh({defaultPriority:Zt.Highest})((zh=new WeakMap,$h=new WeakMap,Vh=class extends Uu{constructor(){var e;super(...arguments),e=this,zh.set(this,{writable:!0,value:[]}),$h.set(this,{writable:!0,value:[]}),It(this,"pluginKeys",Tr()),It(this,"stateGetters",new Map),It(this,"getPluginStateCreator",(e=>t=>e.getState(null!=t?t:this.store.getState()))),It(this,"getStateByName",(e=>{var t=this.stateGetters.get(e);return t||pn(!1),t()})),It(this,"addPlugins",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];Wi(e,zh,[...Lt(e,zh),...r]),e.store.setStoreKey("plugins",Lt(e,zh))})),It(this,"replacePlugin",((e,t)=>{Wi(this,zh,Lt(this,zh).map((r=>r===e?t:r))),this.store.setStoreKey("plugins",Lt(this,zh))})),It(this,"updateExtensionPlugins",(e=>{this.extractExtensionPlugins(e),this.store.setStoreKey("plugins",Lt(this,zh))})),It(this,"reconfigureStatePlugins",(()=>{this.store.phase>=Xt.EditorView||pn(!1);var e=this.store,t=e.view;(0,e.updateState)(t.state.reconfigure({plugins:Lt(this,zh)}))}))}get name(){return"plugins"}onCreate(){var e=this.store,t=e.setStoreKey,r=e.setExtensionStore;this.updateExtensionStore();var n=this.store.managerSettings.plugins,o=void 0===n?[]:n;this.addOrReplacePlugins(o,Lt(this,$h));var i,a=Bt(this.store.extensions);try{for(a.s();!(i=a.n()).done;){var s=i.value;this.extractExtensionPlugins(s)}}catch(l){a.e(l)}finally{a.f()}Wi(this,$h,o),t("pluginKeys",this.pluginKeys),t("getPluginState",this.getStateByName),r("getPluginState",this.getStateByName)}extractExtensionPlugins(e){var t,r;if(!(!e.createPlugin&&!e.createExternalPlugins||(null===(t=this.store.managerSettings.exclude)||void 0===t?void 0:t.plugins)||(null===(r=e.options.exclude)||void 0===r?void 0:r.plugins))){if(e.createPlugin){var n=new Hi(e.name);this.pluginKeys[e.name]=n;var o=this.getPluginStateCreator(n);e.pluginKey=n,e.constructor.prototype.getPluginState=o,this.stateGetters.set(e.name,o),this.stateGetters.set(e.constructor,o);var i=zt(zt({},e.createPlugin()),{},{key:n}),a=new zi(i);this.addOrReplacePlugins([a],e.plugin?[e.plugin]:void 0),e.plugin=a}if(e.createExternalPlugins){var s=e.createExternalPlugins();this.addOrReplacePlugins(s,e.externalPlugins),e.externalPlugins=s}}}addOrReplacePlugins(e,t){if(t&&!Zr(t))if(e.length===t.length){for(var r=new Map,n=0,o=Object.entries(e);n<o.length;n++){var i=Pt(o[n],2),a=i[0],s=i[1];r.set(t[Number.parseInt(a,10)],s)}Wi(this,zh,Lt(this,zh).map((e=>t.includes(e)?r.get(e):e)))}else Wi(this,zh,[...Lt(this,zh).filter((e=>!t.includes(e))),...e]);else Wi(this,zh,[...Lt(this,zh),...e])}updateExtensionStore(){var e=this.store,t=e.setStoreKey,r=e.setExtensionStore;t("plugins",[]),r("addPlugins",this.addPlugins),r("replacePlugin",this.replacePlugin),r("addOrReplacePlugins",this.addOrReplacePlugins),r("updateExtensionPlugins",this.updateExtensionPlugins),r("reconfigureStatePlugins",this.reconfigureStatePlugins)}}))||Vh,jh=nh({defaultPriority:Zt.Highest})((Hh=new WeakMap,Bh=class extends Uu{constructor(){super(...arguments),Hh.set(this,{writable:!0,value:{marks:Tr(),nodes:Tr()}})}get name(){return"schema"}onCreate(){var e=this,t=this.store.managerSettings;if(t.schema){var r=function(e){var t=Er(e.nodes).map((e=>{var t=Pt(e,2);return[t[0],t[1].spec]})).reduce(((e,t)=>{var r=Pt(t,2),n=r[0],o=r[1];return zt(zt({},e),{},{[n]:o})}),{}),r=Er(e.marks).map((e=>{var t=Pt(e,2);return[t[0],t[1].spec]})).reduce(((e,t)=>{var r=Pt(t,2),n=r[0],o=r[1];return zt(zt({},e),{},{[n]:o})}),{});return{nodes:t,marks:r}}(t.schema),n=r.nodes,o=r.marks;this.addSchema(t.schema,n,o)}else{var i,a=Tr(),s=Tr(),l=function(e){var t,r=e.settings,n=e.gatheredSchemaAttributes,o=e.nodeNames,i=e.markNames,a=e.tags,s=Tr();if(r.disableExtraAttributes)return s;for(var l=[...n,...null!==(t=r.extraAttributes)&&void 0!==t?t:[]],c=0,u=null!=l?l:[];c<u.length;c++){var h,d=u[c],p=Bt(Wh({identifiers:d.identifiers,nodeNames:o,markNames:i,tags:a}));try{for(p.s();!(h=p.n()).done;){var f,v=h.value,m=null!==(f=s[v])&&void 0!==f?f:{};s[v]=zt(zt({},m),d.attributes)}}catch(g){p.e(g)}finally{p.f()}}return s}({settings:t,gatheredSchemaAttributes:this.gatherExtraAttributes(this.store.extensions),nodeNames:this.store.nodeNames,markNames:this.store.markNames,tags:this.store.tags}),c=Bt(this.store.extensions);try{var u=function(){var r=i.value;l[r.name]=zt(zt({},l[r.name]),r.options.extraAttributes);var n=!0===t.disableExtraAttributes||!0===r.options.disableExtraAttributes||!0===r.constructor.disableExtraAttributes;if(Yu(r)){var o,c=Kh({createExtensionSpec:e=>r.createNodeSpec(e),extraAttributes:l[r.name],ignoreExtraAttributes:n,name:r.constructorName,tags:null!==(o=r.tags)&&void 0!==o?o:[]}),u=c.spec,h=c.dynamic;r.spec=u,a[r.name]=u,Lt(e,Hh).nodes[r.name]=h}if(Qu(r)){var d,p=Kh({createExtensionSpec:e=>r.createMarkSpec(e),extraAttributes:l[r.name],ignoreExtraAttributes:n,name:r.constructorName,tags:null!==(d=r.tags)&&void 0!==d?d:[]}),f=p.spec,v=p.dynamic;r.spec=f,s[r.name]=f,Lt(e,Hh).marks[r.name]=v}};for(c.s();!(i=c.n()).done;)u()}catch(d){c.e(d)}finally{c.f()}var h=new wo({nodes:a,marks:s});this.addSchema(h,a,s)}}createPlugin(){return{appendTransaction:(e,t,r)=>{var n=r.tr;return e.some((e=>e.docChanged))?qr(Lt(this,Hh).nodes)||qr(Lt(this,Hh).marks)?null:(function(e){var t=e.node,r=e.predicate,n=e.descend,o=void 0===n||n,i=e.action;bc(t)||pn(!1),Hr(r)||pn(!1);var a=[];t.descendants(((e,t)=>{var n={node:e,pos:t};return r(n)?(a.push(n),null==i||i(n),o):o}))}({node:n.doc,predicate:()=>!0,action:e=>{this.checkAndUpdateDynamicNodes(e,n),this.checkAndUpdateDynamicMarks(e,n)}}),n.steps.length>0?n:null):null}}}addSchema(e,t,r){this.store.setStoreKey("nodes",t),this.store.setStoreKey("marks",r),this.store.setStoreKey("schema",e),this.store.setExtensionStore("schema",e)}checkAndUpdateDynamicNodes(e,t){var r,n=e.node,o=e.pos,i=Bt(Er(Lt(this,Hh).nodes));try{for(i.s();!(r=i.n()).done;){var a=Pt(r.value,2),s=a[0],l=a[1];if(n.type.name===s){var c,u=Bt(Er(l));try{for(u.s();!(c=u.n()).done;){var h=Pt(c.value,2),d=h[0],p=h[1];if(jr(n.attrs[d])){var f=zt(zt({},n.attrs),{},{[d]:p(n)});t.setNodeMarkup(o,void 0,f)}}}catch(v){u.e(v)}finally{u.f()}}}}catch(v){i.e(v)}finally{i.f()}}checkAndUpdateDynamicMarks(e,t){var r,n=this,o=e.node,i=e.pos,a=Bt(Er(Lt(this,Hh).marks));try{var s=function(){var e=Pt(r.value,2),a=e[0],s=e[1],l=n.store.schema.marks[a],c=o.marks.find((e=>e.type.name===a));if(!c)return"continue";var u,h=Bt(Er(s));try{for(h.s();!(u=h.n()).done;){var d=Pt(u.value,2),p=d[0],f=d[1];if(jr(c.attrs[p])){var v=Ec(t.doc.resolve(i),l);if(v){var m=v.from,g=v.to,y=l.create(zt(zt({},c.attrs),{},{[p]:f(c)}));t.removeMark(m,g,l).addMark(m,g,y)}}}}catch(w){h.e(w)}finally{h.f()}};for(a.s();!(r=a.n()).done;)s()}catch(l){a.e(l)}finally{a.f()}}gatherExtraAttributes(e){var t,r=[],n=Bt(e);try{for(n.s();!(t=n.n()).done;){var o=t.value;o.createSchemaAttributes&&r.push(...o.createSchemaAttributes())}}catch(i){n.e(i)}finally{n.f()}return r}}))||Bh;function Wh(e){var t,r=e.identifiers,n=e.nodeNames,o=e.markNames,i=e.tags;if("nodes"===r)return n;if("marks"===r)return o;if("all"===r)return[...n,...o];if(Jr(r))return r;_r(t=r)&&Jr(t.tags)||pn(!1);var a,s=new Set,l=Bt(r.tags);try{for(l.s();!(a=l.n()).done;){i[a.value].forEach((e=>s.add(e)))}}catch(u){l.e(u)}finally{l.f()}var c="mark"===r.type?o:"node"===r.type?n:[...o,...n];return[...s].filter((e=>c.includes(e)))}function Kh(e){var t,r,n=e.createExtensionSpec,o=e.extraAttributes,i=e.ignoreExtraAttributes;e.name;var a=e.tags,s=Tr();var l=!1;var c=n({defaults:function(e,t,r,n){return()=>{r();var o=Tr();if(t)return o;var i,a=Bt(Er(e));try{for(a.s();!(i=a.n()).done;){var s=Pt(i.value,2),l=s[0],c=Uh(s[1]).default;Hr(c)&&(n(l,c),c=null),o[l]=void 0===c?{}:{default:c}}}catch(u){a.e(u)}finally{a.f()}return o}}(o,i,(function(){l=!0}),(function(e,t){s[e]=t})),parse:function(e,t){return r=>{var n=Tr();if(t)return n;var o,i=Bt(Er(e));try{for(i.s();!(o=i.n()).done;){var a,s,l,c=Pt(o.value,2),u=c[0],h=Uh(c[1]),d=h.parseDOM,p=$t(h,["parseDOM"]);if(Tc(r))if(jr(d))n[u]=null!==(s=r.getAttribute(u))&&void 0!==s?s:p.default;else if(Hr(d))n[u]=null!==(l=d(r))&&void 0!==l?l:p.default;else n[u]=null!==(a=r.getAttribute(d))&&void 0!==a?a:p.default}}catch(f){i.e(f)}finally{i.f()}return n}}(o,i),dom:function(e,t){return r=>{var n=Tr();if(t)return n;function o(e,t){if($r(e)&&(n[t]=e),Jr(e)){var o=Pt(e,2),i=o[0],a=o[1];n[i]=null!=a?a:r.attrs[t]}}var i,a=Bt(Er(e));try{for(a.s();!(i=a.n()).done;){var s=Pt(i.value,2),l=s[0],c=Uh(s[1]),u=c.toDOM,h=c.parseDOM;if(jr(u)){var d=$r(h)?h:l;n[d]=r.attrs[l]}else Hr(u)?o(u(r.attrs,qh(r)),l):o(u,l)}}catch(p){a.e(p)}finally{a.f()}return n}}(o,i)});return i||l||pn(!1),c.group=[...null!==(t=null===(r=c.group)||void 0===r?void 0:r.split(" "))&&void 0!==t?t:[],...a].join(" ")||void 0,{spec:c,dynamic:s}}function Uh(e){return $r(e)||Hr(e)?{default:e}:(e||pn(!1),e)}function qh(e){return bc(e)?{node:e}:Wr(t=e)&&t instanceof On?{mark:e}:{};var t}var Jh,Zh,Gh,Xh,Yh,Qh,ed=nh({customHandlerKeys:["suggester"]})(Lh=class extends Uu{constructor(){super(...arguments),It(this,"onAddCustomHandler",(e=>{var t=e.suggester;if(t)return yc(this.store.getState(),t)}))}get name(){return"suggest"}onCreate(){var e=[];this.store.setExtensionStore("addSuggester",(e=>yc(this.store.getState(),e))),this.store.setExtensionStore("removeSuggester",(e=>function(e,t){return gc(e).removeSuggester(t)}(this.store.getState(),e)));var t,r=Bt(this.store.extensions);try{for(r.s();!(t=r.n()).done;){var n,o,i=t.value;if(!(null===(n=this.store.managerSettings.exclude)||void 0===n?void 0:n.suggesters)&&i.createSuggesters&&!(null===(o=i.options.exclude)||void 0===o?void 0:o.suggesters)){var a=i.createSuggesters(),s=Jr(a)?a:[a];e.push(...s)}}}catch(l){r.e(l)}finally{r.f()}this.store.addPlugins(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=fc.create(t);return new zi({key:mc,view:e=>(n.init(e),{update:e=>n.changeHandler(e.state.tr,!1)}),state:{init:()=>n,apply:(e,t,r,o)=>n.apply({tr:e,state:o})},appendTransaction:(e,t,r)=>{var o=r.tr;return n.updateWithNextSelection(o),n.changeHandler(o,!0),o.docChanged||o.steps.length>0||o.selectionSet||o.storedMarksSet?(n.setLastChangeFromAppend(),o):null},props:{decorations:e=>n.createDecorations(e)}})}(...e))}createHelpers(){return{getSuggestState:()=>this.getState(),getSuggestMethods:()=>{var e=this.getState();return{addIgnored:e.addIgnored,clearIgnored:e.clearIgnored,removeIgnored:e.removeIgnored,ignoreNextExit:e.ignoreNextExit,setMarkRemoved:e.setMarkRemoved,findMatchAtPosition:e.findMatchAtPosition,findNextTextSelection:e.findNextTextSelection}},isSuggesterActive:e=>{var t;return Rr(Jr(e)?e:[e],null===(t=this.getState().match)||void 0===t?void 0:t.suggester.name)}}}getState(){return gc(this.store.getState())}})||Lh,td=nh({defaultPriority:Zt.Highest})((Zh=new WeakMap,Gh=new WeakMap,Xh=new WeakMap,Yh=new WeakMap,Jh=class extends Uu{constructor(){super(...arguments),Zh.set(this,{writable:!0,value:Tr()}),Gh.set(this,{writable:!0,value:Tr()}),Xh.set(this,{writable:!0,value:Tr()}),Yh.set(this,{writable:!0,value:Tr()})}get name(){return"tags"}onCreate(){this.resetTags();var e,t=Bt(this.store.extensions);try{for(t.s();!(e=t.n()).done;){var r=e.value;this.updateTagForExtension(r)}}catch(n){t.e(n)}finally{t.f()}this.store.setStoreKey("tags",Lt(this,Zh)),this.store.setExtensionStore("tags",Lt(this,Zh)),this.store.setStoreKey("plainTags",Lt(this,Gh)),this.store.setExtensionStore("plainTags",Lt(this,Gh)),this.store.setStoreKey("markTags",Lt(this,Xh)),this.store.setExtensionStore("markTags",Lt(this,Xh)),this.store.setStoreKey("nodeTags",Lt(this,Yh)),this.store.setExtensionStore("nodeTags",Lt(this,Yh))}resetTags(){var e,t=Tr(),r=Tr(),n=Tr(),o=Tr(),i=Bt(Nr(Ut));try{for(i.s();!(e=i.n()).done;){var a=e.value;t[a]=[],r[a]=[],n[a]=[],o[a]=[]}}catch(s){i.e(s)}finally{i.f()}Wi(this,Zh,t),Wi(this,Gh,r),Wi(this,Xh,n),Wi(this,Yh,o)}updateTagForExtension(e){var t,r,n,o,i;if(e.tags&&!(null===(t=this.store.managerSettings.exclude)||void 0===t?void 0:t.tags)&&!(null===(r=e.options.exclude)||void 0===r?void 0:r.tags))for(var a,s=0,l=[...e.tags,...null!==(n=e.options.extraTags)&&void 0!==n?n:[],...null!==(o=null===(i=this.store.managerSettings.extraTags)||void 0===i?void 0:i[e.name])&&void 0!==o?o:[]];s<l.length;s++){var c=l[s];a=c,Rr(Nr(Ut),a)||pn(!1),Lt(this,Zh)[c].push(e.name),Xu(e)&&Lt(this,Gh)[c].push(e.name),Qu(e)&&Lt(this,Xh)[c].push(e.name),Yu(e)&&Lt(this,Yh)[c].push(e.name)}}}))||Jh;var rd=oh({defaultOptions:{exitMarksOnArrowPress:Ah.defaultOptions.exitMarksOnArrowPress,excludeBaseKeymap:Ah.defaultOptions.excludeBaseKeymap,selectParentNodeOnEscape:Ah.defaultOptions.selectParentNodeOnEscape,undoInputRuleOnBackspace:Ah.defaultOptions.undoInputRuleOnBackspace,persistentSelectionClass:_h.defaultOptions.persistentSelectionClass},staticKeys:["persistentSelectionClass"],customHandlerKeys:["keymap","suggester"],handlerKeys:["shouldSkipInputRule"],handlerKeyOptions:{shouldSkipInputRule:{earlyReturnValue:!0}}})(Qh=class extends hh{constructor(){super(...arguments),It(this,"onAddCustomHandler",(e=>{var t=e.suggester,r=e.keymap;return t?this.getExtension(ed).addCustomHandler("suggester",t):r?this.getExtension(Ah).addCustomHandler("keymap",r):rn}))}get name(){return"builtin"}onSetOptions(e){var t=(0,e.pickChanged)(["selectParentNodeOnEscape","excludeBaseKeymap","undoInputRuleOnBackspace"]);qr(t)||this.getExtension(Ah).setOptions(t)}createExtensions(){var e=wr(this.options,["excludeBaseKeymap","selectParentNodeOnEscape","undoInputRuleOnBackspace"]),t=wr(this.options,["persistentSelectionClass"]),r=new Eh;return r.addHandler("shouldSkipInputRule",this.options.shouldSkipInputRule),[new td,new jh,new rh,new Fh,r,new Ih,new Ph,new ed,new Sh,new Oh,new Ah(e),new _h(t)]}})||Qh,nd=new WeakMap,od=new WeakMap,id=new WeakMap,ad=new WeakMap,sd=new WeakMap,ld=new WeakMap;var cd=Symbol("privacy");function ud(e){var t,r=e.extension,n=e.found,o=e.missing;if(r.requiredExtensions){var i,a=Bt(null!==(t=r.requiredExtensions)&&void 0!==t?t:[]);try{for(a.s();!(i=a.n()).done;){var s=i.value;n.has(s)||o.push({Constructor:s,extension:r})}}catch(l){a.e(l)}finally{a.f()}}}function hd(e){var t=e.duplicateMap,r=e.extension,n=e.preset,o=r.constructor,i=t.get(o),a=n?[n]:[];t.set(o,i?[...i,...a]:a)}function dd(e){var t,r,n,o,i=e.extension,a=e.nodeNames,s=e.markNames,l=e.plainNames,c=e.store,u=e.handlers;i.setStore(c);var h=null===(t=i.onCreate)||void 0===t?void 0:t.bind(i),d=null===(r=i.onView)||void 0===r?void 0:r.bind(i),p=null===(n=i.onStateUpdate)||void 0===n?void 0:n.bind(i),f=null===(o=i.onDestroy)||void 0===o?void 0:o.bind(i);h&&u.create.push(h),d&&u.view.push(d),p&&u.update.push(p),f&&u.destroy.push(f),Qu(i)&&s.push(i.name),Yu(i)&&"doc"!==i.name&&a.push(i.name),Xu(i)&&l.push(i.name)}var pd=new WeakMap,fd=new WeakMap,vd=new WeakMap,md=new WeakMap,gd=new WeakMap,yd=new WeakMap,wd=new WeakMap,bd=new WeakMap,kd=new WeakMap,xd=new WeakMap,Sd=new WeakMap,Md=new WeakMap,Cd=new WeakMap,Od=new WeakMap;class Ed{static create(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Ed([...cn(e),new rd(t.builtin)],zt(zt({},t),{},{privacy:cd}))}static fromObject(e){var t=e.extensions,r=e.presets,n=e.settings,o=void 0===n?{}:n;return Ed.create([...t,...r],o)}get[tr](){return qt.Manager}get destroyed(){return Lt(this,wd)===Xt.Destroy}get mounted(){return Lt(this,wd)>=Xt.EditorView&&Lt(this,wd)<Xt.Destroy}get output(){var e;return Lt(this,Cd)||pn(!1),null===(e=Lt(this,Cd))||void 0===e?void 0:e.frameworkOutput}get frameworkAttached(){return!!Lt(this,Cd)}get extensions(){return Lt(this,fd)}get presets(){return Lt(this,md)}get combined(){return Lt(this,kd)}get store(){return Lt(this,yd)}get extensionStore(){return Lt(this,pd)}get tr(){return this.extensionStore.getTransaction()}get nodes(){return Lt(this,yd).nodes}get marks(){return Lt(this,yd).marks}get schema(){return Lt(this,yd).schema}get extensionTags(){return Lt(this,yd).tags}get view(){return Lt(this,yd).view}get settings(){return Lt(this,bd)}constructor(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.privacy,n=$t(t,["privacy"]);pd.set(this,{writable:!0,value:void 0}),fd.set(this,{writable:!0,value:void 0}),vd.set(this,{writable:!0,value:void 0}),md.set(this,{writable:!0,value:void 0}),gd.set(this,{writable:!0,value:void 0}),yd.set(this,{writable:!0,value:Tr()}),wd.set(this,{writable:!0,value:Xt.None}),bd.set(this,{writable:!0,value:void 0}),kd.set(this,{writable:!0,value:void 0}),xd.set(this,{writable:!0,value:!0}),Sd.set(this,{writable:!0,value:{create:[],view:[],update:[],destroy:[],disposers:[]}}),Md.set(this,{writable:!0,value:_t()}),Cd.set(this,{writable:!0,value:void 0}),Od.set(this,{writable:!0,value:void 0}),It(this,"setStoreKey",((e,t)=>{Lt(this,yd)[e]=t})),It(this,"getStoreKey",(e=>{var t=Lt(this,yd)[e];return jr(t)&&pn(!1),t})),It(this,"setExtensionStore",((e,t)=>{Lt(this,wd)<=Xt.EditorView||pn(!1),Lt(this,pd)[e]=t})),It(this,"getState",(()=>{var e;return Lt(this,wd)>=Xt.EditorView?this.view.state:(Lt(this,Cd)||pn(!1),null===(e=Lt(this,Cd))||void 0===e?void 0:e.initialEditorState)})),It(this,"updateState",(e=>{var t=this.getState();this.view.updateState(e),this.onStateUpdate({previousState:t,state:e})})),Wi(this,bd,n),Wi(this,kd,e),r!==cd&&pn(!1);var o=function(e,t){var r,n,o=[],i=new WeakMap,a=[],s=new WeakMap,l=new WeakMap,c=[],u=Bt(e);try{for(u.s();!(r=u.n()).done;){var h,d=r.value;if(Gr(n=d)&&Xr(n,[qt.PlainExtension,qt.MarkExtension,qt.NodeExtension]))d.setPriority(null===(h=t.priority)||void 0===h?void 0:h[d.name]),c.push(d),hd({duplicateMap:l,extension:d});else if(dh(d)){o.push(d),i.set(d.constructor,d);var p,f=Bt(d.extensions);try{for(f.s();!(p=f.n()).done;){var v,m=p.value;m.setPriority(null===(v=t.priority)||void 0===v?void 0:v[m.name]),hd({duplicateMap:l,extension:m,preset:d}),c.push(m)}}catch(C){f.e(C)}finally{f.f()}}else pn(!1)}}catch(C){u.e(C)}finally{u.f()}c=nn(c,((e,t)=>t.priority-e.priority));var g,y=new WeakSet,w=new Set,b=Bt(c);try{var k=function(){var e=g.value,t=e.constructor,r=e.name,n=l.get(t);if(n||pn(!1),y.has(t)||w.has(r))return"continue";y.add(t),w.add(r),a.push(e),s.set(t,e),n.forEach((r=>null==r?void 0:r.replaceExtension(t,e)))};for(b.s();!(g=b.n()).done;)k()}catch(C){b.e(C)}finally{b.f()}for(var x=[],S=0,M=a;S<M.length;S++)ud({extension:M[S],found:y,missing:x});return Zr(x)||pn(!1),{extensions:a,extensionMap:s,presets:o,presetMap:i}}(e,n),i=o.extensions,a=o.extensionMap,s=o.presets,l=o.presetMap;Wi(this,fd,i),Wi(this,vd,a),Wi(this,md,s),Wi(this,gd,l),Wi(this,pd,this.createExtensionStore()),this.setupLifecycleHandlers(),Wi(this,wd,Xt.Create);var c,u=Bt(Lt(this,Sd).create);try{for(u.s();!(c=u.n()).done;){var h=(0,c.value)();Lt(this,Sd).disposers.push(...h?[h]:[])}}catch(d){u.e(d)}finally{u.f()}}setupLifecycleHandlers(){var e,t=Lt(this,pd),r=Lt(this,Sd),n=Bt(Lt(this,md));try{for(n.s();!(e=n.n()).done;){e.value.setExtensionStore(t)}}catch(c){n.e(c)}finally{n.f()}var o=[],i=[],a=[];t.nodeNames=o,t.markNames=i,t.plainNames=a;var s,l=Bt(Lt(this,fd));try{for(l.s();!(s=l.n()).done;){dd({extension:s.value,nodeNames:o,markNames:i,plainNames:a,handlers:r,store:t})}}catch(c){l.e(c)}finally{l.f()}}createExtensionStore(){var e,t=Tr(),r=!0;return Object.defineProperties(t,{extensions:{get:()=>Lt(this,fd),enumerable:r},phase:{get:()=>Lt(this,wd),enumerable:r},view:{get:()=>this.view,enumerable:r},managerSettings:{get:()=>Lt(this,bd),enumerable:r},getState:{value:this.getState,enumerable:r},updateState:{value:this.updateState,enumerable:r},isMounted:{value:()=>this.mounted,enumerable:r},getExtension:{value:this.getExtension.bind(this),enumerable:r},getPreset:{value:this.getPreset.bind(this),enumerable:r},currentState:{get:()=>{var t;return null!==(t=e)&&void 0!==t?t:e=this.getState()},set:t=>{e=t},enumerable:r}}),t.getStoreKey=this.getStoreKey,t.setStoreKey=this.setStoreKey,t.setExtensionStore=this.setExtensionStore,t}addView(e){if(Lt(this,wd)>=Xt.EditorView)return this;Wi(this,xd,!0),Wi(this,wd,Xt.EditorView),Lt(this,yd).view=e;var t,r=Bt(Lt(this,Sd).view);try{for(r.s();!(t=r.n()).done;){var n=(0,t.value)(e);Lt(this,Sd).disposers.push(...n?[n]:[])}}catch(o){r.e(o)}finally{r.f()}return this}attachFramework(e,t){if(Lt(this,Cd)!==e){var r;if(Lt(this,Cd))Lt(this,Cd).destroy(),null===(r=Lt(this,Od))||void 0===r||r.call(this);Wi(this,Cd,e),Wi(this,Od,this.addHandler("stateUpdate",t))}}createEmptyDoc(){var e=this.schema.nodes.doc.createAndFill();return e||pn(!1),e}createState(e){var t=e.content,r=e.document,n=e.stringHandler,o=void 0===n?this.settings.stringHandler:n,i=e.onError,a=void 0===i?this.settings.onError:i,s=e.selection,l=this.store,c=l.schema,u=l.plugins,h=Pc({content:t,document:r,schema:c,stringHandler:o,onError:a,selection:s}),d=Di.create({schema:c,doc:h,plugins:u});if(!s)return d;var p=d.tr.setSelection(Dc(s,d.doc));return d.applyTransaction(p).state}addHandler(e,t){return Lt(this,Md).on(e,t)}onStateUpdate(e){var t=Lt(this,xd);Lt(this,pd).currentState=e.state,Lt(this,pd).previousState=e.previousState,Lt(this,xd)&&(Wi(this,wd,Xt.Runtime),Wi(this,xd,!1));var r,n=zt(zt({},e),{},{firstUpdate:t}),o=Bt(Lt(this,Sd).update);try{for(o.s();!(r=o.n()).done;){(0,r.value)(n)}}catch(i){o.e(i)}finally{o.f()}Lt(this,Md).emit("stateUpdate",n)}getExtension(e){var t=Lt(this,vd).get(e);return t||pn(!1),t}getPreset(e){var t=Lt(this,gd).get(e);return t||pn(!1),t}clone(){var e=Lt(this,kd).map((e=>e.clone(e.options)));return Ed.create(e,Lt(this,bd))}recreate(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=Lt(this,kd).map((e=>e.clone(e.initialOptions)));return Ed.create([...r,...e],t)}destroy(){var e,t,r,n,o;Wi(this,wd,Xt.Destroy);var i,a=Bt(null!==(n=null===(o=this.view)||void 0===o?void 0:o.state.plugins)&&void 0!==n?n:[]);try{for(a.s();!(i=a.n()).done;){var s,l;null===(s=i.value.getState(this.view.state))||void 0===s||null===(l=s.destroy)||void 0===l||l.call(s)}}catch(p){a.e(p)}finally{a.f()}null===(e=Lt(this,Cd))||void 0===e||e.destroy(),null===(t=Lt(this,Od))||void 0===t||t.call(this);var c,u=Bt(Lt(this,Sd).disposers);try{for(u.s();!(c=u.n()).done;){(0,c.value)()}}catch(p){u.e(p)}finally{u.f()}var h,d=Bt(Lt(this,Sd).destroy);try{for(d.s();!(h=d.n()).done;){(0,h.value)()}}catch(p){d.e(p)}finally{d.f()}null===(r=this.view)||void 0===r||r.destroy(),Lt(this,Md).emit("destroy")}includes(e){var t,r=[],n=[],o=Bt(this.combined);try{for(o.s();!(t=o.n()).done;){var i=t.value;r.push(i.name,i.constructorName),n.push(i.constructor)}}catch(a){o.e(a)}finally{o.f()}return e.every((e=>$r(e)?Rr(r,e):Rr(n,e)))}}function Ad(e,t){return!(!Gr(e)||!Xr(e,qt.Manager))&&(!t||e.includes(t))}var Nd=new WeakMap;class Rd{constructor(){It(this,"portals",new Map),Nd.set(this,{writable:!0,value:_t()}),It(this,"on",(e=>Lt(this,Nd).on("update",e))),It(this,"once",(e=>{var t=Lt(this,Nd).on("update",(r=>{t(),e(r)}));return t}))}update(){Lt(this,Nd).emit("update",this.portals)}render(e){var t=e.Component,r=e.container,n=this.portals.get(r),o=n?n.key:en();this.portals.set(r,{Component:t,key:o}),this.update()}forceUpdate(){var e,t=Bt(this.portals);try{for(t.s();!(e=t.n()).done;){var r=Pt(e.value,2),n=r[0],o=r[1].Component;this.portals.set(n,{Component:o,key:en()})}}catch(i){t.e(i)}finally{t.f()}}remove(e){this.portals.delete(e),this.update()}}var Td=t=>{var n=t.context,o=t.portals;return e.createElement(Id.Provider,{value:n},o.map((t=>{var n=Pt(t,2),o=n[0],i=n[1],a=i.Component;return i.key,r(e.createElement(a,null),o)})))};var Dd,Pd,Id=i(null),Vd=new WeakMap,zd=new WeakMap,$d=new WeakMap,Bd=new WeakMap,Hd=new WeakMap,Ld=new WeakMap,_d=new WeakMap,Fd=new WeakMap,jd=new WeakMap,Wd=new WeakMap,Kd=new WeakMap,Ud=new WeakMap;class qd{static create(e){var t=e.portalContainer,r=e.ReactComponent,n=e.options;return(e,o,i)=>new qd({options:n,node:e,view:o,getPosition:i,portalContainer:t,ReactComponent:r})}get selected(){return Lt(this,Fd)}get contentDOM(){return Lt(this,jd)}get dom(){return Lt(this,Kd)}constructor(t){var r,n=t.getPosition,o=t.node,i=t.portalContainer,a=t.view,s=t.ReactComponent,l=t.options;Vd.set(this,{writable:!0,value:void 0}),zd.set(this,{writable:!0,value:[]}),$d.set(this,{writable:!0,value:void 0}),Bd.set(this,{writable:!0,value:void 0}),Hd.set(this,{writable:!0,value:void 0}),Ld.set(this,{writable:!0,value:void 0}),_d.set(this,{writable:!0,value:void 0}),Fd.set(this,{writable:!0,value:!1}),jd.set(this,{writable:!0,value:void 0}),Wd.set(this,{writable:!0,value:void 0}),Kd.set(this,{writable:!0,value:void 0}),Ud.set(this,{writable:!0,value:e=>{e&&(Lt(this,Wd)||pn(!1),e.append(Lt(this,Wd)))}}),It(this,"Component",(()=>{var t=Lt(this,Hd);return t||pn(!1),e.createElement(t,{environment:"dom",updateAttributes:this.updateAttributes,selected:this.selected,view:Lt(this,$d),getPosition:Lt(this,Ld),node:Lt(this,Vd),forwardRef:Lt(this,Ud),decorations:Lt(this,zd)})})),It(this,"updateAttributes",(e=>{if(Lt(this,$d).editable){var t=Lt(this,$d).state.tr.setNodeMarkup(Lt(this,Ld).call(this),void 0,zt(zt({},Lt(this,Vd).attrs),e));Lt(this,$d).dispatch(t)}})),Hr(n)||pn(!1),Wi(this,Vd,o),Wi(this,$d,a),Wi(this,Bd,i),Wi(this,Hd,s),Wi(this,Ld,n),Wi(this,_d,l),Wi(this,Kd,this.createDom());var c=null!==(r=this.createContentDom())&&void 0!==r?r:{},u=c.contentDOM,h=c.wrapper;Wi(this,jd,null!=u?u:void 0),Wi(this,Wd,h),Lt(this,Wd)&&Lt(this,Kd).append(Lt(this,Wd)),this.setDomAttributes(Lt(this,Vd),Lt(this,Kd)),this.Component.displayName=Mr("".concat(Lt(this,Vd).type.name,"NodeView")),this.renderComponent()}renderComponent(){Lt(this,Bd).render({Component:this.Component,container:Lt(this,Kd)})}createDom(){var e=Lt(this,_d),t=e.defaultBlockNode,r=e.defaultInlineNode,n=Lt(this,Vd).isInline?document.createElement(r):document.createElement(t);return n.classList.add("".concat(Cr(Lt(this,Vd).type.name),"-node-view-wrapper")),n}createContentDom(){var e,t;if(!Lt(this,Vd).isLeaf){var r=null===(e=(t=Lt(this,Vd).type.spec).toDOM)||void 0===e?void 0:e.call(t,Lt(this,Vd));if(r){var n,o=Do.renderSpec(document,r),i=o.contentDOM,a=o.dom;if(Tc(a))return n=a,a===i&&((n=document.createElement("span")).classList.add("".concat(Cr(Lt(this,Vd).type.name),"-node-view-content-wrapper")),n.append(i)),Tc(i),{wrapper:n,contentDOM:i}}}}update(e,t){return!!_c({types:Lt(this,Vd).type,node:e})&&(Lt(this,Vd)===e&&Lt(this,zd)===t||(Lt(this,Vd).sameMarkup(e)||this.setDomAttributes(e,Lt(this,Kd)),Wi(this,Vd,e),Wi(this,zd,t),this.renderComponent()),!0)}setDomAttributes(e,t){var r=Lt(this,Vd).type.spec.toDOM,n=e.attrs;if(r){var o=r(e);if($r(o)||Rc(o))return;_r(o[1])&&(n=o[1])}var i,a=Bt(Er(n));try{for(a.s();!(i=a.n()).done;){var s=Pt(i.value,2),l=s[0],c=s[1];t.setAttribute(l,c)}}catch(u){a.e(u)}finally{a.f()}}selectNode(){Wi(this,Fd,!0),Lt(this,Kd)&&Lt(this,Kd).classList.add("ProseMirror-selectednode"),this.renderComponent()}deselectNode(){Wi(this,Fd,!1),Lt(this,Kd)&&Lt(this,Kd).classList.remove("ProseMirror-selectednode"),this.renderComponent()}destroy(){Lt(this,Bd).remove(Lt(this,Kd))}ignoreMutation(e){return"selection"!==e.type&&(!Lt(this,Wd)||!Lt(this,Wd).contains(e.target))}}var Jd,Zd,Gd=nh({defaultOptions:{defaultBlockNode:"div",defaultInlineNode:"span",defaultContentNode:"span",defaultEnvironment:"both",nodeViewComponents:{}},staticKeys:["defaultEnvironment"]})((Pd=new WeakMap,Dd=class extends Uu{constructor(){super(...arguments),Pd.set(this,{writable:!0,value:new Rd})}get name(){return"reactComponent"}onCreate(){this.store.setStoreKey("portalContainer",Lt(this,Pd))}createNodeViews(){var e,t,r=Tr(),n=null!==(e=this.store.managerSettings.nodeViewComponents)&&void 0!==e?e:{},o=Bt(this.store.extensions);try{for(o.s();!(t=o.n()).done;){var i=t.value;i.ReactComponent&&Yu(i)&&"ssr"!==i.reactComponentEnvironment&&(r[i.name]=qd.create({options:this.options,ReactComponent:i.ReactComponent,portalContainer:Lt(this,Pd)}))}}catch(h){o.e(h)}finally{o.f()}var a,s=Bt(Er(zt(zt({},this.options.nodeViewComponents),n)));try{for(s.s();!(a=s.n()).done;){var l=Pt(a.value,2),c=l[0],u=l[1];r[c]=qd.create({options:this.options,ReactComponent:u,portalContainer:Lt(this,Pd)})}}catch(h){s.e(h)}finally{s.f()}return r}}))||Dd;function Xd(e){return Wr(e)&&s(e)}function Yd(e){return Xd(e)?e.props:{}}(Zd=Jd||(Jd={})).SSR="ssr",Zd.Editor="editor",Zd.Provider="provider",Zd.I18nProvider="i18n-provider",Zd.ThemeProvider="theme-provider";function Qd(e,t){return Xd(e)?l(e,zt(zt({},e.props),{},{key:t})):e}Jd.Provider;var ep=x(u),tp={},rp={};Object.defineProperty(rp,"__esModule",{value:!0});var np=rp.useFirstMountState=void 0,op=ep;np=rp.useFirstMountState=function(){var e=op.useRef(!0);return e.current?(e.current=!1,!0):e.current},Object.defineProperty(tp,"__esModule",{value:!0});var ip,ap,sp=ep,lp=rp,cp=tp.default=function(e,t){var r=lp.useFirstMountState();sp.useEffect((function(){if(!r)return e()}),t)},up=nh({defaultOptions:{content:"block+"},defaultPriority:Zt.Medium,staticKeys:["content"],disableExtraAttributes:!0})(ip=class extends Ju{get name(){return"doc"}createNodeSpec(e){return{content:this.options.content}}})||ip,hp=nh({handlerKeys:["blur","focus","mousedown","mouseup","click","clickMark"],handlerKeyOptions:{blur:{earlyReturnValue:!0},focus:{earlyReturnValue:!0},mousedown:{earlyReturnValue:!0},mouseup:{earlyReturnValue:!0},click:{earlyReturnValue:!0}},defaultPriority:Zt.Low})(ap=class extends Uu{get name(){return"events"}onView(){var e,t=Bt(this.store.extensions);try{for(t.s();!(e=t.n()).done;){var r,n,o=e.value;if(!(null===(r=this.store.managerSettings.exclude)||void 0===r?void 0:r.clickHandler)&&o.createEventHandlers&&!(null===(n=o.options.exclude)||void 0===n?void 0:n.clickHandler)){var i,a=Bt(Er(o.createEventHandlers()));try{for(a.s();!(i=a.n()).done;){var s=Pt(i.value,2),l=s[0],c=s[1];this.addHandler(l,c)}}catch(u){a.e(u)}finally{a.f()}}}}catch(u){t.e(u)}finally{t.f()}}createPlugin(){var e=new WeakMap;return{props:{handleClickOn:(t,r,n,o,i,a)=>{var s=this.store.currentState,l=s.schema,c=s.doc.resolve(r),u=e.has(i),h=function(e){var t=e.handled,r=e.view,n=e.$pos,o=e.state,i={getMark:rn,markRanges:[],view:r,state:o};if(t)return i;var a,s=Bt(n.marks());try{for(s.s();!(a=s.n()).done;){var l=Ec(n,a.value.type);l&&i.markRanges.push(l)}}catch(c){s.e(c)}finally{s.f()}return i.getMark=e=>{var t=$r(e)?o.schema.marks[e]:e;return t||pn(!1),i.markRanges.find((e=>e.mark.type===t))},i}({$pos:c,handled:u,view:t,state:s}),d=!1;u||(d=this.options.clickMark(i,h)||d);var p=zt(zt({},h),{},{pos:r,direct:a,nodeWithPosition:{node:n,pos:o},getNode:e=>{var t=$r(e)?l.nodes[e]:e;return t||pn(!1),t===n.type?{node:n,pos:o}:void 0}});return e.set(i,!0),this.options.click(i,p)||d},handleDOMEvents:{focus:(e,t)=>this.options.focus(t)||!1,blur:(e,t)=>this.options.blur(t)||!1,mousedown:(e,t)=>this.options.mousedown(t)||!1,mouseup:(e,t)=>this.options.mouseup(t)||!1}}}}})||ap;var dp=function(e){function t(t){e.call(this,t,t)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.map=function(r,n){var o=r.resolve(n.map(this.head));return t.valid(o)?new t(o):e.near(o)},t.prototype.content=function(){return An.empty},t.prototype.eq=function(e){return e instanceof t&&e.head==this.head},t.prototype.toJSON=function(){return{type:"gapcursor",pos:this.head}},t.fromJSON=function(e,r){if("number"!=typeof r.pos)throw new RangeError("Invalid input for GapCursor.fromJSON");return new t(e.resolve(r.pos))},t.prototype.getBookmark=function(){return new pp(this.anchor)},t.valid=function(e){var t=e.parent;if(t.isTextblock||!function(e){for(var t=e.depth;t>=0;t--){var r=e.index(t);if(0!=r)for(var n=e.node(t).child(r-1);;n=n.lastChild){if(0==n.childCount&&!n.inlineContent||n.isAtom||n.type.spec.isolating)return!0;if(n.inlineContent)return!1}}return!0}(e)||!function(e){for(var t=e.depth;t>=0;t--){var r=e.indexAfter(t),n=e.node(t);if(r!=n.childCount)for(var o=n.child(r);;o=o.firstChild){if(0==o.childCount&&!o.inlineContent||o.isAtom||o.type.spec.isolating)return!0;if(o.inlineContent)return!1}}return!0}(e))return!1;var r=t.type.spec.allowGapCursor;if(null!=r)return r;var n=t.contentMatchAt(e.index()).defaultType;return n&&n.isTextblock},t.findFrom=function(e,r,n){e:for(;;){if(!n&&t.valid(e))return e;for(var o=e.pos,i=null,a=e.depth;;a--){var s=e.node(a);if(r>0?e.indexAfter(a)<s.childCount:e.index(a)>0){i=s.child(r>0?e.indexAfter(a):e.index(a)-1);break}if(0==a)return null;o+=r;var l=e.doc.resolve(o);if(t.valid(l))return l}for(;;){var c=r>0?i.firstChild:i.lastChild;if(!c){if(i.isAtom&&!i.isText&&!ki.isSelectable(i)){e=e.doc.resolve(o+i.nodeSize*r),n=!1;continue e}break}i=c,o+=r;var u=e.doc.resolve(o);if(t.valid(u))return u}return null}},t}(mi);dp.prototype.visible=!1,mi.jsonID("gapcursor",dp);var pp=function(e){this.pos=e};pp.prototype.map=function(e){return new pp(e.map(this.pos))},pp.prototype.resolve=function(e){var t=e.resolve(this.pos);return dp.valid(t)?new dp(t):mi.near(t)};var fp,vp=Tu({ArrowLeft:mp("horiz",-1),ArrowRight:mp("horiz",1),ArrowUp:mp("vert",-1),ArrowDown:mp("vert",1)});function mp(e,t){var r="vert"==e?t>0?"down":"up":t>0?"right":"left";return function(e,n,o){var i=e.selection,a=t>0?i.$to:i.$from,s=i.empty;if(i instanceof wi){if(!o.endOfTextblock(r)||0==a.depth)return!1;s=!1,a=e.doc.resolve(t>0?a.after():a.before())}var l=dp.findFrom(a,t,s);return!!l&&(n&&n(e.tr.setSelection(new dp(l))),!0)}}function gp(e,t,r){if(!e.editable)return!1;var n=e.state.doc.resolve(t);if(!dp.valid(n))return!1;var o=e.posAtCoords({left:r.clientX,top:r.clientY}).inside;return!(o>-1&&ki.isSelectable(e.state.doc.nodeAt(o)))&&(e.dispatch(e.state.tr.setSelection(new dp(n))),!0)}function yp(e){if(!(e.selection instanceof dp))return null;var t=document.createElement("div");return t.className="ProseMirror-gapcursor",bl.create(e.doc,[ml.widget(e.selection.head,t,{key:"gapcursor"})])}var wp=nh({})(fp=class extends Uu{get name(){return"gapCursor"}createExternalPlugins(){return[new zi({props:{decorations:yp,createSelectionBetween:function(e,t,r){if(t.pos==r.pos&&dp.valid(r))return new dp(r)},handleClick:gp,handleKeyDown:vp}})]}})||fp,bp=function(){};bp.prototype.append=function(e){return e.length?(e=bp.from(e),!this.length&&e||e.length<200&&this.leafAppend(e)||this.length<200&&e.leafPrepend(this)||this.appendInner(e)):this},bp.prototype.prepend=function(e){return e.length?bp.from(e).append(this):this},bp.prototype.appendInner=function(e){return new xp(this,e)},bp.prototype.slice=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=this.length),e>=t?bp.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))},bp.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)},bp.prototype.forEach=function(e,t,r){void 0===t&&(t=0),void 0===r&&(r=this.length),t<=r?this.forEachInner(e,t,r,0):this.forEachInvertedInner(e,t,r,0)},bp.prototype.map=function(e,t,r){void 0===t&&(t=0),void 0===r&&(r=this.length);var n=[];return this.forEach((function(t,r){return n.push(e(t,r))}),t,r),n},bp.from=function(e){return e instanceof bp?e:e&&e.length?new kp(e):bp.empty};var kp=function(e){function t(t){e.call(this),this.values=t}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var r={length:{configurable:!0},depth:{configurable:!0}};return t.prototype.flatten=function(){return this.values},t.prototype.sliceInner=function(e,r){return 0==e&&r==this.length?this:new t(this.values.slice(e,r))},t.prototype.getInner=function(e){return this.values[e]},t.prototype.forEachInner=function(e,t,r,n){for(var o=t;o<r;o++)if(!1===e(this.values[o],n+o))return!1},t.prototype.forEachInvertedInner=function(e,t,r,n){for(var o=t-1;o>=r;o--)if(!1===e(this.values[o],n+o))return!1},t.prototype.leafAppend=function(e){if(this.length+e.length<=200)return new t(this.values.concat(e.flatten()))},t.prototype.leafPrepend=function(e){if(this.length+e.length<=200)return new t(e.flatten().concat(this.values))},r.length.get=function(){return this.values.length},r.depth.get=function(){return 0},Object.defineProperties(t.prototype,r),t}(bp);bp.empty=new kp([]);var xp=function(e){function t(t,r){e.call(this),this.left=t,this.right=r,this.length=t.length+r.length,this.depth=Math.max(t.depth,r.depth)+1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},t.prototype.getInner=function(e){return e<this.left.length?this.left.get(e):this.right.get(e-this.left.length)},t.prototype.forEachInner=function(e,t,r,n){var o=this.left.length;return!(t<o&&!1===this.left.forEachInner(e,t,Math.min(r,o),n))&&(!(r>o&&!1===this.right.forEachInner(e,Math.max(t-o,0),Math.min(this.length,r)-o,n+o))&&void 0)},t.prototype.forEachInvertedInner=function(e,t,r,n){var o=this.left.length;return!(t>o&&!1===this.right.forEachInvertedInner(e,t-o,Math.max(r,o)-o,n+o))&&(!(r<o&&!1===this.left.forEachInvertedInner(e,Math.min(t,o),r,n))&&void 0)},t.prototype.sliceInner=function(e,t){if(0==e&&t==this.length)return this;var r=this.left.length;return t<=r?this.left.slice(e,t):e>=r?this.right.slice(e-r,t-r):this.left.slice(e,r).append(this.right.slice(0,t-r))},t.prototype.leafAppend=function(e){var r=this.right.leafAppend(e);if(r)return new t(this.left,r)},t.prototype.leafPrepend=function(e){var r=this.left.leafPrepend(e);if(r)return new t(r,this.right)},t.prototype.appendInner=function(e){return this.left.depth>=Math.max(this.right.depth,e.depth)+1?new t(this.left,new t(this.right,e)):new t(this,e)},t}(bp),Sp=bp,Mp=function(e,t){this.items=e,this.eventCount=t};Mp.prototype.popEvent=function(e,t){var r=this;if(0==this.eventCount)return null;for(var n,o,i=this.items.length;;i--){if(this.items.get(i-1).selection){--i;break}}t&&(n=this.remapping(i,this.items.length),o=n.maps.length);var a,s,l=e.tr,c=[],u=[];return this.items.forEach((function(e,t){if(!e.step)return n||(n=r.remapping(i,t+1),o=n.maps.length),o--,void u.push(e);if(n){u.push(new Cp(e.map));var h,d=e.step.map(n.slice(o));d&&l.maybeStep(d).doc&&(h=l.mapping.maps[l.mapping.maps.length-1],c.push(new Cp(h,null,null,c.length+u.length))),o--,h&&n.appendMap(h,o)}else l.maybeStep(e.step);return e.selection?(a=n?e.selection.map(n.slice(o)):e.selection,s=new Mp(r.items.slice(0,i).append(u.reverse().concat(c)),r.eventCount-1),!1):void 0}),this.items.length,0),{remaining:s,transform:l,selection:a}},Mp.prototype.addTransform=function(e,t,r,n){for(var o=[],i=this.eventCount,a=this.items,s=!n&&a.length?a.get(a.length-1):null,l=0;l<e.steps.length;l++){var c,u=e.steps[l].invert(e.docs[l]),h=new Cp(e.mapping.maps[l],u,t);(c=s&&s.merge(h))&&(h=c,l?o.pop():a=a.slice(0,a.length-1)),o.push(h),t&&(i++,t=null),n||(s=h)}var d,p,f,v=i-r.depth;return v>Ep&&(p=v,(d=a).forEach((function(e,t){if(e.selection&&0==p--)return f=t,!1})),a=d.slice(f),i-=v),new Mp(a.append(o),i)},Mp.prototype.remapping=function(e,t){var r=new Ho;return this.items.forEach((function(t,n){var o=null!=t.mirrorOffset&&n-t.mirrorOffset>=e?r.maps.length-t.mirrorOffset:null;r.appendMap(t.map,o)}),e,t),r},Mp.prototype.addMaps=function(e){return 0==this.eventCount?this:new Mp(this.items.append(e.map((function(e){return new Cp(e)}))),this.eventCount)},Mp.prototype.rebased=function(e,t){if(!this.eventCount)return this;var r=[],n=Math.max(0,this.items.length-t),o=e.mapping,i=e.steps.length,a=this.eventCount;this.items.forEach((function(e){e.selection&&a--}),n);var s=t;this.items.forEach((function(t){var n=o.getMirror(--s);if(null!=n){i=Math.min(i,n);var l=o.maps[n];if(t.step){var c=e.steps[n].invert(e.docs[n]),u=t.selection&&t.selection.map(o.slice(s+1,n));u&&a++,r.push(new Cp(l,c,u))}else r.push(new Cp(l))}}),n);for(var l=[],c=t;c<i;c++)l.push(new Cp(o.maps[c]));var u=this.items.slice(0,n).append(l).append(r),h=new Mp(u,a);return h.emptyItemCount()>500&&(h=h.compress(this.items.length-r.length)),h},Mp.prototype.emptyItemCount=function(){var e=0;return this.items.forEach((function(t){t.step||e++})),e},Mp.prototype.compress=function(e){void 0===e&&(e=this.items.length);var t=this.remapping(0,e),r=t.maps.length,n=[],o=0;return this.items.forEach((function(i,a){if(a>=e)n.push(i),i.selection&&o++;else if(i.step){var s=i.step.map(t.slice(r)),l=s&&s.getMap();if(r--,l&&t.appendMap(l,r),s){var c=i.selection&&i.selection.map(t.slice(r));c&&o++;var u,h=new Cp(l.invert(),s,c),d=n.length-1;(u=n.length&&n[d].merge(h))?n[d]=u:n.push(h)}}else i.map&&r--}),this.items.length,0),new Mp(Sp.from(n.reverse()),o)},Mp.empty=new Mp(Sp.empty,0);var Cp=function(e,t,r,n){this.map=e,this.step=t,this.selection=r,this.mirrorOffset=n};Cp.prototype.merge=function(e){if(this.step&&e.step&&!e.selection){var t=e.step.merge(this.step);if(t)return new Cp(t.getMap().invert(),t,this.selection)}};var Op=function(e,t,r,n){this.done=e,this.undone=t,this.prevRanges=r,this.prevTime=n},Ep=20;function Ap(e){var t=[];return e.forEach((function(e,r,n,o){return t.push(n,o)})),t}function Np(e,t){if(!e)return null;for(var r=[],n=0;n<e.length;n+=2){var o=t.map(e[n],1),i=t.map(e[n+1],-1);o<=i&&r.push(o,i)}return r}function Rp(e,t,r,n){var o=Pp(t),i=Vp.get(t).spec.config,a=(n?e.undone:e.done).popEvent(t,o);if(a){var s=a.selection.resolve(a.transform.doc),l=(n?e.done:e.undone).addTransform(a.transform,t.selection.getBookmark(),i,o),c=new Op(n?l:a.remaining,n?a.remaining:l,null,0);r(a.transform.setSelection(s).setMeta(Vp,{redo:n,historyState:c}).scrollIntoView())}}var Tp=!1,Dp=null;function Pp(e){var t=e.plugins;if(Dp!=t){Tp=!1,Dp=t;for(var r=0;r<t.length;r++)if(t[r].spec.historyPreserveItems){Tp=!0;break}}return Tp}var Ip,Vp=new Hi("history"),zp=new Hi("closeHistory");function $p(e){return e={depth:e&&e.depth||100,newGroupDelay:e&&e.newGroupDelay||500},new zi({key:Vp,state:{init:function(){return new Op(Mp.empty,Mp.empty,null,0)},apply:function(t,r,n){return function(e,t,r,n){var o,i=r.getMeta(Vp);if(i)return i.historyState;r.getMeta(zp)&&(e=new Op(e.done,e.undone,null,0));var a=r.getMeta("appendedTransaction");if(0==r.steps.length)return e;if(a&&a.getMeta(Vp))return a.getMeta(Vp).redo?new Op(e.done.addTransform(r,null,n,Pp(t)),e.undone,Ap(r.mapping.maps[r.steps.length-1]),e.prevTime):new Op(e.done,e.undone.addTransform(r,null,n,Pp(t)),null,e.prevTime);if(!1===r.getMeta("addToHistory")||a&&!1===a.getMeta("addToHistory"))return(o=r.getMeta("rebased"))?new Op(e.done.rebased(r,o),e.undone.rebased(r,o),Np(e.prevRanges,r.mapping),e.prevTime):new Op(e.done.addMaps(r.mapping.maps),e.undone.addMaps(r.mapping.maps),Np(e.prevRanges,r.mapping),e.prevTime);var s=0==e.prevTime||!a&&(e.prevTime<(r.time||0)-n.newGroupDelay||!function(e,t){if(!t)return!1;if(!e.docChanged)return!0;var r=!1;return e.mapping.maps[0].forEach((function(e,n){for(var o=0;o<t.length;o+=2)e<=t[o+1]&&n>=t[o]&&(r=!0)})),r}(r,e.prevRanges)),l=a?Np(e.prevRanges,r.mapping):Ap(r.mapping.maps[r.steps.length-1]);return new Op(e.done.addTransform(r,s?t.selection.getBookmark():null,n,Pp(t)),Mp.empty,l,r.time)}(r,n,t,e)}},config:e})}function Bp(e,t){var r=Vp.getState(e);return!(!r||0==r.done.eventCount)&&(t&&Rp(r,e,t,!1),!0)}function Hp(e,t){var r=Vp.getState(e);return!(!r||0==r.undone.eventCount)&&(t&&Rp(r,e,t,!0),!0)}var Lp,_p=nh({defaultOptions:{depth:100,newGroupDelay:500,getDispatch:void 0,getState:void 0},staticKeys:["depth","newGroupDelay"],handlerKeys:["onRedo","onUndo"]})(Ip=class extends Uu{constructor(){super(...arguments),It(this,"wrapMethod",((e,t)=>r=>{var n=r.state,o=r.dispatch,i=r.view,a=this.options,s=a.getState,l=a.getDispatch,c=Hr(s)?s():n,u=Hr(l)&&o?l():o,h=e(c,u,i);return null==t||t(h),h}))}get name(){return"history"}createKeymap(){return{"Mod-y":wc.isMac?()=>!1:this.wrapMethod(Hp,this.options.onRedo),"Mod-z":this.wrapMethod(Bp,this.options.onUndo),"Shift-Mod-z":this.wrapMethod(Hp,this.options.onRedo)}}createExternalPlugins(){var e=this.options;return[$p({depth:e.depth,newGroupDelay:e.newGroupDelay})]}createCommands(){return{undo:()=>mn(this.wrapMethod(Bp,this.options.onUndo)),redo:()=>mn(this.wrapMethod(Hp,this.options.onRedo))}}})||Ip,Fp=nh({defaultPriority:Zt.Medium})(Lp=class extends Ju{constructor(){super(...arguments),It(this,"tags",[Ut.LastNodeCompatible,Ut.BlockNode])}get name(){return"paragraph"}createNodeSpec(e){return{content:"inline*",attrs:zt({},e.defaults()),draggable:!1,parseDOM:[{tag:"p",getAttrs:t=>zt({},e.parse(t))}],toDOM:t=>["p",e.dom(t),0]}}createCommands(){return{createParagraph:e=>Yc(this.type,e)}}})||Lp,jp=new WeakMap,Wp=new WeakMap,Kp=new WeakMap,Up=new WeakMap,qp=new WeakMap,Jp=new WeakMap,Zp=new WeakMap,Gp=new WeakMap;class Xp{static create(e){return new Xp(e)}static fromPositioner(e,t){return Xp.create(zt(zt({},e.basePositioner),t))}get basePositioner(){return{getActive:Lt(this,Jp),getPosition:Lt(this,Gp),hasChanged:this.hasChanged,events:this.events,getID:Lt(this,Zp)}}constructor(e){var t;jp.set(this,{writable:!0,value:_t()}),Wp.set(this,{writable:!0,value:[]}),Kp.set(this,{writable:!0,value:new Map}),Up.set(this,{writable:!0,value:[]}),qp.set(this,{writable:!0,value:!1}),Jp.set(this,{writable:!0,value:void 0}),Zp.set(this,{writable:!0,value:void 0}),Gp.set(this,{writable:!0,value:void 0}),It(this,"addListener",((e,t)=>Lt(this,jp).on(e,t))),Wi(this,Jp,e.getActive),Wi(this,Gp,e.getPosition),Wi(this,Zp,e.getID),this.hasChanged=e.hasChanged,this.events=null!==(t=e.events)&&void 0!==t?t:["state","scroll"]}onActiveChanged(e){var t=this,r=Lt(this,Jp).call(this,e);Wi(this,Wp,r),Wi(this,Kp,new Map),Wi(this,qp,!1),Wi(this,Up,[]);var n,o=[],i=Bt(r.entries());try{var a=function(){var r=Pt(n.value,2),i=r[0],a=r[1],s=t.getID(a,i);Lt(t,Up).push(s),o.push({setElement:r=>t.addParameter(zt(zt({},e),{},{data:a,element:r}),i),id:s})};for(i.s();!(n=i.n()).done;)a()}catch(s){i.e(s)}finally{i.f()}Lt(this,jp).emit("update",o)}getID(e,t){var r,n;return null!==(r=null===(n=Lt(this,Zp))||void 0===n?void 0:n.call(this,e,t))&&void 0!==r?r:t.toString()}getVirtualNode(e){return{getBoundingClientRect:()=>e.rect}}addParameter(e,t){if(!(Lt(this,qp)||(Lt(this,Kp).set(t,e),Lt(this,Kp).size<Lt(this,Wp).length))){var r,n=[],o=Bt(Lt(this,Wp).keys());try{for(o.s();!(r=o.n()).done;){var i=r.value,a=Lt(this,Kp).get(i);a||pn(!1),n.push({position:Lt(this,Gp).call(this,a),element:a.element,id:Lt(this,Up)[i]})}}catch(s){o.e(s)}finally{o.f()}Lt(this,jp).emit("done",n)}}}function Yp(e){var t=e.tr,r=e.state,n=e.previousState;return t?function(e){return e.docChanged||e.selectionSet}(t):!r.doc.eq(n.doc)||!r.selection.eq(n.selection)}var Qp,ef,tf,rf={top:-999999,left:-999999,right:999999,bottom:999999},nf=zt(zt({},rf),{},{height:0,width:0,x:-999999,y:-999999}),of={rect:zt(zt({},nf),{},{toJSON:()=>nf})},af=Xp.create({hasChanged:Yp,getActive(e){var t,r=e.state,n=e.view;return Wc(r)&&1===r.selection.$anchor.depth&&(Dr(t=r.selection.$anchor.parent)&&t.type.isBlock&&!t.textContent&&!t.childCount)?[n.coordsAtPos(r.selection.$anchor.pos)]:[]},getPosition(e){var t=e.view,r=e.element,n=e.data,o=r.offsetParent;if(!o)return of;var i=o.getBoundingClientRect(),a=t.dom.getBoundingClientRect(),s=n.top-i.top,l=n.bottom-i.top,c=n.left-i.left,u=a.right-i.left;return{top:s,bottom:l,left:c,right:u,rect:new DOMRect(n.left,n.top,u-c,n.top-n.bottom)}}}),sf=Xp.create({hasChanged:Yp,getActive:e=>{var t=e.state,r=e.view;if(t.selection.empty)return[];var n=t.selection,o=n.from,i=n.to;return[{start:r.coordsAtPos(o),end:r.coordsAtPos(i)}]},getPosition(e){var t=e.element,r=e.data,n=r.start,o=r.end,i=t.offsetParent;if(!i)return of;var a=i.getBoundingClientRect(),s=t.getBoundingClientRect(),l=(n.left+o.left)/2-a.left,c=Math.min(a.width-s.width/2,Math.max(l,s.width/2)),u=Math.trunc(n.top-a.top),h=Math.trunc(n.bottom-a.top);return{rect:new DOMRect(n.left,n.top,o.right-n.left,o.bottom-n.top),left:c,top:u,bottom:h,right:c}}}),lf=Xp.create({hasChanged:Yp,getActive:e=>{var t=e.state,r=e.view;return t.selection.empty?[r.coordsAtPos(t.selection.from)]:[]},getPosition(e){var t=e.element,r=e.data,n=t.offsetParent;if(!n)return of;var o=n.getBoundingClientRect(),i=t.getBoundingClientRect(),a=r.left-o.left,s=o.right-r.right,l=Math.trunc(r.bottom-o.top),c=Math.trunc(r.top-o.top),u=new DOMRect(r.left,r.top,0,r.bottom-r.top),h=a+i.width>o.width?a-i.width:a;return{rect:u,right:s+i.width>o.width?s-i.width:s,left:h,bottom:l,top:c}}}),cf=nh({defaultOptions:{scrollDebounce:50},customHandlerKeys:["positioner"],staticKeys:["scrollDebounce"]})((ef=new WeakMap,Qp=class extends Uu{constructor(){super(...arguments),ef.set(this,{writable:!0,value:[]}),It(this,"onAddCustomHandler",(e=>{var t=e.positioner;if(t)return Wi(this,ef,[...Lt(this,ef),t]),this.store.commands.forceUpdate(),()=>{Wi(this,ef,Lt(this,ef).filter((e=>e!==t)))}}))}get name(){return"positioner"}init(){var e,t,r;this.onScroll=(e=this.options.scrollDebounce,t=this.onScroll.bind(this),void 0===r?Or(e,t,!1):Or(e,r,!1!==t))}getParameter(e){var t,r=e.event,n=e.firstUpdate,o=this.store.getState();return{event:r,firstUpdate:n,previousState:null!==(t=this.store.previousState)&&void 0!==t?t:o,state:o,scrollTop:this.store.view.dom.scrollTop}}onScroll(){var e=this.getParameter({event:"scroll",firstUpdate:!1});this.positioner(e)}createPlugin(){return{props:{handleDOMEvents:{scroll:()=>(this.onScroll(),!1)}}}}onStateUpdate(e){this.positioner(zt(zt({},e),{},{event:"state",scrollTop:this.store.view.dom.scrollTop,firstUpdate:!1}))}positioner(e){var t,r=Bt(Lt(this,ef));try{for(r.s();!(t=r.n()).done;){var n=t.value;!n.events.includes(e.event)||this.triggerPositioner(n,e)}}catch(o){r.e(o)}finally{r.f()}}triggerPositioner(e,t){e.hasChanged(t)&&e.onActiveChanged(zt(zt({},t),{},{view:this.store.view}))}}))||Qp,uf={bubble:sf,centeredSelection:sf,floating:af,floatingSelection:af,popup:lf,cursor:lf};var hf,df,pf,ff=nh({disableExtraAttributes:!0,defaultPriority:Zt.Medium})(tf=class extends Ju{constructor(){super(...arguments),It(this,"tags",[Ut.InlineNode])}get name(){return"text"}createNodeSpec(){return{}}})||tf,vf=oh({defaultOptions:zt(zt(zt(zt({},up.defaultOptions),Fp.defaultOptions),_p.defaultOptions),{},{excludeExtensions:[]}),customHandlerKeys:["positioner"],handlerKeys:["onRedo","onUndo"],staticKeys:["content","depth","newGroupDelay","excludeExtensions"]})(hf=class extends hh{constructor(){super(...arguments),It(this,"onAddCustomHandler",(e=>{var t=e.positioner;if(t)return this.getExtension(cf).addCustomHandler("positioner",t)}))}get name(){return"core"}onSetOptions(e){}createExtensions(){var e,t=this.options,r=t.content,n=t.depth,o=t.getDispatch,i=t.getState,a=t.newGroupDelay,s=t.excludeExtensions,l={},c=Bt(null!=s?s:[]);try{for(c.s();!(e=c.n()).done;){l[e.value]=!0}}catch(d){c.e(d)}finally{c.f()}var u=[];if(!l.history){var h=new _p({depth:n,getDispatch:o,getState:i,newGroupDelay:a});h.addHandler("onRedo",this.options.onRedo),h.addHandler("onUndo",this.options.onUndo),u.push(h)}return l.doc||u.push(new up({content:r})),l.text||u.push(new ff),l.paragraph||u.push(new Fp),l.positioner||u.push(new cf),l.gapCursor||u.push(new wp),l.events||u.push(new hp),u}})||hf,mf=nh({defaultOptions:{emptyNodeClass:"remirror-is-empty",placeholder:""}})(df=class extends Uu{get name(){return"placeholder"}createAttributes(){return{"aria-placeholder":this.options.placeholder}}createPlugin(){return{state:{init:(e,t)=>zt(zt({},this.options),{},{empty:Oc(t.doc)}),apply:(e,t,r,n)=>function(e){var t=e.pluginState,r=e.extension,n=e.tr,o=e.state;if(!n.docChanged)return t;return zt(zt({},r.options),{},{empty:Oc(o.doc)})}({pluginState:t,tr:e,extension:this,state:n})},props:{decorations:e=>function(e){var t=e.extension,r=e.state,n=t.pluginKey.getState(r).empty,o=t.options,i=o.emptyNodeClass,a=o.placeholder;if(!n)return;var s=[];return r.doc.descendants(((e,t)=>{var r=ml.node(t,t+e.nodeSize,{class:i,"data-placeholder":a});s.push(r)})),bl.create(r.doc,s)}({state:e,extension:this})}}}onSetOptions(e){e.changes.placeholder.changed&&this.store.phase>=Xt.EditorView&&this.store.updateAttributes()}})||df;var gf,yf=nh({defaultOptions:{transformers:[function(e){return function(e,t){if(r=e,!Wr(r)||!Xd(r)||r.type!==c)throw new Error("Invalid element passed. The top level element must be a fragment");var r;var n=Yd(e).children,o=Yd(n);return l(e,{},t(n,o))}(e,(e=>Jr(e)?h.map(e,(e=>{if(!(Xd(t=e)&&$r(t.type)&&function(e){return 0===h.count(e.props.children)}(e)&&function(e,t){return e.type===t}(e,"p")))return e;var t,r=Yd(e);return l(e,r,d("br"))})):e))}]},defaultPriority:Zt.High,staticKeys:["transformers"]})(pf=class extends Uu{constructor(){super(...arguments),It(this,"createSSRTransformer",(()=>e=>{var t,r=e,n=Bt(this.options.transformers);try{for(n.s();!(t=n.n()).done;){r=(0,t.value)(r)}}catch(o){n.e(o)}finally{n.f()}return r}))}get name(){return"reactSsr"}onCreate(){var e,t=Tr(),r=[],n=Bt(this.store.extensions);try{for(n.s();!(e=n.n()).done;){var o,i,a,s=e.value;(null===(o=this.store.managerSettings.exclude)||void 0===o?void 0:o.reactSSR)||!s.ReactComponent||"dom"===s.reactComponentEnvironment||(null===(i=s.options.exclude)||void 0===i?void 0:i.reactSSR)||(t[s.name]={Component:s.ReactComponent,props:{decorations:[],environment:"ssr",forwardRef:()=>{},getPosition:()=>0,selected:!1,updateAttributes:()=>{}}}),s.createSSRTransformer&&!(null===(a=s.options.exclude)||void 0===a?void 0:a.reactSSR)&&r.push(s.createSSRTransformer)}}catch(l){n.e(l)}finally{n.f()}this.store.setStoreKey("components",t),this.store.setStoreKey("ssrTransformer",((e,t)=>{var n,o=e,i=Bt(r);try{for(i.s();!(n=i.n()).done;){o=(0,n.value)()(o,t)}}catch(l){i.e(l)}finally{i.f()}return o}))}})||pf;var wf=oh({defaultOptions:zt(zt(zt({},yf.defaultOptions),mf.defaultOptions),Gd.defaultOptions),staticKeys:["transformers","defaultEnvironment"]})(gf=class extends hh{get name(){return"react"}onSetOptions(e){var t=(0,e.pickChanged)(["emptyNodeClass","placeholder"]);Zr(t)||this.getExtension(mf).setOptions(t)}createExtensions(){var e=this.options,t=e.transformers,r=e.emptyNodeClass,n=e.placeholder,o=e.defaultBlockNode,i=e.defaultContentNode,a=e.defaultEnvironment,s=e.defaultInlineNode,l=e.nodeViewComponents,c=new mf({emptyNodeClass:r,placeholder:n});this.addSSRToPlaceholder(c);var u=new Gd({defaultBlockNode:o,defaultContentNode:i,defaultEnvironment:a,defaultInlineNode:s,nodeViewComponents:l});return[new yf({transformers:t}),c,u]}addSSRToPlaceholder(e){e.createSSRTransformer=()=>(t,r)=>{var n;r=null!==(n=r)&&void 0!==n?n:this.extensionStore.getState();var o=e.options,i=o.emptyNodeClass,a=o.placeholder,s=Yd(t).children;if(h.count(s)>1||!Oc(r.doc))return t;var c=Yd(s);return l(t,{},l(s,{placeholder:a,className:Du($r(c.className)&&c.className,i),"data-placeholder":a}))}}})||gf,bf=p,kf={};Object.defineProperty(kf,"__esModule",{value:!0});var xf=kf.default=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(2===e.length)return Mf(e[0],e[1])||null;var r=e.slice(1).reduce((function(e,t){return Mf(e,t)}),e[0]);return r||null},Sf=new WeakMap;function Mf(e,t){if(e&&t){var r=Sf.get(e)||new WeakMap;Sf.set(e,r);var n=r.get(t)||function(r){Cf(e,r),Cf(t,r)};return r.set(t,n),n}return e||t}function Cf(e,t){"function"==typeof e?e(t):e.current=t}var Of={accept:"accept",acceptcharset:"acceptCharset","accept-charset":"acceptCharset",accesskey:"accessKey",action:"action",allowfullscreen:"allowFullScreen",alt:"alt",as:"as",async:"async",autocapitalize:"autoCapitalize",autocomplete:"autoComplete",autocorrect:"autoCorrect",autofocus:"autoFocus",autoplay:"autoPlay",autosave:"autoSave",capture:"capture",cellpadding:"cellPadding",cellspacing:"cellSpacing",challenge:"challenge",charset:"charSet",checked:"checked",children:"children",cite:"cite",class:"className",classid:"classID",classname:"className",cols:"cols",colspan:"colSpan",content:"content",contenteditable:"contentEditable",contextmenu:"contextMenu",controls:"controls",controlslist:"controlsList",coords:"coords",crossorigin:"crossOrigin",dangerouslysetinnerhtml:"dangerouslySetInnerHTML",data:"data",datetime:"dateTime",default:"default",defaultchecked:"defaultChecked",defaultvalue:"defaultValue",defer:"defer",dir:"dir",disabled:"disabled",download:"download",draggable:"draggable",enctype:"encType",for:"htmlFor",form:"form",formmethod:"formMethod",formaction:"formAction",formenctype:"formEncType",formnovalidate:"formNoValidate",formtarget:"formTarget",frameborder:"frameBorder",headers:"headers",height:"height",hidden:"hidden",high:"high",href:"href",hreflang:"hrefLang",htmlfor:"htmlFor",httpequiv:"httpEquiv","http-equiv":"httpEquiv",icon:"icon",id:"id",innerhtml:"innerHTML",inputmode:"inputMode",integrity:"integrity",is:"is",itemid:"itemID",itemprop:"itemProp",itemref:"itemRef",itemscope:"itemScope",itemtype:"itemType",keyparams:"keyParameter",keytype:"keyType",kind:"kind",label:"label",lang:"lang",list:"list",loop:"loop",low:"low",manifest:"manifest",marginwidth:"marginWidth",marginheight:"marginHeight",max:"max",maxlength:"maxLength",media:"media",mediagroup:"mediaGroup",method:"method",min:"min",minlength:"minLength",multiple:"multiple",muted:"muted",name:"name",nomodule:"noModule",nonce:"nonce",novalidate:"noValidate",open:"open",optimum:"optimum",pattern:"pattern",placeholder:"placeholder",playsinline:"playsInline",poster:"poster",preload:"preload",profile:"profile",radiogroup:"radioGroup",readonly:"readOnly",referrerpolicy:"referrerPolicy",rel:"rel",required:"required",reversed:"reversed",role:"role",rows:"rows",rowspan:"rowSpan",sandbox:"sandbox",scope:"scope",scoped:"scoped",scrolling:"scrolling",seamless:"seamless",selected:"selected",shape:"shape",size:"size",sizes:"sizes",span:"span",spellcheck:"spellCheck",src:"src",srcdoc:"srcDoc",srclang:"srcLang",srcset:"srcSet",start:"start",step:"step",style:"style",summary:"summary",tabindex:"tabIndex",target:"target",title:"title",type:"type",usemap:"useMap",value:"value",width:"width",wmode:"wmode",wrap:"wrap",about:"about",accentheight:"accentHeight","accent-height":"accentHeight",accumulate:"accumulate",additive:"additive",alignmentbaseline:"alignmentBaseline","alignment-baseline":"alignmentBaseline",allowreorder:"allowReorder",alphabetic:"alphabetic",amplitude:"amplitude",arabicform:"arabicForm","arabic-form":"arabicForm",ascent:"ascent",attributename:"attributeName",attributetype:"attributeType",autoreverse:"autoReverse",azimuth:"azimuth",basefrequency:"baseFrequency",baselineshift:"baselineShift","baseline-shift":"baselineShift",baseprofile:"baseProfile",bbox:"bbox",begin:"begin",bias:"bias",by:"by",calcmode:"calcMode",capheight:"capHeight","cap-height":"capHeight",clip:"clip",clippath:"clipPath","clip-path":"clipPath",clippathunits:"clipPathUnits",cliprule:"clipRule","clip-rule":"clipRule",color:"color",colorinterpolation:"colorInterpolation","color-interpolation":"colorInterpolation",colorinterpolationfilters:"colorInterpolationFilters","color-interpolation-filters":"colorInterpolationFilters",colorprofile:"colorProfile","color-profile":"colorProfile",colorrendering:"colorRendering","color-rendering":"colorRendering",contentscripttype:"contentScriptType",contentstyletype:"contentStyleType",cursor:"cursor",cx:"cx",cy:"cy",d:"d",datatype:"datatype",decelerate:"decelerate",descent:"descent",diffuseconstant:"diffuseConstant",direction:"direction",display:"display",divisor:"divisor",dominantbaseline:"dominantBaseline","dominant-baseline":"dominantBaseline",dur:"dur",dx:"dx",dy:"dy",edgemode:"edgeMode",elevation:"elevation",enablebackground:"enableBackground","enable-background":"enableBackground",end:"end",exponent:"exponent",externalresourcesrequired:"externalResourcesRequired",fill:"fill",fillopacity:"fillOpacity","fill-opacity":"fillOpacity",fillrule:"fillRule","fill-rule":"fillRule",filter:"filter",filterres:"filterRes",filterunits:"filterUnits",floodopacity:"floodOpacity","flood-opacity":"floodOpacity",floodcolor:"floodColor","flood-color":"floodColor",focusable:"focusable",fontfamily:"fontFamily","font-family":"fontFamily",fontsize:"fontSize","font-size":"fontSize",fontsizeadjust:"fontSizeAdjust","font-size-adjust":"fontSizeAdjust",fontstretch:"fontStretch","font-stretch":"fontStretch",fontstyle:"fontStyle","font-style":"fontStyle",fontvariant:"fontVariant","font-variant":"fontVariant",fontweight:"fontWeight","font-weight":"fontWeight",format:"format",from:"from",fx:"fx",fy:"fy",g1:"g1",g2:"g2",glyphname:"glyphName","glyph-name":"glyphName",glyphorientationhorizontal:"glyphOrientationHorizontal","glyph-orientation-horizontal":"glyphOrientationHorizontal",glyphorientationvertical:"glyphOrientationVertical","glyph-orientation-vertical":"glyphOrientationVertical",glyphref:"glyphRef",gradienttransform:"gradientTransform",gradientunits:"gradientUnits",hanging:"hanging",horizadvx:"horizAdvX","horiz-adv-x":"horizAdvX",horizoriginx:"horizOriginX","horiz-origin-x":"horizOriginX",ideographic:"ideographic",imagerendering:"imageRendering","image-rendering":"imageRendering",in2:"in2",in:"in",inlist:"inlist",intercept:"intercept",k1:"k1",k2:"k2",k3:"k3",k4:"k4",k:"k",kernelmatrix:"kernelMatrix",kernelunitlength:"kernelUnitLength",kerning:"kerning",keypoints:"keyPoints",keysplines:"keySplines",keytimes:"keyTimes",lengthadjust:"lengthAdjust",letterspacing:"letterSpacing","letter-spacing":"letterSpacing",lightingcolor:"lightingColor","lighting-color":"lightingColor",limitingconeangle:"limitingConeAngle",local:"local",markerend:"markerEnd","marker-end":"markerEnd",markerheight:"markerHeight",markermid:"markerMid","marker-mid":"markerMid",markerstart:"markerStart","marker-start":"markerStart",markerunits:"markerUnits",markerwidth:"markerWidth",mask:"mask",maskcontentunits:"maskContentUnits",maskunits:"maskUnits",mathematical:"mathematical",mode:"mode",numoctaves:"numOctaves",offset:"offset",opacity:"opacity",operator:"operator",order:"order",orient:"orient",orientation:"orientation",origin:"origin",overflow:"overflow",overlineposition:"overlinePosition","overline-position":"overlinePosition",overlinethickness:"overlineThickness","overline-thickness":"overlineThickness",paintorder:"paintOrder","paint-order":"paintOrder",panose1:"panose1","panose-1":"panose1",pathlength:"pathLength",patterncontentunits:"patternContentUnits",patterntransform:"patternTransform",patternunits:"patternUnits",pointerevents:"pointerEvents","pointer-events":"pointerEvents",points:"points",pointsatx:"pointsAtX",pointsaty:"pointsAtY",pointsatz:"pointsAtZ",prefix:"prefix",preservealpha:"preserveAlpha",preserveaspectratio:"preserveAspectRatio",primitiveunits:"primitiveUnits",property:"property",r:"r",radius:"radius",refx:"refX",refy:"refY",renderingintent:"renderingIntent","rendering-intent":"renderingIntent",repeatcount:"repeatCount",repeatdur:"repeatDur",requiredextensions:"requiredExtensions",requiredfeatures:"requiredFeatures",resource:"resource",restart:"restart",result:"result",results:"results",rotate:"rotate",rx:"rx",ry:"ry",scale:"scale",security:"security",seed:"seed",shaperendering:"shapeRendering","shape-rendering":"shapeRendering",slope:"slope",spacing:"spacing",specularconstant:"specularConstant",specularexponent:"specularExponent",speed:"speed",spreadmethod:"spreadMethod",startoffset:"startOffset",stddeviation:"stdDeviation",stemh:"stemh",stemv:"stemv",stitchtiles:"stitchTiles",stopcolor:"stopColor","stop-color":"stopColor",stopopacity:"stopOpacity","stop-opacity":"stopOpacity",strikethroughposition:"strikethroughPosition","strikethrough-position":"strikethroughPosition",strikethroughthickness:"strikethroughThickness","strikethrough-thickness":"strikethroughThickness",string:"string",stroke:"stroke",strokedasharray:"strokeDasharray","stroke-dasharray":"strokeDasharray",strokedashoffset:"strokeDashoffset","stroke-dashoffset":"strokeDashoffset",strokelinecap:"strokeLinecap","stroke-linecap":"strokeLinecap",strokelinejoin:"strokeLinejoin","stroke-linejoin":"strokeLinejoin",strokemiterlimit:"strokeMiterlimit","stroke-miterlimit":"strokeMiterlimit",strokewidth:"strokeWidth","stroke-width":"strokeWidth",strokeopacity:"strokeOpacity","stroke-opacity":"strokeOpacity",suppresscontenteditablewarning:"suppressContentEditableWarning",suppresshydrationwarning:"suppressHydrationWarning",surfacescale:"surfaceScale",systemlanguage:"systemLanguage",tablevalues:"tableValues",targetx:"targetX",targety:"targetY",textanchor:"textAnchor","text-anchor":"textAnchor",textdecoration:"textDecoration","text-decoration":"textDecoration",textlength:"textLength",textrendering:"textRendering","text-rendering":"textRendering",to:"to",transform:"transform",typeof:"typeof",u1:"u1",u2:"u2",underlineposition:"underlinePosition","underline-position":"underlinePosition",underlinethickness:"underlineThickness","underline-thickness":"underlineThickness",unicode:"unicode",unicodebidi:"unicodeBidi","unicode-bidi":"unicodeBidi",unicoderange:"unicodeRange","unicode-range":"unicodeRange",unitsperem:"unitsPerEm","units-per-em":"unitsPerEm",unselectable:"unselectable",valphabetic:"vAlphabetic","v-alphabetic":"vAlphabetic",values:"values",vectoreffect:"vectorEffect","vector-effect":"vectorEffect",version:"version",vertadvy:"vertAdvY","vert-adv-y":"vertAdvY",vertoriginx:"vertOriginX","vert-origin-x":"vertOriginX",vertoriginy:"vertOriginY","vert-origin-y":"vertOriginY",vhanging:"vHanging","v-hanging":"vHanging",videographic:"vIdeographic","v-ideographic":"vIdeographic",viewbox:"viewBox",viewtarget:"viewTarget",visibility:"visibility",vmathematical:"vMathematical","v-mathematical":"vMathematical",vocab:"vocab",widths:"widths",wordspacing:"wordSpacing","word-spacing":"wordSpacing",writingmode:"writingMode","writing-mode":"writingMode",x1:"x1",x2:"x2",x:"x",xchannelselector:"xChannelSelector",xheight:"xHeight","x-height":"xHeight",xlinkactuate:"xlinkActuate","xlink:actuate":"xlinkActuate",xlinkarcrole:"xlinkArcrole","xlink:arcrole":"xlinkArcrole",xlinkhref:"xlinkHref","xlink:href":"xlinkHref",xlinkrole:"xlinkRole","xlink:role":"xlinkRole",xlinkshow:"xlinkShow","xlink:show":"xlinkShow",xlinktitle:"xlinkTitle","xlink:title":"xlinkTitle",xlinktype:"xlinkType","xlink:type":"xlinkType",xmlbase:"xmlBase","xml:base":"xmlBase",xmllang:"xmlLang","xml:lang":"xmlLang",xmlns:"xmlns","xml:space":"xmlSpace",xmlnsxlink:"xmlnsXlink","xmlns:xlink":"xmlnsXlink",xmlspace:"xmlSpace",y1:"y1",y2:"y2",y:"y",ychannelselector:"yChannelSelector",z:"z",zoomandpan:"zoomAndPan"};function Ef(e){return ln(Of,e)&&Of[e]||e}function Af(e){var t,r=Tr(),n=Bt(Ar(e));try{for(n.s();!(t=n.n()).done;){var o=t.value,i=Ef(o);r[i]=e[o],"contentEditable"===i&&(r.suppressContentEditableWarning=!0)}}catch(a){n.e(a)}finally{n.f()}return r}function Nf(e){var t=Tr();for(var r in e)if(ln(e,r)){var n=e[r].toDOM;n&&(t[r]=n)}return t}var Rf=new WeakMap,Tf=new WeakMap;class Df{static renderSpec(e,t){if($r(e))return e;var r=e[0],n=Tr(),o=e[1],i=[],a=1;if(_r(o)&&!Jr(o))for(var s in a=2,o)null!=o[s]&&(n[s]=o[s]);for(var l=a;l<e.length;l++){var c=e[l];if(0===c)return(l<e.length-1||l>a)&&pn(!1),d(r,Af(n),t);i.push(Df.renderSpec(c,t))}return d(r,Af(n),...i)}static fromManager(e){return new Df(this.nodesFromManager(e),this.marksFromManager(e),e)}static nodesFromManager(e){var t=Nf(e.nodes);return t.text||(t.text=e=>e.text?e.text:""),t}static marksFromManager(e){return Nf(e.marks)}constructor(e,t,r){var n;Rf.set(this,{writable:!0,value:void 0}),Tf.set(this,{writable:!0,value:void 0}),this.nodes=e,this.marks=t,Wi(this,Rf,null!==(n=r.store.components)&&void 0!==n?n:Tr()),Wi(this,Tf,r.view)}serializeFragment(e){var t=[];return e.forEach((e=>{var r;r=this.serializeNode(e),e.marks.reverse().forEach((t=>{r=this.serializeMark(t,e.isInline,r)})),t.push(r)})),d(c,{},...t)}serializeNode(t){var r,n=Lt(this,Rf)[t.type.name],o=this.nodes[t.type.name];if(t.content.childCount>0&&(r=this.serializeFragment(t.content)),n){var i=n.Component,a=n.props;return e.createElement(i,f({},a,{node:t,view:Lt(this,Tf)}),r)}return o&&Df.renderSpec(o(t),r)}serializeMark(e,t,r){var n=this.marks[e.type.name];return n&&Df.renderSpec(n(e,t),r)}}function Pf(e){var t=v();return o((()=>{t.current=e}),[e]),t.current}var If=o,Vf=i(null);function zf(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.core,n=t.react,o=$t(t,["core","react"]);return Ad(e)?e:Ed.create((()=>[...cn(e),new wf(n),new vf(r)]),o)}function $f(e){var t,r=a(Vf),i=a(Id),s=v((t=Pt(n(Tr()),2)[1],m((()=>{t(Tr())}),[]))),l=null!=r?r:i;l||pn(!1);var c=l.addHandler;return o((()=>{var t=e;if(t){if(_r(t))t=t.autoUpdate?()=>s.current():void 0;if(Hr(t))return c("updated",t)}}),[c,e]),l}function Bf(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=v(e),i=v(t),a=n((()=>zf(e,t))),s=Pt(a,2),l=s[0],c=s[1];return r.current=e,i.current=t,o((()=>l.addHandler("destroy",(()=>{c((()=>zf(r.current,i.current).clone()))}))),[l]),l}class Hf{constructor(e,t){It(this,"dragging",null);var r=Vc();this.root=r,this.dom=r.createElement("div"),this.state=t.state}update(e){}setProps(e){}updateState(e){}someProp(e,t){return t?t(null):null}hasFocus(){return!1}focus(){}posAtCoords(e){return null}coordsAtPos(e){return{bottom:0,left:0,right:0,top:0}}domAtPos(e){return{node:this.dom,offset:0}}nodeDOM(e){return null}posAtDOM(e,t,r){return 0}endOfTextblock(e,t){return!0}destroy(){}dispatch(e){}}var Lf=t=>{var r=t.attributes,n=t.manager,o=t.state,i=t.editable,a=Af(r),s=Df.fromManager(n).serializeFragment(o.doc.content),l=n.store.ssrTransformer(s,o);return e.createElement("div",f({},a,{suppressContentEditableWarning:!0,contentEditable:i}),l)},_f=new WeakMap,Ff=new WeakMap,jf=new WeakMap;class Wf extends class{get updatableViewProps(){return{attributes:()=>this.getAttributes(),editable:()=>{var e;return null===(e=this.props.editable)||void 0===e||e},nodeViews:this.manager.store.nodeViews}}get firstRender(){return Lt(this,ad)}get props(){return Lt(this,od).call(this)}get previousState(){var e,t;return null!==(e=null!==(t=this.previousStateOverride)&&void 0!==t?t:Lt(this,id))&&void 0!==e?e:this.initialEditorState}get manager(){return this.props.manager}get view(){return this.manager.view}get document(){return Vc(this.props.forceEnvironment)}get uid(){return Lt(this,nd)}get initialEditorState(){return Lt(this,ld)}constructor(e){var t=this;nd.set(this,{writable:!0,value:en()}),od.set(this,{writable:!0,value:void 0}),id.set(this,{writable:!0,value:void 0}),ad.set(this,{writable:!0,value:!0}),sd.set(this,{writable:!0,value:_t()}),ld.set(this,{writable:!0,value:void 0}),It(this,"getState",(()=>{var e;return null!==(e=this.view.state)&&void 0!==e?e:this.initialEditorState})),It(this,"getPreviousState",(()=>this.previousState)),It(this,"dispatchTransaction",(e=>{var t,r,n;this.manager.destroyed&&pn(!1),e=null!==(t=null===(r=(n=this.props).onDispatchTransaction)||void 0===r?void 0:r.call(n,e,this.getState()))&&void 0!==t?t:e;var o=this.getState(),i=o.applyTransaction(e),a=i.state,s=i.transactions;Wi(this,id,o),this.updateState({state:a,tr:e,transactions:s});var l=this.manager.store.getForcedUpdates(e);Zr(l)||this.updateViewProps(...l)})),It(this,"onChange",(function(){var e,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Tr();null===(e=(r=t.props).onChange)||void 0===e||e.call(r,t.eventListenerParameter(n)),Lt(t,ad)&&Wi(t,ad,!1)})),It(this,"onBlur",(e=>{var t,r,n=this.eventListenerParameter();null===(t=(r=this.props).onBlur)||void 0===t||t.call(r,n,e),Lt(this,sd).emit("blur",n,e)})),It(this,"onFocus",(e=>{var t,r,n=this.eventListenerParameter();null===(t=(r=this.props).onFocus)||void 0===t||t.call(r,n,e),Lt(this,sd).emit("focus",n,e)})),It(this,"setContent",(function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.triggerChange,o=void 0!==n&&n,i=t.createStateFromContent(e);t.updateState({state:i,triggerChange:o})})),It(this,"clearContent",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.triggerChange,n=void 0!==r&&r;t.setContent(t.manager.createEmptyDoc(),{triggerChange:n})})),It(this,"focus",(e=>{if(!1!==e&&(!this.view.hasFocus()||void 0!==e&&!0!==e)){var t=this.manager.tr,r=t.selection,n=t.doc,o=r.from,i=void 0===o?0:o,a=r.to;void 0!==e&&!0!==e||(e={from:i,to:void 0===a?i:a}),this.dispatchSelection(t,Dc(e,n))}})),It(this,"blur",(()=>{var e=this.view.dom;this.view.hasFocus()&&Tc(e)&&e.blur()})),It(this,"getText",(e=>function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"\n\n",n=null!=e?e:t.getState(),o=n.doc;return o.textBetween(0,o.content.size,r)})),It(this,"getHTML",(e=>()=>$c({node:(null!=e?e:this.getState()).doc,schema:this.manager.store.schema,document:this.document}))),It(this,"getJSON",(e=>()=>(null!=e?e:this.getState()).toJSON())),It(this,"getRemirrorJSON",(e=>()=>(null!=e?e:this.getState()).doc.toJSON()));var r=e.getProps,n=e.createStateFromContent,o=e.initialEditorState,i=e.element;if(Wi(this,od,r),this.createStateFromContent=n,Wi(this,ld,o),this.manager.attachFramework(this,this.updateListener.bind(this)),!this.manager.view){var a=this.createView(o,i);this.manager.addView(a)}}updateListener(e){var t=e.state,r=e.tr;return Lt(this,sd).emit("updated",this.eventListenerParameter({state:t,tr:r}))}update(e){var t=e.getProps,r=e.createStateFromContent;return Wi(this,od,t),this.createStateFromContent=r,this}updateViewProps(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=wr(this.updatableViewProps,t);this.view.setProps(zt(zt({},this.view.props),n))}getAttributes(e){var t,r,n,o=this.props,i=o.attributes,a=o.autoFocus,s=null===(t=this.manager.store)||void 0===t?void 0:t.attributes,l=Hr(i)?i(this.eventListenerParameter()):i,c={};(a||Br(a))&&(c=e?{autoFocus:!0}:{autofocus:"true"});var u=zt(zt(zt(zt({role:"textbox"},c),{},{"aria-multiline":"true"},null===(r=this.props.editable)||void 0===r||r?{}:{"aria-readonly":"true"}),{},{"aria-label":null!==(n=this.props.label)&&void 0!==n?n:""},s),{},{class:Du(e&&"Prosemirror","remirror-editor",null==s?void 0:s.class)});return zt(zt({},u),l)}addFocusListeners(){this.view.dom.addEventListener("blur",this.onBlur),this.view.dom.addEventListener("focus",this.onFocus)}removeFocusListeners(){this.view.dom.removeEventListener("blur",this.onBlur),this.view.dom.removeEventListener("focus",this.onFocus)}destroy(){Lt(this,sd).emit("destroy"),this.view&&this.removeFocusListeners()}baseListenerParameter(e){var t=e.state,r=e.tr;return{tr:r,internalUpdate:!r,view:this.view,getHTML:this.getHTML(t),getJSON:this.getJSON(t),getRemirrorJSON:this.getRemirrorJSON(t),getText:this.getText(t)}}eventListenerParameter(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Tr(),t=e.state,r=e.tr;return zt(zt({firstRender:Lt(this,ad)},this.baseListenerParameter({tr:r,state:t})),{},{state:null!=t?t:this.getState(),createStateFromContent:this.createStateFromContent,previousState:this.previousState})}handleIosFocus(){wc.isIos&&this.view.dom.focus()}dispatchSelection(e,t){var r=e.setSelection(t);this.view.dispatch(r),this.handleIosFocus(),requestAnimationFrame((()=>{this.view.focus(),this.view.dispatch(this.manager.tr)}))}get baseOutput(){return zt(zt({},this.manager.store),{},{addHandler:Lt(this,sd).on.bind(Lt(this,sd)),uid:Lt(this,nd),view:this.view,getState:this.getState,getPreviousState:this.getPreviousState,getExtension:this.manager.getExtension.bind(this.manager),getPreset:this.manager.getPreset.bind(this.manager),clearContent:this.clearContent,setContent:this.setContent,focus:this.focus,blur:this.blur})}}{get shouldRenderClient(){return Lt(this,_f).call(this)}get name(){return"react"}constructor(e){var t;super(e),_f.set(this,{writable:!0,value:void 0}),Ff.set(this,{writable:!0,value:void 0}),jf.set(this,{writable:!0,value:void 0}),It(this,"rootPropsConfig",{called:!1,count:0}),It(this,"getRootProps",(e=>this.internalGetRootProps(e,null))),It(this,"internalGetRootProps",((e,t)=>{this.rootPropsConfig.called=!0;var r=null!=e?e:Tr(),n=r.refKey,o=void 0===n?"ref":n,i=r.ref,a=$t(r,["refKey","ref"]);return zt(zt({[o]:xf(i,this.onRef),key:this.uid},a),{},{children:null!=t?t:this.renderChildren(null)})})),It(this,"onRef",(e=>{e&&(this.rootPropsConfig.count+=1,this.rootPropsConfig.count<=1||pn(!1),Wi(this,jf,e),this.onRefLoad())}));var r=e.getShouldRenderClient,n=e.setShouldRenderClient;Wi(this,_f,r),Wi(this,Ff,n),this.manager.view?this.manager.view.setProps({state:this.manager.view.state,dispatchTransaction:this.dispatchTransaction,attributes:()=>this.getAttributes(),editable:()=>{var e;return null===(e=this.props.editable)||void 0===e||e}}):this.manager.getPreset(wf).setOptions({placeholder:null!==(t=this.props.placeholder)&&void 0!==t?t:""})}update(e){super.update(e);var t=e.getShouldRenderClient,r=e.setShouldRenderClient;return Wi(this,_f,t),Wi(this,Ff,r),this}createView(e){return t=void 0,r={state:e,nodeViews:this.manager.store.nodeViews,dispatchTransaction:this.dispatchTransaction,attributes:()=>this.getAttributes(),editable:()=>{var e;return null===(e=this.props.editable)||void 0===e||e}},new(Ic(this.props.forceEnvironment)?Tl:Hf)(t,r);var t,r}updateState(e){var t=e.state,r=e.triggerChange,n=void 0===r||r,o=e.tr,i=e.transactions;if(this.props.value)return this.props.onChange||pn(!1),n||pn(!1),this.previousStateOverride||(this.previousStateOverride=this.getState()),void this.onChange({state:t,tr:o});this.view.updateState(t),n&&this.onChange({state:t,tr:o}),this.manager.onStateUpdate({previousState:this.previousState,state:t,tr:o,transactions:i})}updateControlledState(e,t){this.previousStateOverride=t,this.view.updateState(e),this.manager.onStateUpdate({previousState:this.previousState,state:e}),this.previousStateOverride=void 0}addProsemirrorViewToDom(e,t){"start"===this.props.insertPosition?e.insertBefore(t,e.firstChild):e.append(t)}onRefLoad(){Lt(this,jf)||pn(!1);var e=this.props.autoFocus;this.addProsemirrorViewToDom(Lt(this,jf),this.view.dom),e&&this.focus(e),this.onChange(),this.addFocusListeners()}onMount(){this.props.suppressHydrationWarning&&Lt(this,Ff).call(this,!0)}onUpdate(e){this.props.editable!==e&&this.view&&Lt(this,jf)&&this.view.setProps(zt(zt({},this.view.props),{},{editable:()=>{var e;return null===(e=this.props.editable)||void 0===e||e}}))}get frameworkOutput(){return zt(zt({},this.baseOutput),{},{getRootProps:this.getRootProps,portalContainer:this.manager.store.portalContainer})}renderChildren(e){var t=this.props,r=t.forceEnvironment,n=t.insertPosition,o=void 0===n?"end":n,i=t.suppressHydrationWarning,a=Jr(e)?e:[e];if(Ic(r)&&(!i||this.shouldRenderClient))return a;var s=this.renderSSR();return("start"===o?[s,...a]:[...a,s]).map(Qd)}renderSSR(){var t;return e.createElement(Lf,{attributes:this.getAttributes(!0),state:this.getState(),manager:this.manager,editable:null===(t=this.props.editable)||void 0===t||t})}resetRender(){this.rootPropsConfig.called=!1,this.rootPropsConfig.count=0}}function Kf(e){var t,r=e.stringHandler,i=void 0===r?Uf:r,a=e.onError,s=e.manager,l=e.forceEnvironment,c=e.value,u=e.placeholder;np()&&!jr(u)&&s.getPreset(wf).setOptions({placeholder:u}),cp((()=>{jr(u)||s.getPreset(wf).setOptions({placeholder:u})}),[u,s]);var h=m(((e,t)=>s.createState({content:e,document:Vc(),stringHandler:i,selection:t,onError:a})),[a,l,s,i]),d=s.createEmptyDoc(),p=Pt(Jr(e.initialContent)?e.initialContent:[null!==(t=e.initialContent)&&void 0!==t?t:d],2),f=p[0],g=p[1],y=Dr(c)?c:h(f,g),w=Pt(n(!e.suppressHydrationWarning&&void 0),2),b=w[0],k=function(e){var t=v(e);t.current=e;var r=Pt(n((()=>new Wf(t.current))),2),i=r[0],a=r[1];return i.update(e),o((()=>{i.props.manager.addHandler("destroy",(()=>{a((()=>new Wf(t.current)))}))}),[i.props.manager]),i}({initialEditorState:y,setShouldRenderClient:w[1],createStateFromContent:h,getProps:()=>e,getShouldRenderClient:()=>b});o((()=>(k.onMount(),()=>{k.destroy()})),[k]);var x=Pf(e.editable);return o((()=>{k.onUpdate(x)}),[x,k]),function(e){var t=e.props.value,r=v(Dr(t)),n=Pf(t);bf((()=>{(t?!0===r.current:!1===r.current)||pn(!1),t&&t!==n&&e.updateControlledState(t,null!=n?n:void 0)}),[t,n,e])}(k),k.frameworkOutput}function Uf(){pn(!1)}var qf,Jf=()=>e.createElement("div",$f().getRootProps()),Zf=t=>{var r,i=t.children,a=t.autoRender,s=t.manager,l=t.combined,c=t.settings,u=Kf(zt(zt({},$t(t,["children","autoRender","manager","combined","settings"])),{},{manager:Bf(null!==(r=null!=s?s:l)&&void 0!==r?r:[],c)})),h=function(e){var t=Pt(n((()=>[...e.portals.entries()])),2),r=t[0],i=t[1];return o((()=>e.on((e=>{i([...e.entries()])}))),[e]),r}(u.portalContainer);return e.createElement(Vf.Provider,{value:u},e.createElement(Td,{portals:h,context:u}),("start"===a||!0===a)&&e.createElement(Jf,null),i,"end"===a&&e.createElement(Jf,null))};function Gf(e){var t=Pt(n([]),2),r=t[0],o=t[1],i=g((()=>function(e){return $r(e)?uf[e]:e}(e)),[e]),a=Pt(n([]),2),s=a[0],l=a[1];return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=$f().getExtension,o=g((()=>n(e)),[e,n]);if(If((()=>{!Hr(t)&&t&&o.setOptions(t)}),[o,t]),If((()=>{if(Hr(t))return t({addHandler:o.addHandler.bind(o),addCustomHandler:o.addCustomHandler.bind(o),extension:o})}),[o,t,...r]),!t);}(cf,m((e=>(0,e.addCustomHandler)("positioner",i)),[i]),[]),bf((()=>{var e=i.addListener("update",(e=>{var t,r=[],n=Bt(e);try{var o=function(){var e=t.value,n=e.id,o=e.setElement;r.push({id:n,ref:e=>{e&&o(e)}})};for(n.s();!(t=n.n()).done;)o()}catch(i){n.e(i)}finally{n.f()}l(r)})),t=i.addListener("done",(e=>{o(e)}));return()=>{e(),t()}}),[i]),s.map(((e,t)=>{var n,o=e.ref,a=e.id,s=null!==(n=r[t])&&void 0!==n?n:{},l=s.element,c=s.position,u=zt(zt({},of),c);return zt({ref:o,element:l,key:a,virtualNode:i.getVirtualNode(u)},c)}))}Zf.$$remirrorType=Jd.Provider;var Xf,Yf,Qf,ev=nh({defaultOptions:{levels:[1,2,3,4,5,6],defaultLevel:1},staticKeys:["defaultLevel","levels"]})(qf=class extends Ju{constructor(){super(...arguments),It(this,"tags",[Ut.BlockNode])}get name(){return"heading"}createNodeSpec(e){return{attrs:zt(zt({},e.defaults()),{},{level:{default:this.options.defaultLevel}}),content:"inline*",defining:!0,draggable:!1,parseDOM:this.options.levels.map((t=>({tag:"h".concat(t),getAttrs:r=>zt(zt({},e.parse(r)),{},{level:t})}))),toDOM:t=>this.options.levels.includes(t.attrs.level)?["h".concat(t.attrs.level),e.dom(t),0]:["h".concat(this.options.defaultLevel),e.dom(t),0]}}createCommands(){var e=this;return{toggleHeading:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Qc({type:e.type,toggleType:e.store.schema.nodes.paragraph,attrs:t})}}}createKeymap(){var e=Tr();return this.options.levels.forEach((t=>{e["Shift-Ctrl-".concat(t)]=Yc(this.type,{level:t})})),e}createInputRules(){return this.options.levels.map((e=>{return t=new RegExp("^(#{1,".concat(e,"})\\s$")),r=this.type,n=()=>({level:e}),new Li(t,(function(e,t,o,i){var a=e.doc.resolve(o),s=n instanceof Function?n(t):n;return a.node(-1).canReplaceWith(a.index(-1),a.indexAfter(-1),r)?e.tr.delete(o,i).setBlockType(o,o,r,s):null}));var t,r,n}))}})||qf,tv=nh({})(Xf=class extends Ju{constructor(){super(...arguments),It(this,"tags",[Ut.BlockNode])}get name(){return"blockquote"}createNodeSpec(e){return{attrs:e.defaults(),content:"block*",defining:!0,draggable:!1,parseDOM:[{tag:"blockquote",getAttrs:e.parse,priority:100}],toDOM:t=>["blockquote",e.dom(t),0]}}createCommands(){return{toggleBlockquote:()=>Xc(this.type)}}createKeymap(){return{"Ctrl->":Xc(this.type)}}createInputRules(){return[ji(/^\s*>\s$/,this.type)]}})||Xf,rv=new Set(["","0%","0pt","0px"]),nv=/rotate\(([\d.]+)rad\)/i,ov=nh({})(Yf=class extends Ju{constructor(){super(...arguments),It(this,"tags",[Ut.InlineNode])}get name(){return"image"}createNodeSpec(e){return{inline:!0,attrs:zt(zt({},e.defaults()),{},{align:{default:null},alt:{default:""},crop:{default:null},height:{default:null},width:{default:null},rotate:{default:null},src:{default:null},title:{default:""}}),draggable:!0,parseDOM:[{tag:"img[src]",getAttrs:t=>Tc(t)?function(e){var t,r,n,o=e.element,i=e.parse,a=function(e){var t,r,n,o,i=e.style,a=i.width,s=i.height;return a=null!==(t=null!==(r=a)&&void 0!==r?r:e.getAttribute("width"))&&void 0!==t?t:"",s=null!==(n=null!==(o=s)&&void 0!==o?o:e.getAttribute("height"))&&void 0!==n?n:"",{width:a,height:s}}(o),s=a.width,l=a.height,c=function(e){var t,r=e.style,n=r.cssFloat,o=r.display,i=null!==(t=e.getAttribute("data-align"))&&void 0!==t?t:e.getAttribute("align");i?i=/(left|right|center)/.test(i)?i:null:"left"!==n||o?"right"!==n||o?n||"block"!==o||(i="block"):i="right":i="left";return i}(o),u=function(e){var t=e.parentElement;if(!Tc(t))return null;var r=e.style,n=r.marginTop,o=r.marginLeft;if(!("inline-block"===t.style.display&&"hidden"===t.style.overflow&&t.style.width&&t.style.height&&o&&!rv.has(o)&&n)||rv.has(n))return null;return{width:Number.parseInt(t.style.width,10)||0,height:Number.parseInt(t.style.height,10)||0,left:Number.parseInt(o,10)||0,top:Number.parseInt(n,10)||0}}(o),h=function(e){var t=e.parentElement;if(!Tc(t))return null;if(!t.style.transform)return null;var r=t.style.transform.match(nv);if(!(null==r?void 0:r[1]))return null;return Number.parseFloat(r[1])||null}(o);return zt(zt({},i(o)),{},{align:c,alt:null!==(t=o.getAttribute("alt"))&&void 0!==t?t:null,crop:u,height:Number.parseInt(l||"0",10)||null,rotate:h,src:null!==(r=o.getAttribute("src"))&&void 0!==r?r:null,title:null!==(n=o.getAttribute("title"))&&void 0!==n?n:null,width:Number.parseInt(s||"0",10)||null})}({element:t,parse:e.parse}):{}}],toDOM:t=>{var r=Bc(t.attrs,e);return["img",zt(zt({},e.dom(t)),r)]}}}createCommands(){return{insertImage:e=>t=>{var r=t.tr,n=t.dispatch,o=r.selection,i=Dr(o.$cursor)?o.$cursor.pos:o.$to.pos,a=this.type.create(e);return null==n||n(r.insert(i,a)),!0}}}createPlugin(){return{props:{handleDOMEvents:{drop(e,t){var r,n,o=t;if(!(null===(r=o.dataTransfer)||void 0===r||null===(n=r.files)||void 0===n?void 0:n.length)||!o.dataTransfer)return!1;var i=[...o.dataTransfer.files].filter((e=>/^image\//i.test(e.type)));if(0===i.length)return!1;var a=e.state.schema,s=e.posAtCoords({left:o.clientX,top:o.clientY});return!!s&&(o.preventDefault(),i.forEach((t=>{var r=new FileReader;r.addEventListener("load",(t=>{var r=a.nodes.image.create({src:t.target&&t.target.result}),n=e.state.tr.insert(s.pos,r);e.dispatch(n)})),r.readAsDataURL(t)})),!0)}}}}}})||Yf;var iv,av,sv=nh({defaultOptions:{ignoredNodes:[],disableTags:!1,nodeName:"paragraph"}})(Qf=class extends Uu{get name(){return"trailingNode"}onSetOptions(e){var t=e.changes;(t.disableTags.changed||t.ignoredNodes.changed||t.nodeName.changed)&&(this.store.updateExtensionPlugins(this),this.store.reconfigureStatePlugins())}createPlugin(){var e=this.store,t=e.tags,r=e.schema,n=this.options,o=n.disableTags,i=n.ignoredNodes,a=n.nodeName,s=tn(o?[...i,a]:[...i,...t.lastNodeCompatible,a]),l=this.store.schema.nodes[a],c=Er(r.nodes).map((e=>Pt(e,2)[1])).filter((e=>!s.includes(e.name)));return{appendTransaction:(e,t,r)=>{var n=r.doc,o=this.getPluginState(r),i=n.content.size;if(o)return r.tr.insert(i,l.create())},state:{init:(e,t)=>_c({node:t.tr.doc.lastChild,types:c}),apply:(e,t)=>e.docChanged?_c({node:e.doc.lastChild,types:c}):t}}}})||Qf,lv=nh({defaultOptions:{autoLink:!1,defaultProtocol:"",selectTextOnClick:!1,openLinkOnClick:!1,autoLinkRegex:/(http:\/\/www\.|https:\/\/www\.|http:\/\/|https:\/\/)?[\da-z]+([.-][\da-z]+)*\.[a-z]{2,5}(:\d{1,5})?(\/\S*)?/},staticKeys:["autoLinkRegex"],handlerKeyOptions:{onClick:{earlyReturnValue:!0}},handlerKeys:["onActivateLink","onUpdateLink","onClick"]})(iv=class extends qu{constructor(){super(...arguments),It(this,"tags",[Ut.Link])}get name(){return"link"}createMarkSpec(e){var t="data-link-auto";return{attrs:zt(zt({},e.defaults()),{},{href:{},auto:{default:!1}}),inclusive:!1,parseDOM:[{tag:"a[href]",getAttrs:r=>{var n;if(!Tc(r))return!1;var o=r.getAttribute("href"),i=r.hasAttribute(t)||this.options.autoLinkRegex.test(null!==(n=r.textContent)&&void 0!==n?n:"");return zt(zt({},e.parse(r)),{},{href:o,auto:i})}}],toDOM:r=>{var n=Bc(r.attrs,e);n.auto;var o=$t(n,["auto"]),i=r.attrs.auto?{[t]:""}:{};return["a",zt(zt(zt({},e.dom(r)),o),{},{rel:"noopener noreferrer nofollow"},i),0]}}}onSetOptions(e){e.changes.autoLink.changed&&(!0===e.changes.autoLink.value&&this.store.addSuggester(this.createSuggesters()[0]),!1===e.changes.autoLink.value&&this.store.removeSuggester(this.name))}createKeymap(){return{"Mod-k":e=>{var t=e.state,r=e.dispatch,n=t.selection.empty?Ac(t):t.selection;if(!n)return!1;var o=n.from,i=n.to,a=t.tr.setSelection(wi.create(t.doc,o,i));return r&&r(a),this.options.onActivateLink(a.doc.textBetween(o,i)),!0}}}createCommands(){return{updateLink:(e,t)=>r=>{var n,o=r.tr,i=o.selection;return!!(xc(i)&&!Wc(o.selection)||Wr(n=i)&&n instanceof Si||Cc({trState:o,type:this.type})||t)&&(o.setMeta(this.name,{command:"updateLink",attrs:e,range:t}),function(e){return t=>{var r=t.dispatch,n=t.tr,o=e.type,i=e.attrs,a=void 0===i?Tr():i,s=e.appendText,l=e.range,c=l?wi.create(n.doc,l.from,l.to):n.selection,u=c.$from,h=c.from,d=c.to,p=0===u.depth&&n.doc.type.allowsMarkType(o);return n.doc.nodesBetween(h,d,(e=>{if(p)return!1;e.inlineContent&&e.type.allowsMarkType(o)&&(p=!0)})),!!p&&(null==r||r(n.addMark(h,d,o.create(a))&&s?n.insertText(s):n),!0)}}({type:this.type,attrs:e,range:t})(r))},removeLink:e=>t=>!!Cc(zt({trState:t.tr,type:this.type},e))&&tu({type:this.type,expand:!0,range:e})(t)}}createPasteRules(){return this.options.autoLink?[]:[ru({regexp:/https?:\/\/(www\.)?[\w#%+.:=@~-]{2,256}\.[a-z]{2,6}\b([\w#%&+./:=?@~-]*)/gi,type:this.type,getAttributes:e=>({href:Nc(e),auto:!0})})]}createSuggesters(){return this.options.autoLink?[{name:this.name,matchOffset:0,supportedCharacters:/$/,char:this.options.autoLinkRegex,priority:Zt.Lowest,caseInsensitive:!0,disableDecorations:!0,appendTransaction:!0,checkNextValidSelection:(t,r)=>{var n,o=Ec(t,this.type);if(o&&((null===(n=e)||void 0===n?void 0:n.from)!==t.pos||e.to!==o.to)&&o.mark.attrs.auto){var i=o.mark,a=o.from,s=o.to,l=cv(t.doc.textBetween(a,s,"￼"," "),this.options.defaultProtocol);if(a!==o.from||s!==o.to||i.attrs.href!==l){var c=this.store.helpers.getSuggestMethods,u=this.store.chain,h=u.updateLink,d=u.removeLink,p=u.custom,f=u.restore,v=c().findMatchAtPosition,m=r.selection;e={from:t.pos,to:s},p(r),d(e),eu(m,r);var g=v(t,this.name);if(g){var y=g.range;h({href:cv(g.text.full,this.options.defaultProtocol),auto:!0},y)}f()}}},onChange:(e,t)=>{var r=t.selection,n=e.text,o=e.range,i=e.exitReason,a=e.setMarkRemoved,s=cv(n.full,this.options.defaultProtocol),l=this.store.chain,c=l.updateLink,u=l.removeLink,h=l.custom,d=l.restore,p=(0,this.store.helpers.getSuggestMethods)().findMatchAtPosition;if(i){var f=_l(i),v=function(e){return e===$l.Removed}(i);if(f||v)try{(()=>{var e,n;h(t);var i,s,l=Bt(sn(o.from,o.to));try{for(l.s();!(i=l.n()).done;){var f=i.value;if(n=Ec(t.doc.resolve(f),this.type))break}}catch(w){l.e(w)}finally{l.f()}u(null!==(e=n)&&void 0!==e?e:o);var v,m=Bt(sn(t.selection.to,Math.min(t.selection.$to.end(),t.doc.nodeSize-2)));try{for(m.s();!(v=m.n()).done;){var g=v.value;if(s=Ec(t.doc.resolve(g),this.type))break}}catch(w){m.e(w)}finally{m.f()}s&&u(s),eu(r,t);var y=p(t.doc.resolve(Math.min(o.from+1,t.doc.nodeSize-2)),this.name);y?c({href:cv(y.text.full,this.options.defaultProtocol),auto:!0},y.range):a(),d()})()}catch(x){return}}else{var m,g,y=Bt(sn(o.from,o.to));try{for(y.s();!(g=y.n()).done;){var w,b=g.value;if(!1===(null===(w=m=Ec(t.doc.resolve(b),this.type))||void 0===w?void 0:w.mark.attrs.auto))return;if(m)break}}catch(S){y.e(S)}finally{y.f()}m&&m.from===o.from&&m.to===o.to&&m.mark.attrs.auto&&m.mark.attrs.href===s||k()}function k(){h(t),c({href:s,auto:!0},o),eu(r,t),d()}}}]:[];var e}createEventHandlers(){return{clickMark:(e,t)=>{var r=t.getMark(this.type);if(r){var n=r.mark.attrs,o=zt(zt({},n),r);if(this.options.onClick(e,o))return!0;var i=!1;if(this.options.openLinkOnClick){i=!0;var a=n.href;window.open(a,"_blank")}return this.options.selectTextOnClick&&(i=!0,this.store.commands.selectText(r)),i}}}}createPlugin(){return{props:{handleClick:(e,t)=>{if(!this.options.selectTextOnClick&&!this.options.openLinkOnClick)return!1;var r=e.state,n=r.doc,o=r.tr,i=Ec(n.resolve(t),this.type);if(!i)return!1;if(this.options.openLinkOnClick){var a=i.mark.attrs.href;window.open(a,"_blank")}if(this.options.selectTextOnClick){var s=n.resolve(i.from),l=n.resolve(i.to),c=o.setSelection(new wi(s,l));e.dispatch(c)}return!0}},appendTransaction:(e,t,r)=>{var n=e.filter((e=>!!e.getMeta(this.name)));0!==n.length&&n.forEach((e=>{var t=e.getMeta(this.name);if("updateLink"===t.command){var n=t.range,o=t.attrs,i=r.selection,a=r.doc,s={range:n,selection:i,doc:a,attrs:o},l=null!=n?n:i,c=l.from,u=l.to;this.options.onUpdateLink(a.textBetween(c,u),s)}}))}}}})||iv;function cv(e,t){return e.startsWith("http")||e.startsWith("//")?e:"".concat(t,"//").concat(e)}var uv,hv,dv,pv=nh({defaultOptions:{weight:void 0},staticKeys:["weight"]})(av=class extends qu{constructor(){super(...arguments),It(this,"tags",[Ut.FormattingMark,Ut.FontStyle])}get name(){return"bold"}createMarkSpec(e){return{attrs:e.defaults(),parseDOM:[{tag:"strong",getAttrs:e.parse},{tag:"b",getAttrs:t=>!(!Tc(t)||"normal"===t.style.fontWeight)&&e.parse(t)},{style:"font-weight",getAttrs:e=>!(!$r(e)||!/^(bold(er)?|[5-9]\d{2,})$/.test(e))&&null}],toDOM:t=>{var r=this.options.weight;return r?["strong",{"font-weight":r.toString()},0]:["strong",e.dom(t),0]}}}createKeymap(){return{"Mod-b":mh({type:this.type})}}createInputRules(){return[nu({regexp:/(?:\*\*|__)([^*_]+)(?:\*\*|__)$/,type:this.type,ignoreWhitespace:!0})]}createCommands(){return{toggleBold:e=>mh({type:this.type,range:e}),setBold:e=>t=>{var r=t.tr,n=t.dispatch;return null==n||n(r.addMark(null==e?void 0:e.from,null==e?void 0:e.to,this.type.create())),!0},removeBold:e=>t=>{var r=t.tr,n=t.dispatch;return null==n||n(r.removeMark(null==e?void 0:e.from,null==e?void 0:e.to,this.type)),!0}}}})||av,fv=nh({})(uv=class extends qu{constructor(){super(...arguments),It(this,"tags",[Ut.FontStyle])}get name(){return"italic"}createMarkSpec(e){return{attrs:e.defaults(),parseDOM:[{tag:"i",getAttrs:e.parse},{tag:"em",getAttrs:e.parse},{style:"font-style=italic"}],toDOM:t=>["em",e.dom(t),0]}}createKeymap(){return{"Mod-i":mh({type:this.type})}}createCommands(){return{toggleItalic:e=>mh({type:this.type,range:e})}}createInputRules(){return[nu({regexp:/(?:^|[^*])\*([^*]+)\*$/,type:this.type,ignoreWhitespace:!0,updateCaptured:e=>{var t=e.fullMatch,r=e.start;return t.startsWith("*")?{}:{fullMatch:t.slice(1),start:r+1}}}),nu({regexp:/(?:^|[^_])_([^_]+)_$/,type:this.type,ignoreWhitespace:!0,updateCaptured:e=>{var t=e.fullMatch,r=e.start;return t.startsWith("_")?{}:{fullMatch:t.slice(1),start:r+1}}})]}createPasteRules(){return[ru({regexp:/_([^_]+)_/g,type:this.type}),ru({regexp:/\*([^*]+)\*/g,type:this.type})]}})||uv,vv=nh({})(hv=class extends qu{constructor(){super(...arguments),It(this,"tags",[Ut.FontStyle])}get name(){return"underline"}createMarkSpec(e){return{attrs:e.defaults(),parseDOM:[{tag:"u",getAttrs:e.parse},{style:"text-decoration",getAttrs:e=>"underline"===e&&{}}],toDOM:t=>["u",e.dom(t),0]}}createKeymap(){return{"Mod-u":mh({type:this.type})}}createCommands(){return{toggleUnderline:()=>mh({type:this.type})}}})||hv;function mv(e,t){return function(r,n){var o=r.selection,i=o.$from,a=o.$to,s=i.blockRange(a),l=!1,c=s;if(!s)return!1;if(s.depth>=2&&i.node(s.depth-1).type.compatibleContent(e)&&0==s.startIndex){if(0==i.index(s.depth-1))return!1;var u=r.doc.resolve(s.start-2);c=new Un(u,u,s.depth),s.endIndex<s.parent.childCount&&(s=new Un(i,r.doc.resolve(a.end(s.depth)),s.depth)),l=!0}var h=Yo(c,e,t,s);return!!h&&(n&&n(function(e,t,r,n,o){for(var i=kn.empty,a=r.length-1;a>=0;a--)i=kn.from(r[a].type.create(r[a].attrs,i));e.step(new Jo(t.start-(n?2:0),t.end,t.start,t.end,new An(i,0,0),r.length,!0));for(var s=0,l=0;l<r.length;l++)r[l].type==o&&(s=l+1);for(var c=r.length-s,u=t.start+r.length-(n?2:0),h=t.parent,d=t.startIndex,p=t.endIndex,f=!0;d<p;d++,f=!1)!f&&ei(e.doc,u,c)&&(e.split(u,c),u+=2*c),u+=h.child(d).nodeSize;return e}(r.tr,s,h,l,e).scrollIntoView()),!0)}}function gv(e){return function(t,r){var n=t.selection,o=n.$from,i=n.$to,a=o.blockRange(i,(function(t){return t.childCount&&t.firstChild.type==e}));return!!a&&(!r||(o.node(a.depth-1).type==e?function(e,t,r,n){var o=e.tr,i=n.end,a=n.$to.end(n.depth);i<a&&(o.step(new Jo(i-1,a,i,a,new An(kn.from(r.create(null,n.parent.copy())),1,0),1,!0)),n=new Un(o.doc.resolve(n.$from.pos),o.doc.resolve(a),n.depth));return t(o.lift(n,Xo(n)).scrollIntoView()),!0}(t,r,e,a):function(e,t,r){for(var n=e.tr,o=r.parent,i=r.end,a=r.endIndex-1,s=r.startIndex;a>s;a--)i-=o.child(a).nodeSize,n.delete(i-1,i+1);var l=n.doc.resolve(r.start),c=l.nodeAfter,u=0==r.startIndex,h=r.endIndex==o.childCount,d=l.node(-1),p=l.index(-1);if(!d.canReplace(p+(u?0:1),p+1,c.content.append(h?kn.empty:kn.from(o))))return!1;var f=l.pos,v=f+c.nodeSize;return n.step(new Jo(f-(u?1:0),v+(h?1:0),f+1,v-1,new An((u?kn.empty:kn.from(o.copy(kn.empty))).append(h?kn.empty:kn.from(o.copy(kn.empty))),u?0:1,h?0:1),u?0:1)),t(n.scrollIntoView()),!0}(t,r,a)))}}function yv(e){return function(t,r){var n=t.selection,o=n.$from,i=n.$to,a=o.blockRange(i,(function(t){return t.childCount&&t.firstChild.type==e}));if(!a)return!1;var s=a.startIndex;if(0==s)return!1;var l=a.parent,c=l.child(s-1);if(c.type!=e)return!1;if(r){var u=c.lastChild&&c.lastChild.type==l.type,h=kn.from(u?e.create():null),d=new An(kn.from(e.create(null,kn.from(l.type.create(null,h)))),u?3:1,0),p=a.start,f=a.end;r(t.tr.step(new Jo(p-(u?3:1),f,p,f,d,1,!0)).scrollIntoView())}return!0}}function wv(e,t){var r;return!(!(null===(r=e.type.spec.group)||void 0===r?void 0:r.includes(Ut.ListContainerNode))&&e.type!==t.nodes.bulletList&&e.type!==t.nodes.orderedList)}function bv(e,t){return r=>{var n=r.dispatch,o=r.tr,i=fn(o,r.state),a=i.schema,s=o.selection,l=s.$from,c=s.$to,u=l.blockRange(c);if(!u)return!1;var h=Fc({predicate:e=>wv(e,a),selection:s});if(u.depth>=1&&h&&u.depth-h.depth<=1){if(h.node.type===e)return gv(t)(i,n);if(wv(h.node,a)&&e.validContent(h.node.content))return n&&n(o.setNodeMarkup(h.pos,e)),!0}return mv(e)(i,n)}}var kv,xv,Sv,Mv,Cv,Ov=nh({})(dv=class extends Ju{constructor(){super(...arguments),It(this,"tags",[Ut.BlockNode,Ut.ListContainerNode])}get name(){return"bulletList"}createNodeSpec(e){return{attrs:e.defaults(),content:"listItem+",parseDOM:[{tag:"ul",getAttrs:e.parse}],toDOM:t=>["ul",e.dom(t),0]}}createCommands(){return{toggleBulletList:()=>bv(this.type,this.store.schema.nodes.listItem)}}createKeymap(){return{"Shift-Ctrl-8":bv(this.type,this.store.schema.nodes.listItem)}}createInputRules(){return[ji(/^\s*([*+-])\s$/,this.type)]}})||dv,Ev=nh({})(kv=class extends Ju{constructor(){super(...arguments),It(this,"tags",[Ut.ListItemNode])}get name(){return"listItem"}createNodeSpec(e){return{attrs:e.defaults(),content:"paragraph block*",defining:!0,draggable:!1,parseDOM:[{tag:"li",getAttrs:e.parse}],toDOM:t=>["li",e.dom(t),0]}}createKeymap(){return{Enter:vn((e=this.type,function(t,r){var n=t.selection,o=n.$from,i=n.$to,a=n.node;if(a&&a.isBlock||o.depth<2||!o.sameParent(i))return!1;var s=o.node(-1);if(s.type!=e)return!1;if(0==o.parent.content.size&&o.node(-1).childCount==o.indexAfter(-1)){if(2==o.depth||o.node(-3).type!=e||o.index(-2)!=o.node(-2).childCount-1)return!1;if(r){for(var l=kn.empty,c=o.index(-1)>0,u=o.depth-(c?1:2);u>=o.depth-3;u--)l=kn.from(o.node(u).copy(l));l=l.append(kn.from(e.createAndFill()));var h=t.tr.replace(o.before(c?null:-1),o.after(-3),new An(l,c?3:2,2));h.setSelection(t.selection.constructor.near(h.doc.resolve(o.pos+(c?3:2)))),r(h.scrollIntoView())}return!0}var d=i.pos==o.end()?s.contentMatchAt(0).defaultType:null,p=t.tr.delete(o.pos,i.pos),f=d&&[null,{type:d}];return!!ei(p.doc,o.pos,2,f)&&(r&&r(p.split(o.pos,2,f).scrollIntoView()),!0)})),Tab:vn(yv(this.type)),"Shift-Tab":vn(gv(this.type))};var e}})||kv,Av=nh({})(xv=class extends Ju{constructor(){super(...arguments),It(this,"tags",[Ut.BlockNode,Ut.ListContainerNode])}get name(){return"orderedList"}createNodeSpec(e){return{attrs:zt(zt({},e.defaults()),{},{order:{default:1}}),content:"listItem+",parseDOM:[{tag:"ol",getAttrs:t=>{var r;return Tc(t)?zt(zt({},e.parse(t)),{},{order:+(null!==(r=t.getAttribute("start"))&&void 0!==r?r:1)}):{}}}],toDOM:t=>{var r=e.dom(t);return 1===t.attrs.order?["ol",r,0]:["ol",zt(zt({},r),{},{start:t.attrs.order}),0]}}}createCommands(){return{toggleOrderedList:()=>bv(this.type,this.store.schema.nodes.listItem)}}createKeymap(){return{"Shift-Ctrl-9":bv(this.type,this.store.schema.nodes.listItem)}}createInputRules(){return[ji(/^(\d+)\.\s$/,this.type,(e=>({order:+e[1]})),((e,t)=>t.childCount+t.attrs.order===+e[1]))]}})||xv,Nv=oh({})(Sv=class extends hh{get name(){return"list"}onSetOptions(e){}createExtensions(){return[new Av,new Ov,new Ev]}})||Sv;if("undefined"!=typeof WeakMap){var Rv=new WeakMap;Mv=function(e){return Rv.get(e)},Cv=function(e,t){return Rv.set(e,t),t}}else{var Tv=[],Dv=0;Mv=function(e){for(var t=0;t<Tv.length;t+=2)if(Tv[t]==e)return Tv[t+1]},Cv=function(e,t){return 10==Dv&&(Dv=0),Tv[Dv++]=e,Tv[Dv++]=t}}var Pv=function(e,t,r,n){this.left=e,this.top=t,this.right=r,this.bottom=n},Iv=function(e,t,r,n){this.width=e,this.height=t,this.map=r,this.problems=n};function Vv(e){if(e.colwidth)return e.colwidth.slice();for(var t=[],r=0;r<e.colspan;r++)t.push(0);return t}function zv(e){var t=e.cached.tableNodeTypes;if(!t)for(var r in t=e.cached.tableNodeTypes={},e.nodes){var n=e.nodes[r],o=n.spec.tableRole;o&&(t[o]=n)}return t}Iv.prototype.findCell=function(e){for(var t=0;t<this.map.length;t++){var r=this.map[t];if(r==e){for(var n=t%this.width,o=t/this.width|0,i=n+1,a=o+1,s=1;i<this.width&&this.map[t+s]==r;s++)i++;for(var l=1;a<this.height&&this.map[t+this.width*l]==r;l++)a++;return new Pv(n,o,i,a)}}throw new RangeError("No cell with offset "+e+" found")},Iv.prototype.colCount=function(e){for(var t=0;t<this.map.length;t++)if(this.map[t]==e)return t%this.width;throw new RangeError("No cell with offset "+e+" found")},Iv.prototype.nextCell=function(e,t,r){var n=this.findCell(e),o=n.left,i=n.right,a=n.top,s=n.bottom;return"horiz"==t?(r<0?0==o:i==this.width)?null:this.map[a*this.width+(r<0?o-1:i)]:(r<0?0==a:s==this.height)?null:this.map[o+this.width*(r<0?a-1:s)]},Iv.prototype.rectBetween=function(e,t){var r=this.findCell(e),n=r.left,o=r.right,i=r.top,a=r.bottom,s=this.findCell(t),l=s.left,c=s.right,u=s.top,h=s.bottom;return new Pv(Math.min(n,l),Math.min(i,u),Math.max(o,c),Math.max(a,h))},Iv.prototype.cellsInRect=function(e){for(var t=[],r={},n=e.top;n<e.bottom;n++)for(var o=e.left;o<e.right;o++){var i=n*this.width+o,a=this.map[i];r[a]||(r[a]=!0,o==e.left&&o&&this.map[i-1]==a||n==e.top&&n&&this.map[i-this.width]==a||t.push(a))}return t},Iv.prototype.positionAt=function(e,t,r){for(var n=0,o=0;;n++){var i=o+r.child(n).nodeSize;if(n==e){for(var a=t+e*this.width,s=(e+1)*this.width;a<s&&this.map[a]<o;)a++;return a==s?i-1:this.map[a]}o=i}},Iv.get=function(e){return Mv(e)||Cv(e,function(e){if("table"!=e.type.spec.tableRole)throw new RangeError("Not a table node: "+e.type.name);for(var t=function(e){for(var t=-1,r=!1,n=0;n<e.childCount;n++){var o=e.child(n),i=0;if(r)for(var a=0;a<n;a++)for(var s=e.child(a),l=0;l<s.childCount;l++){var c=s.child(l);a+c.attrs.rowspan>n&&(i+=c.attrs.colspan)}for(var u=0;u<o.childCount;u++){var h=o.child(u);i+=h.attrs.colspan,h.attrs.rowspan>1&&(r=!0)}-1==t?t=i:t!=i&&(t=Math.max(t,i))}return t}(e),r=e.childCount,n=[],o=0,i=null,a=[],s=0,l=t*r;s<l;s++)n[s]=0;for(var c=0,u=0;c<r;c++){var h=e.child(c);u++;for(var d=0;;d++){for(;o<n.length&&0!=n[o];)o++;if(d==h.childCount)break;for(var p=h.child(d),f=p.attrs,v=f.colspan,m=f.rowspan,g=f.colwidth,y=0;y<m;y++){if(y+c>=r){(i||(i=[])).push({type:"overlong_rowspan",pos:u,n:m-y});break}for(var w=o+y*t,b=0;b<v;b++){0==n[w+b]?n[w+b]=u:(i||(i=[])).push({type:"collision",row:c,pos:u,n:v-b});var k=g&&g[b];if(k){var x=(w+b)%t*2,S=a[x];null==S||S!=k&&1==a[x+1]?(a[x]=k,a[x+1]=1):S==k&&a[x+1]++}}}o+=v,u+=p.nodeSize}for(var M=(c+1)*t,C=0;o<M;)0==n[o++]&&C++;C&&(i||(i=[])).push({type:"missing",row:c,n:C}),u++}for(var O=new Iv(t,r,n,i),E=!1,A=0;!E&&A<a.length;A+=2)null!=a[A]&&a[A+1]<r&&(E=!0);E&&function(e,t,r){e.problems||(e.problems=[]);for(var n=0,o={};n<e.map.length;n++){var i=e.map[n];if(!o[i]){o[i]=!0;for(var a=r.nodeAt(i),s=null,l=0;l<a.attrs.colspan;l++){var c=t[2*((n+l)%e.width)];null==c||a.attrs.colwidth&&a.attrs.colwidth[l]==c||((s||(s=Vv(a.attrs)))[l]=c)}s&&e.problems.unshift({type:"colwidth mismatch",pos:i,colwidth:s})}}}(O,a,e);return O}(e))};var $v=new Hi("selectingCells");function Bv(e){for(var t=e.depth-1;t>0;t--)if("row"==e.node(t).type.spec.tableRole)return e.node(0).resolve(e.before(t+1));return null}function Hv(e){for(var t=e.selection.$head,r=t.depth;r>0;r--)if("row"==t.node(r).type.spec.tableRole)return!0;return!1}function Lv(e){var t=e.selection;return t.$anchorCell?t.$anchorCell.pos>t.$headCell.pos?t.$anchorCell:t.$headCell:t.node&&"cell"==t.node.type.spec.tableRole?t.$anchor:Bv(t.$head)||function(e){for(var t=e.nodeAfter,r=e.pos;t;t=t.firstChild,r++){var n=t.type.spec.tableRole;if("cell"==n||"header_cell"==n)return e.doc.resolve(r)}for(var o=e.nodeBefore,i=e.pos;o;o=o.lastChild,i--){var a=o.type.spec.tableRole;if("cell"==a||"header_cell"==a)return e.doc.resolve(i-o.nodeSize)}}(t.$head)}function _v(e){return"row"==e.parent.type.spec.tableRole&&e.nodeAfter}function Fv(e,t){return e.depth==t.depth&&e.pos>=t.start(-1)&&e.pos<=t.end(-1)}function jv(e,t,r){var n=e.start(-1),o=Iv.get(e.node(-1)).nextCell(e.pos-n,t,r);return null==o?null:e.node(0).resolve(n+o)}function Wv(e,t,r){var n={};for(var o in e)n[o]=e[o];return n[t]=r,n}function Kv(e,t,r){void 0===r&&(r=1);var n=Wv(e,"colspan",e.colspan-r);return n.colwidth&&(n.colwidth=n.colwidth.slice(),n.colwidth.splice(t,r),n.colwidth.some((function(e){return e>0}))||(n.colwidth=null)),n}function Uv(e,t,r){void 0===r&&(r=1);var n=Wv(e,"colspan",e.colspan+r);if(n.colwidth){n.colwidth=n.colwidth.slice();for(var o=0;o<r;o++)n.colwidth.splice(t,0,0)}return n}var qv=function(e){function t(t,r){void 0===r&&(r=t);var n=t.node(-1),o=Iv.get(n),i=t.start(-1),a=o.rectBetween(t.pos-i,r.pos-i),s=t.node(0),l=o.cellsInRect(a).filter((function(e){return e!=r.pos-i}));l.unshift(r.pos-i);var c=l.map((function(e){var t=n.nodeAt(e),r=e+i+1;return new yi(s.resolve(r),s.resolve(r+t.content.size))}));e.call(this,c[0].$from,c[0].$to,c),this.$anchorCell=t,this.$headCell=r}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.map=function(e,r){var n=e.resolve(r.map(this.$anchorCell.pos)),o=e.resolve(r.map(this.$headCell.pos));if(_v(n)&&_v(o)&&Fv(n,o)){var i=this.$anchorCell.node(-1)!=n.node(-1);return i&&this.isRowSelection()?t.rowSelection(n,o):i&&this.isColSelection()?t.colSelection(n,o):new t(n,o)}return wi.between(n,o)},t.prototype.content=function(){for(var e=this.$anchorCell.node(-1),t=Iv.get(e),r=this.$anchorCell.start(-1),n=t.rectBetween(this.$anchorCell.pos-r,this.$headCell.pos-r),o={},i=[],a=n.top;a<n.bottom;a++){for(var s=[],l=a*t.width+n.left,c=n.left;c<n.right;c++,l++){var u=t.map[l];if(!o[u]){o[u]=!0;var h=t.findCell(u),d=e.nodeAt(u),p=n.left-h.left,f=h.right-n.right;if(p>0||f>0){var v=d.attrs;p>0&&(v=Kv(v,0,p)),f>0&&(v=Kv(v,v.colspan-f,f)),d=h.left<n.left?d.type.createAndFill(v):d.type.create(v,d.content)}if(h.top<n.top||h.bottom>n.bottom){var m=Wv(d.attrs,"rowspan",Math.min(h.bottom,n.bottom)-Math.max(h.top,n.top));d=h.top<n.top?d.type.createAndFill(m):d.type.create(m,d.content)}s.push(d)}}i.push(e.child(a).copy(kn.from(s)))}var g=this.isColSelection()&&this.isRowSelection()?e:i;return new An(kn.from(g),1,1)},t.prototype.replace=function(t,r){void 0===r&&(r=An.empty);for(var n=t.steps.length,o=this.ranges,i=0;i<o.length;i++){var a=o[i],s=a.$from,l=a.$to,c=t.mapping.slice(n);t.replace(c.map(s.pos),c.map(l.pos),i?An.empty:r)}var u=e.findFrom(t.doc.resolve(t.mapping.slice(n).map(this.to)),-1);u&&t.setSelection(u)},t.prototype.replaceWith=function(e,t){this.replace(e,new An(kn.from(t),0,0))},t.prototype.forEachCell=function(e){for(var t=this.$anchorCell.node(-1),r=Iv.get(t),n=this.$anchorCell.start(-1),o=r.cellsInRect(r.rectBetween(this.$anchorCell.pos-n,this.$headCell.pos-n)),i=0;i<o.length;i++)e(t.nodeAt(o[i]),n+o[i])},t.prototype.isColSelection=function(){var e=this.$anchorCell.index(-1),t=this.$headCell.index(-1);if(Math.min(e,t)>0)return!1;var r=e+this.$anchorCell.nodeAfter.attrs.rowspan,n=t+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(r,n)==this.$headCell.node(-1).childCount},t.colSelection=function(e,r){void 0===r&&(r=e);var n=Iv.get(e.node(-1)),o=e.start(-1),i=n.findCell(e.pos-o),a=n.findCell(r.pos-o),s=e.node(0);return i.top<=a.top?(i.top>0&&(e=s.resolve(o+n.map[i.left])),a.bottom<n.height&&(r=s.resolve(o+n.map[n.width*(n.height-1)+a.right-1]))):(a.top>0&&(r=s.resolve(o+n.map[a.left])),i.bottom<n.height&&(e=s.resolve(o+n.map[n.width*(n.height-1)+i.right-1]))),new t(e,r)},t.prototype.isRowSelection=function(){var e=Iv.get(this.$anchorCell.node(-1)),t=this.$anchorCell.start(-1),r=e.colCount(this.$anchorCell.pos-t),n=e.colCount(this.$headCell.pos-t);if(Math.min(r,n)>0)return!1;var o=r+this.$anchorCell.nodeAfter.attrs.colspan,i=n+this.$headCell.nodeAfter.attrs.colspan;return Math.max(o,i)==e.width},t.prototype.eq=function(e){return e instanceof t&&e.$anchorCell.pos==this.$anchorCell.pos&&e.$headCell.pos==this.$headCell.pos},t.rowSelection=function(e,r){void 0===r&&(r=e);var n=Iv.get(e.node(-1)),o=e.start(-1),i=n.findCell(e.pos-o),a=n.findCell(r.pos-o),s=e.node(0);return i.left<=a.left?(i.left>0&&(e=s.resolve(o+n.map[i.top*n.width])),a.right<n.width&&(r=s.resolve(o+n.map[n.width*(a.top+1)-1]))):(a.left>0&&(r=s.resolve(o+n.map[a.top*n.width])),i.right<n.width&&(e=s.resolve(o+n.map[n.width*(i.top+1)-1]))),new t(e,r)},t.prototype.toJSON=function(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}},t.fromJSON=function(e,r){return new t(e.resolve(r.anchor),e.resolve(r.head))},t.create=function(e,r,n){return void 0===n&&(n=r),new t(e.resolve(r),e.resolve(n))},t.prototype.getBookmark=function(){return new Jv(this.$anchorCell.pos,this.$headCell.pos)},t}(mi);qv.prototype.visible=!1,mi.jsonID("cell",qv);var Jv=function(e,t){this.anchor=e,this.head=t};function Zv(e){if(!(e.selection instanceof qv))return null;var t=[];return e.selection.forEachCell((function(e,r){t.push(ml.node(r,r+e.nodeSize,{class:"selectedCell"}))})),bl.create(e.doc,t)}function Gv(e){if(!e.size)return null;for(var t=e.content,r=e.openStart,n=e.openEnd;1==t.childCount&&(r>0&&n>0||"table"==t.firstChild.type.spec.tableRole);)r--,n--,t=t.firstChild.content;var o=t.firstChild,i=o.type.spec.tableRole,a=o.type.schema,s=[];if("row"==i)for(var l=0;l<t.childCount;l++){var c=t.child(l).content,u=l?0:Math.max(0,r-1),h=l<t.childCount-1?0:Math.max(0,n-1);(u||h)&&(c=Xv(zv(a).row,new An(c,u,h)).content),s.push(c)}else{if("cell"!=i&&"header_cell"!=i)return null;s.push(r||n?Xv(zv(a).row,new An(t,r,n)).content:t)}return function(e,t){for(var r=[],n=0;n<t.length;n++)for(var o=t[n],i=o.childCount-1;i>=0;i--)for(var a=o.child(i).attrs,s=a.rowspan,l=a.colspan,c=n;c<n+s;c++)r[c]=(r[c]||0)+l;for(var u=0,h=0;h<r.length;h++)u=Math.max(u,r[h]);for(var d=0;d<r.length;d++)if(d>=t.length&&t.push(kn.empty),r[d]<u){for(var p=zv(e).cell.createAndFill(),f=[],v=r[d];v<u;v++)f.push(p);t[d]=t[d].append(kn.from(f))}return{height:t.length,width:u,rows:t}}(a,s)}function Xv(e,t){var r=e.createAndFill();return new _o(r).replace(0,r.content.size,t).doc}function Yv(e,t,r,n,o,i,a,s){if(0==a||a==t.height)return!1;for(var l=!1,c=o;c<i;c++){var u=a*t.width+c,h=t.map[u];if(t.map[u-t.width]==h){l=!0;var d=r.nodeAt(h),p=t.findCell(h),f=p.top,v=p.left;e.setNodeMarkup(e.mapping.slice(s).map(h+n),null,Wv(d.attrs,"rowspan",a-f)),e.insert(e.mapping.slice(s).map(t.positionAt(a,v,r)),d.type.createAndFill(Wv(d.attrs,"rowspan",f+d.attrs.rowspan-a))),c+=d.attrs.colspan-1}}return l}function Qv(e,t,r,n,o,i,a,s){if(0==a||a==t.width)return!1;for(var l=!1,c=o;c<i;c++){var u=c*t.width+a,h=t.map[u];if(t.map[u-1]==h){l=!0;var d=r.nodeAt(h),p=t.colCount(h),f=e.mapping.slice(s).map(h+n);e.setNodeMarkup(f,null,Kv(d.attrs,a-p,d.attrs.colspan-(a-p))),e.insert(f+d.nodeSize,d.type.createAndFill(Kv(d.attrs,0,a-p))),c+=d.attrs.rowspan-1}}return l}function em(e,t,r,n,o){var i=r?e.doc.nodeAt(r-1):e.doc,a=Iv.get(i),s=n.top,l=n.left,c=l+o.width,u=s+o.height,h=e.tr,d=0;function p(){i=r?h.doc.nodeAt(r-1):h.doc,a=Iv.get(i),d=h.mapping.maps.length}(function(e,t,r,n,o,i,a){var s,l,c=zv(e.doc.type.schema);if(o>t.width)for(var u=0,h=0;u<t.height;u++){var d=r.child(u);h+=d.nodeSize;var p=[],f=void 0;f=null==d.lastChild||d.lastChild.type==c.cell?s||(s=c.cell.createAndFill()):l||(l=c.header_cell.createAndFill());for(var v=t.width;v<o;v++)p.push(f);e.insert(e.mapping.slice(a).map(h-1+n),p)}if(i>t.height){for(var m=[],g=0,y=(t.height-1)*t.width;g<Math.max(t.width,o);g++){var w=!(g>=t.width)&&r.nodeAt(t.map[y+g]).type==c.header_cell;m.push(w?l||(l=c.header_cell.createAndFill()):s||(s=c.cell.createAndFill()))}for(var b=c.row.create(null,kn.from(m)),k=[],x=t.height;x<i;x++)k.push(b);e.insert(e.mapping.slice(a).map(n+r.nodeSize-2),k)}return!(!s&&!l)})(h,a,i,r,c,u,d)&&p(),Yv(h,a,i,r,l,c,s,d)&&p(),Yv(h,a,i,r,l,c,u,d)&&p(),Qv(h,a,i,r,s,u,l,d)&&p(),Qv(h,a,i,r,s,u,c,d)&&p();for(var f=s;f<u;f++){var v=a.positionAt(f,l,i),m=a.positionAt(f,c,i);h.replace(h.mapping.slice(d).map(v+r),h.mapping.slice(d).map(m+r),new An(o.rows[f-s],0,0))}p(),h.setSelection(new qv(h.doc.resolve(r+a.positionAt(s,l,i)),h.doc.resolve(r+a.positionAt(u-1,c-1,i)))),t(h)}Jv.prototype.map=function(e){return new Jv(e.map(this.anchor),e.map(this.head))},Jv.prototype.resolve=function(e){var t=e.resolve(this.anchor),r=e.resolve(this.head);return"row"==t.parent.type.spec.tableRole&&"row"==r.parent.type.spec.tableRole&&t.index()<t.parent.childCount&&r.index()<r.parent.childCount&&Fv(t,r)?new qv(t,r):mi.near(r,1)};var tm=Tu({ArrowLeft:nm("horiz",-1),ArrowRight:nm("horiz",1),ArrowUp:nm("vert",-1),ArrowDown:nm("vert",1),"Shift-ArrowLeft":om("horiz",-1),"Shift-ArrowRight":om("horiz",1),"Shift-ArrowUp":om("vert",-1),"Shift-ArrowDown":om("vert",1),Backspace:im,"Mod-Backspace":im,Delete:im,"Mod-Delete":im});function rm(e,t,r){return!r.eq(e.selection)&&(t&&t(e.tr.setSelection(r).scrollIntoView()),!0)}function nm(e,t){return function(r,n,o){var i=r.selection;if(i instanceof qv)return rm(r,n,mi.near(i.$headCell,t));if("horiz"!=e&&!i.empty)return!1;var a=cm(o,e,t);if(null==a)return!1;if("horiz"==e)return rm(r,n,mi.near(r.doc.resolve(i.head+t),t));var s,l=r.doc.resolve(a),c=jv(l,e,t);return s=c?mi.near(c,1):t<0?mi.near(r.doc.resolve(l.before(-1)),-1):mi.near(r.doc.resolve(l.after(-1)),1),rm(r,n,s)}}function om(e,t){return function(r,n,o){var i=r.selection;if(!(i instanceof qv)){var a=cm(o,e,t);if(null==a)return!1;i=new qv(r.doc.resolve(a))}var s=jv(i.$headCell,e,t);return!!s&&rm(r,n,new qv(i.$anchorCell,s))}}function im(e,t){var r=e.selection;if(!(r instanceof qv))return!1;if(t){var n=e.tr,o=zv(e.schema).cell.createAndFill().content;r.forEachCell((function(e,t){e.content.eq(o)||n.replace(n.mapping.map(t+1),n.mapping.map(t+e.nodeSize-1),new An(o,0,0))})),n.docChanged&&t(n)}return!0}function am(e,t){var r=Bv(e.state.doc.resolve(t));return!!r&&(e.dispatch(e.state.tr.setSelection(new qv(r))),!0)}function sm(e,t,r){if(!Hv(e.state))return!1;var n=Gv(r),o=e.state.selection;if(o instanceof qv){n||(n={width:1,height:1,rows:[kn.from(Xv(zv(e.state.schema).cell,r))]});var i=o.$anchorCell.node(-1),a=o.$anchorCell.start(-1),s=Iv.get(i).rectBetween(o.$anchorCell.pos-a,o.$headCell.pos-a);return n=function(e,t,r){var n=e.width,o=e.height,i=e.rows;if(n!=t){for(var a=[],s=[],l=0;l<i.length;l++){for(var c=i[l],u=[],h=a[l]||0,d=0;h<t;d++){var p=c.child(d%c.childCount);h+p.attrs.colspan>t&&(p=p.type.create(Kv(p.attrs,p.attrs.colspan,h+p.attrs.colspan-t),p.content)),u.push(p),h+=p.attrs.colspan;for(var f=1;f<p.attrs.rowspan;f++)a[l+f]=(a[l+f]||0)+p.attrs.colspan}s.push(kn.from(u))}i=s,n=t}if(o!=r){for(var v=[],m=0,g=0;m<r;m++,g++){for(var y=[],w=i[g%o],b=0;b<w.childCount;b++){var k=w.child(b);m+k.attrs.rowspan>r&&(k=k.type.create(Wv(k.attrs,"rowspan",Math.max(1,r-k.attrs.rowspan)),k.content)),y.push(k)}v.push(kn.from(y))}i=v,o=r}return{width:n,height:o,rows:i}}(n,s.right-s.left,s.bottom-s.top),em(e.state,e.dispatch,a,s,n),!0}if(n){var l=Lv(e.state),c=l.start(-1);return em(e.state,e.dispatch,c,Iv.get(l.node(-1)).findCell(l.pos-c),n),!0}return!1}function lm(e,t){if(!t.ctrlKey&&!t.metaKey){var r,n=um(e,t.target);if(t.shiftKey&&e.state.selection instanceof qv)o(e.state.selection.$anchorCell,t),t.preventDefault();else if(t.shiftKey&&n&&null!=(r=Bv(e.state.selection.$anchor))&&hm(e,t).pos!=r.pos)o(r,t),t.preventDefault();else if(!n)return;e.root.addEventListener("mouseup",i),e.root.addEventListener("dragstart",i),e.root.addEventListener("mousemove",a)}function o(t,r){var n=hm(e,r),o=null==$v.getState(e.state);if(!n||!Fv(t,n)){if(!o)return;n=t}var i=new qv(t,n);if(o||!e.state.selection.eq(i)){var a=e.state.tr.setSelection(i);o&&a.setMeta($v,t.pos),e.dispatch(a)}}function i(){e.root.removeEventListener("mouseup",i),e.root.removeEventListener("dragstart",i),e.root.removeEventListener("mousemove",a),null!=$v.getState(e.state)&&e.dispatch(e.state.tr.setMeta($v,-1))}function a(r){var a,s=$v.getState(e.state);if(null!=s)a=e.state.doc.resolve(s);else if(um(e,r.target)!=n&&!(a=hm(e,t)))return i();a&&o(a,r)}}function cm(e,t,r){if(!(e.state.selection instanceof wi))return null;for(var n=e.state.selection.$head,o=n.depth-1;o>=0;o--){var i=n.node(o);if((r<0?n.index(o):n.indexAfter(o))!=(r<0?0:i.childCount))return null;if("cell"==i.type.spec.tableRole||"header_cell"==i.type.spec.tableRole){var a=n.before(o),s="vert"==t?r>0?"down":"up":r>0?"right":"left";return e.endOfTextblock(s)?a:null}}return null}function um(e,t){for(;t&&t!=e.dom;t=t.parentNode)if("TD"==t.nodeName||"TH"==t.nodeName)return t}function hm(e,t){var r=e.posAtCoords({left:t.clientX,top:t.clientY});return r&&r?Bv(e.state.doc.resolve(r.pos)):null}var dm=new Hi("fix-tables");function pm(e,t,r,n){var o=e.childCount,i=t.childCount;e:for(var a=0,s=0;a<i;a++){for(var l=t.child(a),c=s,u=Math.min(o,a+3);c<u;c++)if(e.child(c)==l){s=c+1,r+=l.nodeSize;continue e}n(l,r),s<o&&e.child(s).sameMarkup(l)?pm(e.child(s),l,r+1,n):l.nodesBetween(0,l.content.size,n,r+1),r+=l.nodeSize}}function fm(e,t){var r,n=function(t,n){"table"==t.type.spec.tableRole&&(r=function(e,t,r,n){var o=Iv.get(t);if(!o.problems)return n;n||(n=e.tr);for(var i,a,s=[],l=0;l<o.height;l++)s.push(0);for(var c=0;c<o.problems.length;c++){var u=o.problems[c];if("collision"==u.type){for(var h=t.nodeAt(u.pos),d=0;d<h.attrs.rowspan;d++)s[u.row+d]+=u.n;n.setNodeMarkup(n.mapping.map(r+1+u.pos),null,Kv(h.attrs,h.attrs.colspan-u.n,u.n))}else if("missing"==u.type)s[u.row]+=u.n;else if("overlong_rowspan"==u.type){var p=t.nodeAt(u.pos);n.setNodeMarkup(n.mapping.map(r+1+u.pos),null,Wv(p.attrs,"rowspan",p.attrs.rowspan-u.n))}else if("colwidth mismatch"==u.type){var f=t.nodeAt(u.pos);n.setNodeMarkup(n.mapping.map(r+1+u.pos),null,Wv(f.attrs,"colwidth",u.colwidth))}}for(var v=0;v<s.length;v++)s[v]&&(null==i&&(i=v),a=v);for(var m=0,g=r+1;m<o.height;m++){var y=t.child(m),w=g+y.nodeSize,b=s[m];if(b>0){var k="cell";y.firstChild&&(k=y.firstChild.type.spec.tableRole);for(var x=[],S=0;S<b;S++)x.push(zv(e.schema)[k].createAndFill());var M=0!=m&&i!=m-1||a!=m?w-1:g+1;n.insert(n.mapping.map(M),x)}g=w}return n.setMeta(dm,{fixTables:!0})}(e,t,n,r))};return t?t.doc!=e.doc&&pm(t.doc,e.doc,0,n):e.doc.descendants(n),r}function vm(e){var t,r=e.selection,n=Lv(e),o=n.node(-1),i=n.start(-1),a=Iv.get(o);return(t=r instanceof qv?a.rectBetween(r.$anchorCell.pos-i,r.$headCell.pos-i):a.findCell(n.pos-i)).tableStart=i,t.map=a,t.table=o,t}function mm(e,t,r){var n=t.map,o=t.tableStart,i=t.table,a=r>0?-1:0;(function(e,t,r){for(var n=zv(t.type.schema).header_cell,o=0;o<e.height;o++)if(t.nodeAt(e.map[r+o*e.width]).type!=n)return!1;return!0})(n,i,r+a)&&(a=0==r||r==n.width?null:0);for(var s=0;s<n.height;s++){var l=s*n.width+r;if(r>0&&r<n.width&&n.map[l-1]==n.map[l]){var c=n.map[l],u=i.nodeAt(c);e.setNodeMarkup(e.mapping.map(o+c),null,Uv(u.attrs,r-n.colCount(c))),s+=u.attrs.rowspan-1}else{var h=null==a?zv(i.type.schema).cell:i.nodeAt(n.map[l+a]).type,d=n.positionAt(s,r,i);e.insert(e.mapping.map(o+d),h.createAndFill())}}return e}function gm(e,t){if(!Hv(e))return!1;if(t){var r=vm(e);t(mm(e.tr,r,r.left))}return!0}function ym(e,t){if(!Hv(e))return!1;if(t){var r=vm(e);t(mm(e.tr,r,r.right))}return!0}function wm(e,t,r){for(var n=t.map,o=t.table,i=t.tableStart,a=e.mapping.maps.length,s=0;s<n.height;){var l=s*n.width+r,c=n.map[l],u=o.nodeAt(c);if(r>0&&n.map[l-1]==c||r<n.width-1&&n.map[l+1]==c)e.setNodeMarkup(e.mapping.slice(a).map(i+c),null,Kv(u.attrs,r-n.colCount(c)));else{var h=e.mapping.slice(a).map(i+c);e.delete(h,h+u.nodeSize)}s+=u.attrs.rowspan}}function bm(e,t){if(!Hv(e))return!1;if(t){var r=vm(e),n=e.tr;if(0==r.left&&r.right==r.map.width)return!1;for(var o=r.right-1;wm(n,r,o),o!=r.left;o--)r.table=r.tableStart?n.doc.nodeAt(r.tableStart-1):n.doc,r.map=Iv.get(r.table);t(n)}return!0}function km(e,t,r){for(var n=t.map,o=t.tableStart,i=t.table,a=o,s=0;s<r;s++)a+=i.child(s).nodeSize;var l=[],c=r>0?-1:0;(function(e,t,r){for(var n=zv(t.type.schema).header_cell,o=0;o<e.width;o++)if(t.nodeAt(e.map[o+r*e.width]).type!=n)return!1;return!0})(n,i,r+c)&&(c=0==r||r==n.height?null:0);for(var u=0,h=n.width*r;u<n.width;u++,h++)if(r>0&&r<n.height&&n.map[h]==n.map[h-n.width]){var d=n.map[h],p=i.nodeAt(d).attrs;e.setNodeMarkup(o+d,null,Wv(p,"rowspan",p.rowspan+1)),u+=p.colspan-1}else{var f=null==c?zv(i.type.schema).cell:i.nodeAt(n.map[h+c*n.width]).type;l.push(f.createAndFill())}return e.insert(a,zv(i.type.schema).row.create(null,l)),e}function xm(e,t){if(!Hv(e))return!1;if(t){var r=vm(e);t(km(e.tr,r,r.top))}return!0}function Sm(e,t){if(!Hv(e))return!1;if(t){var r=vm(e);t(km(e.tr,r,r.bottom))}return!0}function Mm(e,t,r){for(var n=t.map,o=t.table,i=t.tableStart,a=0,s=0;s<r;s++)a+=o.child(s).nodeSize;var l=a+o.child(r).nodeSize,c=e.mapping.maps.length;e.delete(a+i,l+i);for(var u=0,h=r*n.width;u<n.width;u++,h++){var d=n.map[h];if(r>0&&d==n.map[h-n.width]){var p=o.nodeAt(d).attrs;e.setNodeMarkup(e.mapping.slice(c).map(d+i),null,Wv(p,"rowspan",p.rowspan-1)),u+=p.colspan-1}else if(r<n.width&&d==n.map[h+n.width]){var f=o.nodeAt(d),v=f.type.create(Wv(f.attrs,"rowspan",f.attrs.rowspan-1),f.content),m=n.positionAt(r+1,u,o);e.insert(e.mapping.slice(c).map(i+m),v),u+=f.attrs.colspan-1}}}function Cm(e,t){if(!Hv(e))return!1;if(t){var r=vm(e),n=e.tr;if(0==r.top&&r.bottom==r.map.height)return!1;for(var o=r.bottom-1;Mm(n,r,o),o!=r.top;o--)r.table=r.tableStart?n.doc.nodeAt(r.tableStart-1):n.doc,r.map=Iv.get(r.table);t(n)}return!0}function Om(e){var t=e.content;return 1==t.childCount&&t.firstChild.isTextblock&&0==t.firstChild.childCount}function Em(e,t){var r=e.selection;if(!(r instanceof qv)||r.$anchorCell.pos==r.$headCell.pos)return!1;var n=vm(e),o=n.map;if(function(e,t){for(var r=e.width,n=e.height,o=e.map,i=t.top*r+t.left,a=i,s=(t.bottom-1)*r+t.left,l=i+(t.right-t.left-1),c=t.top;c<t.bottom;c++){if(t.left>0&&o[a]==o[a-1]||t.right<r&&o[l]==o[l+1])return!0;a+=r,l+=r}for(var u=t.left;u<t.right;u++){if(t.top>0&&o[i]==o[i-r]||t.bottom<n&&o[s]==o[s+r])return!0;i++,s++}return!1}(o,n))return!1;if(t){for(var i,a,s=e.tr,l={},c=kn.empty,u=n.top;u<n.bottom;u++)for(var h=n.left;h<n.right;h++){var d=o.map[u*o.width+h],p=n.table.nodeAt(d);if(!l[d])if(l[d]=!0,null==i)i=d,a=p;else{Om(p)||(c=c.append(p.content));var f=s.mapping.map(d+n.tableStart);s.delete(f,f+p.nodeSize)}}if(s.setNodeMarkup(i+n.tableStart,null,Wv(Uv(a.attrs,a.attrs.colspan,n.right-n.left-a.attrs.colspan),"rowspan",n.bottom-n.top)),c.size){var v=i+1+a.content.size,m=Om(a)?i+1:v;s.replaceWith(m+n.tableStart,v+n.tableStart,c)}s.setSelection(new qv(s.doc.resolve(i+n.tableStart))),t(s)}return!0}function Am(e,t){var r,n=zv(e.schema);return(r=function(e){var t=e.node;return n[t.type.spec.tableRole]},function(e,t){var n,o,i=e.selection;if(i instanceof qv){if(i.$anchorCell.pos!=i.$headCell.pos)return!1;n=i.$anchorCell.nodeAfter,o=i.$anchorCell.pos}else{if(!(n=function(e){for(var t=e.depth;t>0;t--){var r=e.node(t).type.spec.tableRole;if("cell"===r||"header_cell"===r)return e.node(t)}return null}(i.$from)))return!1;o=Bv(i.$from).pos}if(1==n.attrs.colspan&&1==n.attrs.rowspan)return!1;if(t){var a=n.attrs,s=[],l=a.colwidth;a.rowspan>1&&(a=Wv(a,"rowspan",1)),a.colspan>1&&(a=Wv(a,"colspan",1));for(var c,u=vm(e),h=e.tr,d=0;d<u.right-u.left;d++)s.push(l?Wv(a,"colwidth",l&&l[d]?[l[d]]:null):a);for(var p=u.top;p<u.bottom;p++){var f=u.map.positionAt(p,u.left,u.table);p==u.top&&(f+=n.nodeSize);for(var v=u.left,m=0;v<u.right;v++,m++)v==u.left&&p==u.top||h.insert(c=h.mapping.map(f+u.tableStart,1),r({node:n,row:p,col:v}).createAndFill(s[m]))}h.setNodeMarkup(o,r({node:n,row:u.top,col:u.left}),s[0]),i instanceof qv&&h.setSelection(new qv(h.doc.resolve(i.$anchorCell.pos),c&&h.doc.resolve(c))),t(h)}return!0})(e,t)}function Nm(e,t,r){for(var n=t.map.cellsInRect({left:0,top:0,right:"row"==e?t.map.width:1,bottom:"column"==e?t.map.height:1}),o=0;o<n.length;o++){var i=t.table.nodeAt(n[o]);if(i&&i.type!==r.header_cell)return!1}return!0}function Rm(e,t){return(t=t||{useDeprecatedLogic:!1}).useDeprecatedLogic?function(e){return function(t,r){if(!Hv(t))return!1;if(r){for(var n=zv(t.schema),o=vm(t),i=t.tr,a=o.map.cellsInRect("column"==e?new Pv(o.left,0,o.right,o.map.height):"row"==e?new Pv(0,o.top,o.map.width,o.bottom):o),s=a.map((function(e){return o.table.nodeAt(e)})),l=0;l<a.length;l++)s[l].type==n.header_cell&&i.setNodeMarkup(o.tableStart+a[l],n.cell,s[l].attrs);if(0==i.steps.length)for(var c=0;c<a.length;c++)i.setNodeMarkup(o.tableStart+a[c],n.header_cell,s[c].attrs);r(i)}return!0}}(e):function(t,r){if(!Hv(t))return!1;if(r){var n=zv(t.schema),o=vm(t),i=t.tr,a=Nm("row",o,n),s=Nm("column",o,n),l=("column"===e?a:"row"===e&&s)?1:0,c="column"==e?new Pv(0,l,1,o.map.height):"row"==e?new Pv(l,0,o.map.width,1):o,u="column"==e?s?n.cell:n.header_cell:"row"==e?a?n.cell:n.header_cell:n.cell;o.map.cellsInRect(c).forEach((function(e){var t=e+o.tableStart,r=i.doc.nodeAt(t);r&&i.setNodeMarkup(t,u,r.attrs)})),r(i)}return!0}}var Tm=Rm("row",{useDeprecatedLogic:!0}),Dm=Rm("column",{useDeprecatedLogic:!0}),Pm=Rm("cell",{useDeprecatedLogic:!0});function Im(e,t){for(var r=e.selection.$anchor,n=r.depth;n>0;n--){if("table"==r.node(n).type.spec.tableRole)return t&&t(e.tr.delete(r.before(n),r.after(n)).scrollIntoView()),!0}return!1}var Vm=function(e,t){this.node=e,this.cellMinWidth=t,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),zm(e,this.colgroup,this.table,t),this.contentDOM=this.table.appendChild(document.createElement("tbody"))};function zm(e,t,r,n,o,i){for(var a=0,s=!0,l=t.firstChild,c=e.firstChild,u=0,h=0;u<c.childCount;u++)for(var d=c.child(u).attrs,p=d.colspan,f=d.colwidth,v=0;v<p;v++,h++){var m=o==h?i:f&&f[v],g=m?m+"px":"";a+=m||n,m||(s=!1),l?(l.style.width!=g&&(l.style.width=g),l=l.nextSibling):t.appendChild(document.createElement("col")).style.width=g}for(;l;){var y=l.nextSibling;l.parentNode.removeChild(l),l=y}s?(r.style.width=a+"px",r.style.minWidth=""):(r.style.width="",r.style.minWidth=a+"px")}Vm.prototype.update=function(e){return e.type==this.node.type&&(this.node=e,zm(e,this.colgroup,this.table,this.cellMinWidth),!0)},Vm.prototype.ignoreMutation=function(e){return"attributes"==e.type&&(e.target==this.table||this.colgroup.contains(e.target))};var $m=new Hi("tableColumnResizing");function Bm(e){void 0===e&&(e={});var t=e.handleWidth;void 0===t&&(t=5);var r=e.cellMinWidth;void 0===r&&(r=25);var n=e.View;void 0===n&&(n=Vm);var o=e.lastColumnResizable;return void 0===o&&(o=!0),new zi({key:$m,state:{init:function(e,t){return this.spec.props.nodeViews[zv(t.schema).table.name]=function(e,t){return new n(e,r,t)},new Hm(-1,!1)},apply:function(e,t){return t.apply(e)}},props:{attributes:function(e){return $m.getState(e).activeHandle>-1?{class:"resize-cursor"}:null},handleDOMEvents:{mousemove:function(e,r){!function(e,t,r,n,o){var i=$m.getState(e.state);if(!i.dragging){var a=function(e){for(;e&&"TD"!=e.nodeName&&"TH"!=e.nodeName;)e=e.classList.contains("ProseMirror")?null:e.parentNode;return e}(t.target),s=-1;if(a){var l=a.getBoundingClientRect(),c=l.left,u=l.right;t.clientX-c<=r?s=Lm(e,t,"left"):u-t.clientX<=r&&(s=Lm(e,t,"right"))}if(s!=i.activeHandle){if(!o&&-1!==s){var h=e.state.doc.resolve(s),d=h.node(-1),p=Iv.get(d),f=h.start(-1);if(p.colCount(h.pos-f)+h.nodeAfter.attrs.colspan-1==p.width-1)return}Fm(e,s)}}}(e,r,t,0,o)},mouseleave:function(e){!function(e){var t=$m.getState(e.state);t.activeHandle>-1&&!t.dragging&&Fm(e,-1)}(e)},mousedown:function(e,t){!function(e,t,r){var n=$m.getState(e.state);if(-1==n.activeHandle||n.dragging)return!1;var o=e.state.doc.nodeAt(n.activeHandle),i=function(e,t,r){var n=r.colspan,o=r.colwidth,i=o&&o[o.length-1];if(i)return i;var a=e.domAtPos(t),s=a.node.childNodes[a.offset].offsetWidth,l=n;if(o)for(var c=0;c<n;c++)o[c]&&(s-=o[c],l--);return s/l}(e,n.activeHandle,o.attrs);function a(t){window.removeEventListener("mouseup",a),window.removeEventListener("mousemove",s);var n=$m.getState(e.state);n.dragging&&(!function(e,t,r){for(var n=e.state.doc.resolve(t),o=n.node(-1),i=Iv.get(o),a=n.start(-1),s=i.colCount(n.pos-a)+n.nodeAfter.attrs.colspan-1,l=e.state.tr,c=0;c<i.height;c++){var u=c*i.width+s;if(!c||i.map[u]!=i.map[u-i.width]){var h=i.map[u],d=o.nodeAt(h).attrs,p=1==d.colspan?0:s-i.colCount(h);if(!d.colwidth||d.colwidth[p]!=r){var f=d.colwidth?d.colwidth.slice():jm(d.colspan);f[p]=r,l.setNodeMarkup(a+h,null,Wv(d,"colwidth",f))}}}l.docChanged&&e.dispatch(l)}(e,n.activeHandle,_m(n.dragging,t,r)),e.dispatch(e.state.tr.setMeta($m,{setDragging:null})))}function s(t){if(!t.which)return a(t);var n=$m.getState(e.state),o=_m(n.dragging,t,r);!function(e,t,r,n){var o=e.state.doc.resolve(t),i=o.node(-1),a=o.start(-1),s=Iv.get(i).colCount(o.pos-a)+o.nodeAfter.attrs.colspan-1,l=e.domAtPos(o.start(-1)).node;for(;"TABLE"!=l.nodeName;)l=l.parentNode;zm(i,l.firstChild,l,n,s,r)}(e,n.activeHandle,o,r)}e.dispatch(e.state.tr.setMeta($m,{setDragging:{startX:t.clientX,startWidth:i}})),window.addEventListener("mouseup",a),window.addEventListener("mousemove",s),t.preventDefault()}(e,t,r)}},decorations:function(e){var t=$m.getState(e);if(t.activeHandle>-1)return function(e,t){for(var r=[],n=e.doc.resolve(t),o=n.node(-1),i=Iv.get(o),a=n.start(-1),s=i.colCount(n.pos-a)+n.nodeAfter.attrs.colspan,l=0;l<i.height;l++){var c=s+l*i.width-1;if(!(s!=i.width&&i.map[c]==i.map[c+1]||0!=l&&i.map[c-1]==i.map[c-1-i.width])){var u=i.map[c],h=a+u+o.nodeAt(u).nodeSize-1,d=document.createElement("div");d.className="column-resize-handle",r.push(ml.widget(h,d))}}return bl.create(e.doc,r)}(e,t.activeHandle)},nodeViews:{}}})}var Hm=function(e,t){this.activeHandle=e,this.dragging=t};function Lm(e,t,r){var n=e.posAtCoords({left:t.clientX,top:t.clientY});if(!n)return-1;var o=n.pos,i=Bv(e.state.doc.resolve(o));if(!i)return-1;if("right"==r)return i.pos;var a=Iv.get(i.node(-1)),s=i.start(-1),l=a.map.indexOf(i.pos-s);return l%a.width==0?-1:s+a.map[l-1]}function _m(e,t,r){var n=t.clientX-e.startX;return Math.max(r,e.startWidth+n)}function Fm(e,t){e.dispatch(e.state.tr.setMeta($m,{setHandle:t}))}function jm(e){for(var t=[],r=0;r<e;r++)t.push(0);return t}function Wm(e){void 0===e&&(e={});var t=e.allowTableNodeSelection;return void 0===t&&(t=!1),new zi({key:$v,state:{init:function(){return null},apply:function(e,t){var r=e.getMeta($v);if(null!=r)return-1==r?null:r;if(null==t||!e.docChanged)return t;var n=e.mapping.mapResult(t),o=n.deleted,i=n.pos;return o?null:i}},props:{decorations:Zv,handleDOMEvents:{mousedown:lm},createSelectionBetween:function(e){if(null!=$v.getState(e.state))return e.state.selection},handleTripleClick:am,handleKeyDown:tm,handlePaste:sm},appendTransaction:function(e,r,n){return function(e,t,r){var n,o,i=(t||e).selection,a=(t||e).doc;if(i instanceof ki&&(o=i.node.type.spec.tableRole)){if("cell"==o||"header_cell"==o)n=qv.create(a,i.from);else if("row"==o){var s=a.resolve(i.from+1);n=qv.rowSelection(s,s)}else if(!r){var l=Iv.get(i.node),c=i.from+1,u=c+l.map[l.width*l.height-1];n=qv.create(a,c+1,u)}}else i instanceof wi&&function(e){var t=e.$from,r=e.$to;if(t.pos==r.pos||t.pos<t.pos-6)return!1;for(var n=t.pos,o=r.pos,i=t.depth;i>=0&&!(t.after(i+1)<t.end(i));i--,n++);for(var a=r.depth;a>=0&&!(r.before(a+1)>r.start(a));a--,o--);return n==o&&/row|table/.test(t.node(i).type.spec.tableRole)}(i)?n=wi.create(a,i.from):i instanceof wi&&function(e){for(var t,r,n=e.$from,o=e.$to,i=n.depth;i>0;i--){var a=n.node(i);if("cell"===a.type.spec.tableRole||"header_cell"===a.type.spec.tableRole){t=a;break}}for(var s=o.depth;s>0;s--){var l=o.node(s);if("cell"===l.type.spec.tableRole||"header_cell"===l.type.spec.tableRole){r=l;break}}return t!==r&&0===o.parentOffset}(i)&&(n=wi.create(a,i.$from.start(),i.$from.end()));return n&&(t||(t=e.tr)).setSelection(n),t}(n,fm(n,r),t)}})}function Km(e){var t,r,n=e.getAttribute("data-colwidth"),o=n&&/^\d+(,\d+)*$/.test(n)?n.split(",").map((e=>Number(e))):null,i=Number(null!==(t=e.getAttribute("colspan"))&&void 0!==t?t:1);return{colspan:i,rowspan:Number(null!==(r=e.getAttribute("rowspan"))&&void 0!==r?r:1),colwidth:o&&o.length===i?o:null,background:e.style.backgroundColor||null}}function Um(e){var t={};return 1!==e.attrs.colspan&&(t.colspan=e.attrs.colspan),1!==e.attrs.rowspan&&(t.rowspan=e.attrs.rowspan),e.attrs.colwidth&&(t["data-colwidth"]=e.attrs.colwidth.join(",")),e.attrs.background&&(t.style="".concat(t.style||"","background-color: ").concat(e.attrs.background,";")),t}function qm(e){var t=zt(zt({},e.defaults()),{},{colspan:{default:1},rowspan:{default:1},colwidth:{default:null},background:{default:null}});return{table:{attrs:e.defaults(),content:"tableRow+",tableRole:"table",isolating:!0,parseDOM:[{tag:"table",getAttrs:e.parse}],toDOM:t=>["table",["tbody",e.dom(t),0]]},tableRow:{attrs:e.defaults(),content:"(tableCell | tableHeaderCell)*",tableRole:"row",parseDOM:[{tag:"tr",getAttrs:e.parse}],toDOM:t=>["tr",e.dom(t),0]},tableCell:{content:"".concat(Ut.BlockNode,"+"),attrs:t,tableRole:"cell",isolating:!0,parseDOM:[{tag:"td",getAttrs:t=>zt(zt({},e.parse(t)),Km(t))}],toDOM:t=>["td",zt(zt({},e.dom(t)),Um(t)),0]},tableHeaderCell:{content:"".concat(Ut.BlockNode,"+"),attrs:t,tableRole:"header_cell",isolating:!0,parseDOM:[{tag:"th",getAttrs:t=>zt(zt({},e.parse(t)),Km(t))}],toDOM:t=>["th",zt(zt({},e.dom(t)),Um(t)),0]}}}Hm.prototype.apply=function(e){var t=this,r=e.getMeta($m);if(r&&null!=r.setHandle)return new Hm(r.setHandle,null);if(r&&void 0!==r.setDragging)return new Hm(t.activeHandle,r.setDragging);if(t.activeHandle>-1&&e.docChanged){var n=e.mapping.map(t.activeHandle,-1);_v(e.doc.resolve(n))||(n=null),t=new Hm(n,t.dragging)}return t};var Jm,Zm,Gm,Xm,Ym,Qm=["table","row","cell","header_cell"];function eg(e){var t=e.content,r=e.type;return t?r.createChecked(null,t):r.createAndFill()}function tg(e){for(var t=e.schema,r=e.cellContent,n=e.columnsCount,o=void 0===n?3:n,i=e.rowsCount,a=void 0===i?3:i,s=e.withHeaderRow,l=void 0===s||s,c=function(e){if(e.cached.tableNodeTypes)return e.cached.tableNodeTypes;var t=Tr();e.cached.tableNodeTypes=t;var r,n=Bt(Nr(e.nodes));try{for(n.s();!(r=n.n()).done;){var o=r.value;Rr(Qm,o.spec.tableRole)&&(t[o.spec.tableRole]=o)}}catch(i){n.e(i)}finally{n.f()}return t}(t),u=c.cell,h=c.header_cell,d=c.row,p=c.table,f=[],v=[],m=0;m<o;m++)f.push(eg({type:u,content:r})),l&&v.push(eg({type:h,content:r}));for(var g=[],y=0;y<a;y++){var w=l&&0===y?v:f;g.push(d.createChecked(null,w))}return p.createChecked(null,g)}var rg,ng=!1,og=nh({defaultOptions:{resizable:!0}})((Zm=new WeakMap,Jm=class extends Ju{constructor(){super(...arguments),It(this,"tags",[Ut.BlockNode]),Zm.set(this,{writable:!0,value:void 0})}get name(){return"table"}createNodeSpec(e){return qm(e).table}onStateUpdate(e){var t,r=e.tr,n=e.state;(null==r||null===(t=r.getMeta(dm))||void 0===t?void 0:t.fixTables)&&Wi(this,Zm,n)}createExternalPlugins(){return[Wm(),Bm({})]}createCommands(){return{createTable:e=>t=>{var r=t.tr,n=t.dispatch,o=t.state;if(!r.selection.empty)return!1;var i=r.selection.anchor+1,a=tg(zt({schema:o.schema},e));return null==n||n(r.replaceSelectionWith(a).scrollIntoView().setSelection(wi.near(r.doc.resolve(i)))),!0},deleteTable:()=>vn(Im),addTableColumnBefore:()=>vn(gm),addTableColumnAfter:()=>vn(ym),deleteTableColumn:()=>vn(bm),addTableRowBefore:()=>vn(xm),addTableRowAfter:()=>vn(Sm),deleteTableRow:()=>vn(Cm),toggleTableCellMerge:()=>lg,mergeTableCells:()=>vn(Em),splitTableCell:()=>vn(Am),toggleTableHeaderColumn:()=>vn(Dm),toggleTableHeaderRow:()=>vn(Tm),toggleTableHeaderCell:()=>vn(Pm),setTableCellAttribute:(e,t)=>vn(function(e,t){return function(r,n){if(!Hv(r))return!1;var o=Lv(r);if(o.nodeAfter.attrs[e]===t)return!1;if(n){var i=r.tr;r.selection instanceof qv?r.selection.forEachCell((function(r,n){r.attrs[e]!==t&&i.setNodeMarkup(n,null,Wv(r.attrs,e,t))})):i.setNodeMarkup(o.pos,null,Wv(o.nodeAfter.attrs,e,t)),n(i)}return!0}}(e,t)),fixTables:()=>{return mn((e=Lt(this,Zm),t=>{var r=t.state,n=t.dispatch,o=fm(r,e);return!!o&&(n&&n(o),!0)}));var e}}}createHelpers(){return{enableTableSupport:()=>{ng||(document.execCommand("enableObjectResizing",!1,"false"),document.execCommand("enableInlineTableEditing",!1,"false"),ng=!0)}}}onSetOptions(e){if(e.changes.resizable.changed){var t=this.externalPlugins,r=this.externalPlugins=this.createExternalPlugins();this.store.addOrReplacePlugins(r,t),this.store.reconfigureStatePlugins()}}}))||Jm,ig=nh({})(Gm=class extends Ju{get name(){return"tableRow"}createNodeSpec(e){return qm(e).tableRow}})||Gm,ag=nh({})(Xm=class extends Ju{get name(){return"tableCell"}createNodeSpec(e){return qm(e).tableCell}})||Xm,sg=nh({})(Ym=class extends Ju{get name(){return"tableHeaderCell"}createNodeSpec(e){return qm(e).tableHeaderCell}})||Ym;function lg(e){var t=e.state,r=e.dispatch;return!Em(t,r)&&Am(t,r)}var cg=oh({defaultOptions:og.defaultOptions})(rg=class extends hh{get name(){return"table"}createExtensions(){return[new og({priority:Zt.Low,resizable:this.options.resizable}),new ig({priority:Zt.Low}),new ag({priority:Zt.Low}),new sg({priority:Zt.Low})]}onSetOptions(e){var t=e.changes;t.resizable.changed&&this.getExtension(og).setOptions({resizable:t.resizable.value})}})||rg;const ug=(e,t,r,n=!1)=>new class extends Ju{get name(){return e}createNodeSpec(){return{group:"block",attrs:{class:{default:null}},content:r,toDOM:({attrs:r})=>[t,n?{class:e}:r,0],parseDOM:[{tag:t,getAttrs:t=>({class:n?e:t.className})}]}}}({disableExtraAttributes:!0}),hg=(e,t)=>{let r=0,n=0;for(;r<e.length&&r<t.length&&e[r]===t[r];)r++;if(r!==e.length||r!==t.length)for(;n+r<e.length&&n+r<t.length&&e[e.length-n-1]===t[t.length-n-1];)n++;return{index:r,remove:e.length-r-n,insert:t.slice(r,t.length-n)}},dg=new Hi("y-sync"),pg=new Hi("y-undo"),fg=new Hi("yjs-cursor"),vg=(e,t)=>void 0===t?!e.deleted:t.sv.has(e.id.client)&&t.sv.get(e.id.client)>e.id.clock&&!D(t.ds,e.id),mg=[{light:"#ecd44433",dark:"#ecd444"}],gg=(e,t,r)=>{if(!e.has(r)){if(e.size<t.length){const r=F();e.forEach((e=>r.add(e))),t=t.filter((e=>!r.has(e)))}e.set(r,_(t))}return e.get(r)},yg=(e,{colors:t=mg,colorMapping:r=new Map,permanentUserData:n=null}={})=>{let o=!1;const i=new zi({props:{editable:e=>{const t=dg.getState(e);return null==t.snapshot&&null==t.prevSnapshot}},key:dg,state:{init:(o,i)=>({type:e,doc:e.doc,binding:null,snapshot:null,prevSnapshot:null,isChangeOrigin:!1,colors:t,colorMapping:r,permanentUserData:n}),apply:(e,t)=>{const r=e.getMeta(dg);if(void 0!==r){t=Object.assign({},t);for(const e in r)t[e]=r[e]}return t.isChangeOrigin=void 0!==r&&!!r.isChangeOrigin,null!==t.binding&&(void 0===r||null==r.snapshot&&null==r.prevSnapshot||setTimeout((()=>{null==r.restore?t.binding._renderSnapshot(r.snapshot,r.prevSnapshot,t):(t.binding._renderSnapshot(r.snapshot,r.snapshot,t),delete t.restore,delete t.snapshot,delete t.prevSnapshot,t.binding._prosemirrorChanged(t.binding.prosemirrorView.state.doc))}),0)),t}},view:t=>{const r=new bg(e,t);return setTimeout((()=>{r._forceRerender(),t.dispatch(t.state.tr.setMeta(dg,{binding:r}))}),0),{update:()=>{const e=i.getState(t.state);null==e.snapshot&&null==e.prevSnapshot&&(o||null!==t.state.doc.content.findDiffStart(t.state.doc.type.createAndFill().content))&&(o=!0,r._prosemirrorChanged(t.state.doc))},destroy:()=>{r.destroy()}}}});return i},wg=(e,t)=>({anchor:$g(t.selection.anchor,e.type,e.mapping),head:$g(t.selection.head,e.type,e.mapping)});class bg{constructor(e,t){this.type=e,this.prosemirrorView=t,this.mux=S(),this.mapping=new Map,this._observeFunction=this._typeChanged.bind(this),this.doc=e.doc,this.beforeTransactionSelection=null,this.beforeAllTransactions=()=>{null===this.beforeTransactionSelection&&(this.beforeTransactionSelection=wg(this,t.state))},this.afterAllTransactions=()=>{this.beforeTransactionSelection=null},this.doc.on("beforeAllTransactions",this.beforeAllTransactions),this.doc.on("afterAllTransactions",this.afterAllTransactions),e.observeDeep(this._observeFunction),this._domSelectionInView=null}_isLocalCursorInView(){return!!this.prosemirrorView.hasFocus()&&(M&&null===this._domSelectionInView&&(setTimeout((()=>{this._domSelectionInView=null}),0),this._domSelectionInView=this._isDomSelectionInView()),this._domSelectionInView)}_isDomSelectionInView(){const e=this.prosemirrorView._root.getSelection(),t=this.prosemirrorView._root.createRange();t.setStart(e.anchorNode,e.anchorOffset),t.setEnd(e.focusNode,e.focusOffset);0===t.getClientRects().length&&t.startContainer&&t.collapsed&&t.selectNodeContents(t.startContainer);const r=t.getBoundingClientRect(),n=C.documentElement;return r.bottom>=0&&r.right>=0&&r.left<=(window.innerWidth||n.clientWidth||0)&&r.top<=(window.innerHeight||n.clientHeight||0)}renderSnapshot(e,t){t||(t=O(E(),new Map)),this.prosemirrorView.dispatch(this.prosemirrorView.state.tr.setMeta(dg,{snapshot:e,prevSnapshot:t}))}unrenderSnapshot(){this.mapping=new Map,this.mux((()=>{const e=this.type.toArray().map((e=>xg(e,this.prosemirrorView.state.schema,this.mapping))).filter((e=>null!==e)),t=this.prosemirrorView.state.tr.replace(0,this.prosemirrorView.state.doc.content.size,new An(new kn(e),0,0));t.setMeta(dg,{snapshot:null,prevSnapshot:null}),this.prosemirrorView.dispatch(t)}))}_forceRerender(){this.mapping=new Map,this.mux((()=>{const e=this.type.toArray().map((e=>xg(e,this.prosemirrorView.state.schema,this.mapping))).filter((e=>null!==e)),t=this.prosemirrorView.state.tr.replace(0,this.prosemirrorView.state.doc.content.size,new An(new kn(e),0,0));this.prosemirrorView.dispatch(t)}))}_renderSnapshot(e,t,r){e||(e=A(this.doc)),this.mapping=new Map,this.mux((()=>{this.doc.transact((n=>{const o=r.permanentUserData;o&&o.dss.forEach((e=>{N(n,e,(e=>{}))}));const i=(e,t)=>{const n="added"===e?o.getUserByClientId(t.client):o.getUserByDeletedId(t);return{user:n,type:e,color:gg(r.colorMapping,r.colors,n)}},a=R(this.type,new T(t.ds,e.sv)).map((r=>!r._item.deleted||vg(r._item,e)||vg(r._item,t)?xg(r,this.prosemirrorView.state.schema,new Map,e,t,i):null)).filter((e=>null!==e)),s=this.prosemirrorView.state.tr.replace(0,this.prosemirrorView.state.doc.content.size,new An(new kn(a),0,0));this.prosemirrorView.dispatch(s)}),dg)}))}_typeChanged(e,t){const r=dg.getState(this.prosemirrorView.state);0!==e.length&&null==r.snapshot&&null==r.prevSnapshot?this.mux((()=>{const e=(e,t)=>this.mapping.delete(t);N(t,t.deleteSet,(e=>e.constructor===P&&this.mapping.delete(e.content.type))),t.changed.forEach(e),t.changedParentTypes.forEach(e);const r=this.type.toArray().map((e=>kg(e,this.prosemirrorView.state.schema,this.mapping))).filter((e=>null!==e));let n=this.prosemirrorView.state.tr.replace(0,this.prosemirrorView.state.doc.content.size,new An(new kn(r),0,0));((e,t,r)=>{if(null!==t&&null!==t.anchor&&null!==t.head){const n=Hg(r.doc,r.type,t.anchor,r.mapping),o=Hg(r.doc,r.type,t.head,r.mapping);null!==n&&null!==o&&(e=e.setSelection(wi.create(e.doc,n,o)))}})(n,this.beforeTransactionSelection,this),n=n.setMeta(dg,{isChangeOrigin:!0}),null!==this.beforeTransactionSelection&&this._isLocalCursorInView()&&n.scrollIntoView(),this.prosemirrorView.dispatch(n)})):this.renderSnapshot(r.snapshot,r.prevSnapshot)}_prosemirrorChanged(e){this.mux((()=>{this.doc.transact((()=>{Pg(this.doc,this.type,e,this.mapping),this.beforeTransactionSelection=wg(this,this.prosemirrorView.state)}),dg)}))}destroy(){this.type.unobserveDeep(this._observeFunction),this.doc.off("beforeAllTransactions",this.beforeAllTransactions),this.doc.off("afterAllTransactions",this.afterAllTransactions)}}const kg=(e,t,r,n,o,i)=>{const a=r.get(e);if(void 0===a){if(e instanceof I)return xg(e,t,r,n,o,i);throw V()}return a},xg=(e,t,r,n,o,i)=>{const a=[],s=e=>{if(e.constructor===I){const s=kg(e,t,r,n,o,i);null!==s&&a.push(s)}else{const s=Sg(e,t,r,n,o,i);null!==s&&s.forEach((e=>{null!==e&&a.push(e)}))}};void 0===n||void 0===o?e.toArray().forEach(s):R(e,new T(o.ds,n.sv)).forEach(s);try{const s=e.getAttributes(n);void 0!==n&&(vg(e._item,n)?vg(e._item,o)||(s.ychange=i?i("added",e._item.id):{type:"added"}):s.ychange=i?i("removed",e._item.id):{type:"removed"});const l=t.node(e.nodeName,s,a);return r.set(e,l),l}catch(l){return e.doc.transact((t=>{e._item.delete(t)}),dg),r.delete(e),null}},Sg=(e,t,r,n,o,i)=>{const a=[],s=e.toDelta(n,o,i);try{for(let e=0;e<s.length;e++){const r=s[e],n=[];for(const e in r.attributes)n.push(t.mark(e,r.attributes[e]));a.push(t.text(r.insert,n))}}catch(l){return e.doc.transact((t=>{e._item.delete(t)}),dg),null}return a},Mg=(e,t)=>e instanceof Array?((e,t)=>{const r=new z,n=e.map((e=>({insert:e.text,attributes:Dg(e.marks)})));return r.applyDelta(n),t.set(r,e),r})(e,t):((e,t)=>{const r=new I(e.type.name);for(const n in e.attrs){const t=e.attrs[n];null!==t&&"ychange"!==n&&r.setAttribute(n,t)}return r.insert(0,Og(e).map((e=>Mg(e,t)))),t.set(r,e),r})(e,t),Cg=(e,t)=>{const r=Object.keys(e).filter((t=>null!==e[t]));let n=r.length===Object.keys(t).filter((e=>null!==t[e])).length;for(let o=0;o<r.length&&n;o++){const i=r[o],a=e[i],s=t[i];n="ychange"===i||a===s||"object"==typeof a&&"object"==typeof s&&Cg(a,s)}return n},Og=e=>{const t=e.content.content,r=[];for(let n=0;n<t.length;n++){const e=t[n];if(e.isText){const e=[];for(let r=t[n];n<t.length&&r.isText;r=t[++n])e.push(r);n--,r.push(e)}else r.push(e)}return r},Eg=(e,t)=>{const r=e.toDelta();return r.length===t.length&&r.every(((e,r)=>e.insert===t[r].text&&$(e.attributes||{}).length===t[r].marks.length&&t[r].marks.every((t=>Cg(e.attributes[t.type.name]||{},t.attrs)))))},Ag=(e,t)=>{if(e instanceof I&&!(t instanceof Array)&&Ig(e,t)){const r=Og(t);return e._length===r.length&&Cg(e.getAttributes(),t.attrs)&&e.toArray().every(((e,t)=>Ag(e,r[t])))}return e instanceof z&&t instanceof Array&&Eg(e,t)},Ng=(e,t)=>e===t||e instanceof Array&&t instanceof Array&&e.length===t.length&&e.every(((e,r)=>t[r]===e)),Rg=(e,t,r)=>{const n=e.toArray(),o=Og(t),i=o.length,a=n.length,s=B(a,i);let l=0,c=0,u=!1;for(;l<s;l++){const e=n[l],t=o[l];if(Ng(r.get(e),t))u=!0;else if(!Ag(e,t))break}for(;l+c<s;c++){const e=n[a-c-1],t=o[i-c-1];if(Ng(r.get(e),t))u=!0;else if(!Ag(e,t))break}return{equalityFactor:l+c,foundMappedChild:u}},Tg=(e,t,r)=>{r.set(e,t);const{nAttrs:n,str:o}=(e=>{let t="",r=e._start;const n={};for(;null!==r;)r.deleted||(r.countable&&r.content instanceof H?t+=r.content.str:r.content instanceof L&&(n[r.content.key]=null)),r=r.right;return{str:t,nAttrs:n}})(e),i=t.map((e=>({insert:e.text,attributes:Object.assign({},n,Dg(e.marks))}))),{insert:a,remove:s,index:l}=hg(o,i.map((e=>e.insert)).join(""));e.delete(l,s),e.insert(l,a),e.applyDelta(i.map((e=>({retain:e.insert.length,attributes:e.attributes}))))},Dg=e=>{const t={};return e.forEach((e=>{"ychange"!==e.type.name&&(t[e.type.name]=e.attrs)})),t},Pg=(e,t,r,n)=>{if(t instanceof I&&t.nodeName!==r.type.name)throw new Error("node name mismatch!");if(n.set(t,r),t instanceof I){const e=t.getAttributes(),n=r.attrs;for(const r in n)null!==n[r]?e[r]!==n[r]&&"ychange"!==r&&t.setAttribute(r,n[r]):t.removeAttribute(r);for(const r in e)void 0===n[r]&&t.removeAttribute(r)}const o=Og(r),i=o.length,a=t.toArray(),s=a.length,l=B(i,s);let c=0,u=0;for(;c<l;c++){const e=a[c],t=o[c];if(!Ng(n.get(e),t)){if(!Ag(e,t))break;n.set(e,t)}}for(;u+c+1<l;u++){const e=a[s-u-1],t=o[i-u-1];if(!Ng(n.get(e),t)){if(!Ag(e,t))break;n.set(e,t)}}e.transact((()=>{for(;s-c-u>0&&i-c-u>0;){const r=a[c],l=o[c],h=a[s-u-1],d=o[i-u-1];if(r instanceof z&&l instanceof Array)Eg(r,l)||Tg(r,l,n),c+=1;else{let o=r instanceof I&&Ig(r,l),i=h instanceof I&&Ig(h,d);if(o&&i){const e=Rg(r,l,n),t=Rg(h,d,n);e.foundMappedChild&&!t.foundMappedChild?i=!1:!e.foundMappedChild&&t.foundMappedChild||e.equalityFactor<t.equalityFactor?o=!1:i=!1}o?(Pg(e,r,l,n),c+=1):i?(Pg(e,h,d,n),u+=1):(t.delete(c,1),t.insert(c,[Mg(l,n)]),c+=1)}}const r=s-c-u;if(r>0&&t.delete(c,r),c+u<i){const e=[];for(let t=c;t<i-u;t++)e.push(Mg(o[t],n));t.insert(c,e)}}),dg)},Ig=(e,t)=>!(t instanceof Array)&&e.nodeName===t.type.name;let Vg=null;const zg=()=>{const e=Vg;Vg=null,e.forEach(((e,t)=>{const r=t.state.tr;e.forEach(((e,t)=>{r.setMeta(t,e)})),t.dispatch(r)}))},$g=(e,t,r)=>{if(0===e)return j(t,0);let n=null===t._first?null:t._first.content.type;for(;null!==n&&t!==n;){if(n.constructor===z){if(n._length>=e)return j(n,e);if(e-=n._length,null!==n._item&&null!==n._item.next)n=n._item.next.content.type;else{do{n=null===n._item?null:n._item.parent,e--}while(n!==t&&null!==n&&null!==n._item&&null===n._item.next);null!==n&&n!==t&&(n=null===n._item?null:n._item.next.content.type)}}else{const o=(r.get(n)||{nodeSize:0}).nodeSize;if(null!==n._first&&e<o)n=n._first.content.type,e--;else{if(1===e&&0===n._length&&o>1)return new W(null===n._item?null:n._item.id,null===n._item?K(n):null,null);if(e-=o,null!==n._item&&null!==n._item.next)n=n._item.next.content.type;else{if(0===e)return n=null===n._item?n:n._item.parent,new W(null===n._item?null:n._item.id,null===n._item?K(n):null,null);do{n=n._item.parent,e--}while(n!==t&&null===n._item.next);n!==t&&(n=n._item.next.content.type)}}}if(null===n)throw U();if(0===e&&n.constructor!==z&&n!==t)return Bg(n._item.parent,n._item)}return j(t,t._length)},Bg=(e,t)=>{let r=null,n=null;return null===e._item?n=K(e):r=q(e._item.id.client,e._item.id.clock),new W(r,n,t.id)},Hg=(e,t,r,n)=>{const o=X(r,e);if(null===o||o.type!==t&&!Y(t,o.type._item))return null;let i=o.type,a=0;if(i.constructor===z)a=o.index;else if(null===i._item||!i._item.deleted){let e=i._first,t=0;for(;t<i._length&&t<o.index&&null!==e;){if(!e.deleted){const r=e.content.type;t++,r.constructor===z?a+=r._length:a+=n.get(r).nodeSize}e=e.right}a+=1}for(;i!==t&&null!==i._item;){const e=i._item.parent;if(null===e._item||!e._item.deleted){a+=1;let t=e._first;for(;null!==t;){const e=t.content.type;if(e===i)break;t.deleted||(e.constructor===z?a+=e._length:a+=n.get(e).nodeSize),t=t.right}}i=e}return a-1},Lg=e=>{const t=document.createElement("span");t.classList.add("ProseMirror-yjs-cursor"),t.setAttribute("style",`border-color: ${e.color}`);const r=document.createElement("div");return r.setAttribute("style",`background-color: ${e.color}`),r.insertBefore(document.createTextNode(e.name),null),t.insertBefore(r,null),t},_g=(e,t,r)=>{const n=dg.getState(e),o=n.doc,i=[];return null!=n.snapshot||null!=n.prevSnapshot||null===n.binding?bl.create(e.doc,[]):(t.getStates().forEach(((t,a)=>{if(a!==o.clientID&&null!=t.cursor){const s=t.user||{};null==s.color&&(s.color="#ffa500"),null==s.name&&(s.name=`User: ${a}`);let l=Hg(o,n.type,Q(t.cursor.anchor),n.binding.mapping),c=Hg(o,n.type,Q(t.cursor.head),n.binding.mapping);if(null!==l&&null!==c){const t=ee(e.doc.content.size-1,0);l=B(l,t),c=B(c,t),i.push(ml.widget(c,(()=>r(s)),{key:a+"",side:10}));const n=B(l,c),o=ee(l,c);i.push(ml.inline(n,o,{style:`background-color: ${s.color}70`},{inclusiveEnd:!0,inclusiveStart:!1}))}}})),bl.create(e.doc,i))},Fg=(e,{cursorBuilder:t=Lg,getSelection:r=(e=>e.selection)}={},n="cursor")=>new zi({key:fg,state:{init:(r,n)=>_g(n,e,t),apply(r,n,o,i){const a=dg.getState(i),s=r.getMeta(fg);return a&&a.isChangeOrigin||s&&s.awarenessUpdated?_g(i,e,t):n.map(r.mapping,r.doc)}},props:{decorations:e=>fg.getState(e)},view:t=>{const o=()=>{t.docView&&((e,t,r)=>{Vg||(Vg=new Map,J(0,zg)),Z(Vg,e,G).set(t,r)})(t,fg,{awarenessUpdated:!0})},i=()=>{const o=dg.getState(t.state),i=e.getLocalState()||{};if(t.hasFocus()&&null!==o.binding){const a=r(t.state),s=$g(a.anchor,o.type,o.binding.mapping),l=$g(a.head,o.type,o.binding.mapping);null!=i.cursor&&te(Q(i.cursor.anchor),s)&&te(Q(i.cursor.head),l)||e.setLocalStateField(n,{anchor:s,head:l})}else null!=i.cursor&&null!==Hg(o.doc,o.type,Q(i.cursor.anchor),o.binding.mapping)&&e.setLocalStateField(n,null)};return e.on("change",o),t.dom.addEventListener("focusin",i),t.dom.addEventListener("focusout",i),{update:i,destroy:()=>{t.dom.removeEventListener("focusin",i),t.dom.removeEventListener("focusout",i),e.off("change",o),e.setLocalStateField(n,null)}}}}),jg=e=>{const t=pg.getState(e).undoManager;if(null!=t)return t.undo(),!0},Wg=e=>{const t=pg.getState(e).undoManager;if(null!=t)return t.redo(),!0},Kg=({protectedNodes:e=new Set(["paragraph"]),trackedOrigins:t=[]}={})=>new zi({key:pg,state:{init:(r,n)=>{const o=dg.getState(n),i=new re(o.type,{trackedOrigins:new Set([dg].concat(t)),deleteFilter:t=>!(t instanceof P&&t.content instanceof ne&&(t.content.type instanceof oe||t.content.type instanceof I&&e.has(t.content.type.nodeName))&&0!==t.content.type._length)});return{undoManager:i,prevSel:null,hasUndoOps:i.undoStack.length>0,hasRedoOps:i.redoStack.length>0}},apply:(e,t,r,n)=>{const o=dg.getState(n).binding,i=t.undoManager,a=i.undoStack.length>0,s=i.redoStack.length>0;return o?{undoManager:i,prevSel:wg(o,r),hasUndoOps:a,hasRedoOps:s}:a!==t.hasUndoOps||s!==t.hasRedoOps?Object.assign({},t,{hasUndoOps:i.undoStack.length>0,hasRedoOps:i.redoStack.length>0}):t}},view:e=>{const t=dg.getState(e.state),r=pg.getState(e.state).undoManager;return r.on("stack-item-added",(({stackItem:r})=>{const n=t.binding;n&&r.meta.set(n,pg.getState(e.state).prevSel)})),r.on("stack-item-popped",(({stackItem:e})=>{const r=t.binding;r&&(r.beforeTransactionSelection=e.meta.get(r)||r.beforeTransactionSelection)})),{destroy:()=>{r.destroy()}}}});var Ug,qg,Jg=nh({defaultOptions:{getProvider:()=>{pn(!1)},destroyProvider:function(e){var t=e.doc;e.disconnect(),e.destroy(),t.destroy()},syncPluginOptions:void 0,cursorBuilder:Lg,cursorStateField:"cursor",getSelection:e=>e.selection,protectedNodes:new Set("paragraph"),trackedOrigins:[]},defaultPriority:Zt.High})((qg=new WeakMap,Ug=class extends Uu{constructor(){super(...arguments),qg.set(this,{writable:!0,value:void 0})}get name(){return"yjs"}get provider(){var e,t=this.options.getProvider;return null!==(e=Lt(this,qg))&&void 0!==e?e:Wi(this,qg,Zg(t))}createKeymap(){return{"Mod-y":wc.isMac?()=>!1:vn(Wg),"Mod-z":vn(jg),"Shift-Mod-z":vn(Wg)}}createExternalPlugins(){var e=this.options,t=e.syncPluginOptions,r=e.cursorBuilder,n=e.getSelection,o=e.cursorStateField,i=e.protectedNodes,a=e.trackedOrigins,s=this.provider.doc.getXmlFragment("prosemirror");return[yg(s,t),Fg(this.provider.awareness,{cursorBuilder:r,cursorStateField:o,getSelection:n},o),Kg({protectedNodes:i,trackedOrigins:a})]}createCommands(){return{yUndo:()=>mn((e=>{var t=e.state,r=e.dispatch;return 0!==pg.getState(t).undoManager.undoStack.length&&(!r||vn(jg)(e))})),yRedo:()=>mn((e=>{var t=e.state,r=e.dispatch;return 0!==pg.getState(t).undoManager.redoStack.length&&(!r||vn(Wg)(e))}))}}onSetOptions(e){var t=e.changes,r=(0,e.pickChanged)(["cursorBuilder","cursorStateField","getProvider","getSelection","syncPluginOptions","protectedNodes","trackedOrigins"]);if(t.getProvider.changed){Wi(this,qg,void 0);var n,o,i=Zg(t.getProvider.previousValue);if(t.destroyProvider.changed)null===(n=(o=t.destroyProvider).previousValue)||void 0===n||n.call(o,i);else this.options.destroyProvider(i)}qr(r)||this.store.updateExtensionPlugins(this)}onDestroy(){Lt(this,qg)&&(this.options.destroyProvider(Lt(this,qg)),Wi(this,qg,void 0))}}))||Ug;function Zg(e){return Hr(e)?e():e}const Gg=e=>e.filter((e=>e&&0!=e.length)),Xg=(e,...t)=>Gg(t).length?t.reduce(((t,r,n)=>(r instanceof Array&&(r=r.join("")),t+r+e[++n])),e[0]):"",Yg=(e,...t)=>{const r="e"==e&&t.pop(),n=Gg(t).join(r?", ":`${e} `);return r?Gg([n,r]).join(" e "):n};class Qg{constructor(){this.itens=[]}incluir(e){const t=`_${ue()}`;return this.itens.push({id:t,extra:e}),t}}const ey=(e,t)=>{var r;const{"título":n,"subtítulo":o}=(e=>{const[,t,r]=(null==e?void 0:e.split(/^((?:(?:o|a|uma)s? |(?:um|uns) )?\S+)/i))||[],[n,o]=(null==e?void 0:e.split(": "))||[];return{chave:t,resto:r,"título":n,"subtítulo":o}})(t.título),i=Xg`
    <ul class="autores">${t.autores.sort().map((e=>`<li>${e}</li>`))}</ul>
    <p class="título"><strong>${n}</strong>${Xg`: ${o}`}</p>`,a=Xg`
    <p class="local">${t.local}</p>
    <p class="data">${t.data}</p>`,s=Xg`<p class="natureza">
    ${t.gênero} apresentado(a) ao(à) ${t.vínculo} para
    ${t.objetivo?t.objetivo[0].toLowerCase()+t.objetivo.slice(1):""}
  </p>`,[,l,c]=e.split(/(<section.+\/section>)/g),[u,h]=(l||"").split(/<section class="referencias"><ul>(.+)<\/ul><\/section>/);console.log({"seções":l,resumos:u,"referências":h});const d=((e,t)=>{const r=new Qg,n=new Qg;return{"conteúdo":e.replace(/<h(\d)>/g,((e,t)=>`<h${t} id="${r.incluir(t)}">`)).replace(/<figure class="(.+?)"><p>/g,((e,t)=>`<figure class="${t}"><p id="${n.incluir(t)}">`)),"sumário":Xg`<nav class="sumário">${[...r.itens.map((e=>`<h${e.extra}><a href="#${e.id}"></a></h${e.extra}>`)),t?'<h6><a href="#referencias">Referências</a></h6>':""]}</nav>`,"ilustrações":Xg`<nav class="ilustrações">${n.itens.filter((e=>"tabela"!=e.extra)).map((e=>`<p class="${e.extra}"><a href="#${e.id}"></a></p>`))}</nav>`,tabelas:Xg`<nav class="tabelas">${n.itens.filter((e=>"tabela"==e.extra)).map((e=>`<p class="${e.extra}"><a href="#${e.id}"></a></p>`))}</nav>`}})(c||e,h);return Xg`
    <article${((...e)=>Xg` class="${Yg("","trabalho",...e.map((e=>t[e]&&e)))}"`)("verso","linhas")}>
      <header>
        ${Xg`<section class="capa">
          ${Xg`<p class="vínculo">${t.vínculo}</p>`}
          ${i}
          ${a}
        </section>`}
        ${Xg`<section class="rosto">
          ${i}
          ${s}
          ${Xg`<p class="orientação">${Yg("e",...t.orientadores)}</p>`}
          ${a}
        </section>`}
        ${(null==(r=t.aprovadores)?void 0:r.length)?Xg`<section class="aprovação">
          ${i}
          ${s}
          <ul class="aprovadores">${t.aprovadores.map((e=>`<li>\n            <p>${e.título} ${e.nome}</p>\n            <p>${e.vínculo||t.vínculo}</p>\n          </li>`))}</ul>
        </section>`:""}
        ${u||""}
        ${t.ilustrações?d.ilustrações:""}
        ${t.tabelas?d.tabelas:""}
        ${d.sumário}
      </header>
      <main>
        ${d.conteúdo}
      </main>
      ${h?`<footer><ul id="referencias">${h}</ul></footer>`:""}
    </article>
  `},ty=e=>{const t=y(),r=new ie(t.guid,t);return r.awareness.setLocalStateField("user",{name:localStorage.nome||"Anônimo",color:localStorage.cor||"#1a73e9"}),o((()=>r.destroy),[]),d(Zf,{autoFocus:!0,manager:Bf([new Nv,new cg,new pv({}),new fv,new vv,new lv({}),new ov,new tv,new sv,new ev({}),new up({content:"resumo abstract referencias heading block+"}),ug("resumo","section","paragraph paragraph",!0),ug("abstract","section","paragraph paragraph",!0),ug("ilustracao","figure","paragraph (paragraph|table) paragraph"),ug("referencias","section","bulletList",!0),new Jg({getProvider:()=>r})])},e.children)},ry=()=>{const[e,t]=n({resumo:!1,abstract:!1,"referências":!1}),[r,i]=n([]),[a,s]=n({"vínculo":"",autores:[],"título":"",local:"",data:"","gênero":"",objetivo:"",orientadores:[],aprovadores:[],"referências":[],verso:!1,serifa:!1,linhas:!1,"ilustrações":!1,tabelas:!1}),l=Object.entries(a).filter((([,e])=>e instanceof Array)).map((([e])=>e)),c=y(),u=[c.getMap("meta"),...l.map((e=>c.getArray(e)))],{getState:h,view:d,addHandler:p,active:f,commands:v,getRootProps:m}=$f({autoUpdate:!0}),g=(e,t)=>{(e=>{const{schema:t,selection:r,tr:n}=h(),o=document.createElement("div");o.innerHTML=e;const{content:i}=ko.fromSchema(t).parseSlice(o);d.dispatch(n.insert(r.anchor,i))})(`<figure class="${e}"><p></p>${t}<p></p></figure>`)},b=()=>s({...a,...c.getMap("meta").toJSON(),...l.reduce(((e,t)=>(e[t]=c.getArray(t).toJSON(),e)),{})}),k=()=>t({...e,...c.getMap("seções").toJSON()}),x=()=>{var e;return i(Array.from((null==(e=document.querySelector(".ProseMirror"))?void 0:e.querySelectorAll("h1,h2,h3,h4,h5"))||[],(e=>({tipo:e.tagName.toLowerCase(),"título":e.textContent,vista:scrollY+innerHeight>=e.offsetTop,"irAté":()=>scrollTo({top:e.offsetTop-74})}))))};return o((()=>{b(),k(),x(),p("updated",x),u.forEach((e=>e.observeDeep(b))),c.getMap("seções").observe(k),onscroll=x}),[]),{meta:a,"sumário":r,"seções":e,...f,...v,addHandler:p,getRootProps:m,"pôrImagem"(e,t,r){g(e,`<p><img src="${t}"${Xg` width="${r}%"`}></p>`)},"pôrTabela"(e,t){const r=`<tr>${"<td></td>".repeat(t)}</tr>`.repeat(e);g("tabela",`<table><tbody>${r}</tbody></table>`)},async imprimir(){const{Previewer:t}=await w((()=>import("./paged.f027865d.js").then((function(e){return e.p}))),["/trabli-beta/paged.f027865d.js","/trabli-beta/y.a65ca05f.js"]),r=new t,{schema:n,doc:o}=h();let i=$c({schema:n,node:o});e.resumo||(i=i.replace(/<section class="resumo">.+?<\/section>/,"")),e.abstract||(i=i.replace(/<section class="abstract">.+?<\/section>/,"")),e.referências||(i=i.replace(/<section class="referencias">.+?<\/section>/,""));const s=ey(i,a),l=document.querySelector(".impressão");l.innerHTML="",await r.preview(s,["midia.css"],l),print()}}};function ny(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function oy(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iy(){return(iy=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function ay(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function sy(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ay(Object(r),!0).forEach((function(t){oy(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ay(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ly,cy,uy=(function(e){var t,r,n,o,i,a,s;"undefined"!=typeof window&&(t=window,r=t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype,n=t.Blob&&function(){try{return Boolean(new Blob)}catch(e){return!1}}(),o=n&&t.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(e){return!1}}(),i=t.BlobBuilder||t.WebKitBlobBuilder||t.MozBlobBuilder||t.MSBlobBuilder,a=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,s=(n||i)&&t.atob&&t.ArrayBuffer&&t.Uint8Array&&function(e){var t,r,s,l,c,u,h,d,p;if(!(t=e.match(a)))throw new Error("invalid data URI");for(r=t[2]?t[1]:"text/plain"+(t[3]||";charset=US-ASCII"),s=!!t[4],l=e.slice(t[0].length),c=s?atob(l):decodeURIComponent(l),u=new ArrayBuffer(c.length),h=new Uint8Array(u),d=0;d<c.length;d+=1)h[d]=c.charCodeAt(d);return n?new Blob([o?h:u],{type:r}):((p=new i).append(u),p.getBlob(r))},t.HTMLCanvasElement&&!r.toBlob&&(r.mozGetAsFile?r.toBlob=function(e,t,n){var o=this;setTimeout((function(){n&&r.toDataURL&&s?e(s(o.toDataURL(t,n))):e(o.mozGetAsFile("blob",t))}))}:r.toDataURL&&s&&(r.msToBlob?r.toBlob=function(e,t,n){var o=this;setTimeout((function(){(t&&"image/png"!==t||n)&&r.toDataURL&&s?e(s(o.toDataURL(t,n))):e(o.msToBlob(t))}))}:r.toBlob=function(e,t,r){var n=this;setTimeout((function(){e(s(n.toDataURL(t,r)))}))})),e.exports?e.exports=s:t.dataURLtoBlob=s)}(cy={path:ly,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&cy.path)}},cy.exports),cy.exports),hy={strict:!0,checkOrientation:!0,maxWidth:1/0,maxHeight:1/0,minWidth:0,minHeight:0,width:void 0,height:void 0,quality:.8,mimeType:"auto",convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},dy="undefined"!=typeof window&&void 0!==window.document?window:{},py=Array.prototype.slice;var fy=/^image\/.+$/;function vy(e){return fy.test(e)}var my=String.fromCharCode;var gy=dy.btoa;function yy(e){var t,r=new DataView(e);try{var n,o,i;if(255===r.getUint8(0)&&216===r.getUint8(1))for(var a=r.byteLength,s=2;s+1<a;){if(255===r.getUint8(s)&&225===r.getUint8(s+1)){o=s;break}s+=1}if(o){var l=o+10;if("Exif"===function(e,t,r){var n,o="";for(r+=t,n=t;n<r;n+=1)o+=my(e.getUint8(n));return o}(r,o+4,4)){var c=r.getUint16(l);if(((n=18761===c)||19789===c)&&42===r.getUint16(l+2,n)){var u=r.getUint32(l+4,n);u>=8&&(i=l+u)}}}if(i){var h,d,p=r.getUint16(i,n);for(d=0;d<p;d+=1)if(h=i+12*d+2,274===r.getUint16(h,n)){h+=8,t=r.getUint16(h,n),r.setUint16(h,1,n);break}}}catch(f){t=1}return t}var wy=/\.\d*(?:0|9){12}\d*$/;function by(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e11;return wy.test(e)?Math.round(e*t)/t:e}var ky=dy.ArrayBuffer,xy=dy.FileReader,Sy=dy.URL||dy.webkitURL,My=/\.\w+$/,Cy=dy.Compressor,Oy=function(){function e(t,r){!
/*!
 * Compressor.js v1.0.7
 * https://fengyuanchen.github.io/compressorjs
 *
 * Copyright 2018-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2020-11-28T07:13:17.754Z
 */
function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.file=t,this.image=new Image,this.options=sy(sy({},hy),r),this.aborted=!1,this.result=null,this.init()}var t,r,n;return t=e,n=[{key:"noConflict",value:function(){return window.Compressor=Cy,e}},{key:"setDefaults",value:function(e){iy(hy,e)}}],(r=[{key:"init",value:function(){var e=this,t=this.file,r=this.options;if(n=t,"undefined"!=typeof Blob&&(n instanceof Blob||"[object Blob]"===Object.prototype.toString.call(n))){var n,o=t.type;if(vy(o))if(Sy&&xy)if(ky||(r.checkOrientation=!1),Sy&&!r.checkOrientation)this.load({url:Sy.createObjectURL(t)});else{var i=new xy,a=r.checkOrientation&&"image/jpeg"===o;this.reader=i,i.onload=function(r){var n=r.target.result,i={};if(a){var s=yy(n);s>1||!Sy?(i.url=function(e,t){for(var r,n=[],o=new Uint8Array(e);o.length>0;)n.push(my.apply(null,(r=o.subarray(0,8192),Array.from?Array.from(r):py.call(r)))),o=o.subarray(8192);return"data:".concat(t,";base64,").concat(gy(n.join("")))}(n,o),s>1&&iy(i,function(e){var t=0,r=1,n=1;switch(e){case 2:r=-1;break;case 3:t=-180;break;case 4:n=-1;break;case 5:t=90,n=-1;break;case 6:t=90;break;case 7:t=90,r=-1;break;case 8:t=-90}return{rotate:t,scaleX:r,scaleY:n}}(s))):i.url=Sy.createObjectURL(t)}else i.url=n;e.load(i)},i.onabort=function(){e.fail(new Error("Aborted to read the image with FileReader."))},i.onerror=function(){e.fail(new Error("Failed to read the image with FileReader."))},i.onloadend=function(){e.reader=null},a?i.readAsArrayBuffer(t):i.readAsDataURL(t)}else this.fail(new Error("The current browser does not support image compression."));else this.fail(new Error("The first argument must be an image File or Blob object."))}else this.fail(new Error("The first argument must be a File or Blob object."))}},{key:"load",value:function(e){var t=this,r=this.file,n=this.image;n.onload=function(){t.draw(sy(sy({},e),{},{naturalWidth:n.naturalWidth,naturalHeight:n.naturalHeight}))},n.onabort=function(){t.fail(new Error("Aborted to load the image."))},n.onerror=function(){t.fail(new Error("Failed to load the image."))},dy.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(dy.navigator.userAgent)&&(n.crossOrigin="anonymous"),n.alt=r.name,n.src=e.url}},{key:"draw",value:function(e){var t=this,r=e.naturalWidth,n=e.naturalHeight,o=e.rotate,i=void 0===o?0:o,a=e.scaleX,s=void 0===a?1:a,l=e.scaleY,c=void 0===l?1:l,u=this.file,h=this.image,d=this.options,p=document.createElement("canvas"),f=p.getContext("2d"),v=r/n,m=Math.abs(i)%180==90,g=Math.max(d.maxWidth,0)||1/0,y=Math.max(d.maxHeight,0)||1/0,w=Math.max(d.minWidth,0)||0,b=Math.max(d.minHeight,0)||0,k=Math.max(d.width,0)||r,x=Math.max(d.height,0)||n;if(m){var S=[y,g];g=S[0],y=S[1];var M=[b,w];w=M[0],b=M[1];var C=[x,k];k=C[0],x=C[1]}g<1/0&&y<1/0?y*v>g?y=g/v:g=y*v:g<1/0?y=g/v:y<1/0&&(g=y*v),w>0&&b>0?b*v>w?b=w/v:w=b*v:w>0?b=w/v:b>0&&(w=b*v),x*v>k?x=k/v:k=x*v;var O=-(k=Math.floor(by(Math.min(Math.max(k,w),g))))/2,E=-(x=Math.floor(by(Math.min(Math.max(x,b),y))))/2,A=k,N=x;if(m){var R=[x,k];k=R[0],x=R[1]}p.width=k,p.height=x,vy(d.mimeType)||(d.mimeType=u.type);var T="transparent";if(u.size>d.convertSize&&"image/png"===d.mimeType&&(T="#fff",d.mimeType="image/jpeg"),f.fillStyle=T,f.fillRect(0,0,k,x),d.beforeDraw&&d.beforeDraw.call(this,f,p),!this.aborted&&(f.save(),f.translate(k/2,x/2),f.rotate(i*Math.PI/180),f.scale(s,c),f.drawImage(h,O,E,A,N),f.restore(),d.drew&&d.drew.call(this,f,p),!this.aborted)){var D=function(e){t.aborted||t.done({naturalWidth:r,naturalHeight:n,result:e})};p.toBlob?p.toBlob(D,d.mimeType,d.quality):D(uy(p.toDataURL(d.mimeType,d.quality)))}}},{key:"done",value:function(e){var t,r,n=e.naturalWidth,o=e.naturalHeight,i=e.result,a=this.file,s=this.image,l=this.options;if(Sy&&!l.checkOrientation&&Sy.revokeObjectURL(s.src),i)if(l.strict&&i.size>a.size&&l.mimeType===a.type&&!(l.width>n||l.height>o||l.minWidth>n||l.minHeight>o))i=a;else{var c=new Date;i.lastModified=c.getTime(),i.lastModifiedDate=c,i.name=a.name,i.name&&i.type!==a.type&&(i.name=i.name.replace(My,(t=i.type,"jpeg"===(r=vy(t)?t.substr(6):"")&&(r="jpg"),".".concat(r))))}else i=a;this.result=i,l.success&&l.success.call(this,i)}},{key:"fail",value:function(e){var t=this.options;if(!t.error)throw e;t.error.call(this,e)}},{key:"abort",value:function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))}}])&&ny(t.prototype,r),n&&ny(t,n),e}();const Ey={tipo:"figura",arquivo:null},Ay={linhas:"",colunas:""},Ny={aprovador:null,"referência":null},Ry={"sumário":!1,"impressão":!1,imagem:!1,tabela:!1,aprovador:!1,"referência":!1},Ty=e=>d("fieldset",null,d("label",{htmlFor:e.campo},e.nome||e.campo,d("input",{hidden:!0,id:e.campo,type:"checkbox",checked:e.mapa.get(e.campo),onChange:t=>e.mapa.set(e.campo,t.target.checked)}),e.mapa.get(e.campo)?d(et,null):d(wt,null))),Dy=e=>d("fieldset",null,d("legend",null,e.nome||e.campo),d("div",{contentEditable:!0,onBlur:t=>e.mapa.set(e.campo,t.target.innerText),dangerouslySetInnerHTML:{__html:e.mapa.get(e.campo)}})),Py=e=>d("fieldset",null,d("legend",null,e.nome),e.array.map(((t,r)=>d("span",{key:r},t,d(tt,{onClick:()=>e.array.delete(r)})))),d("div",{contentEditable:!0,onBlur:t=>{t.target.innerText&&(e.array.push([t.target.innerText]),t.target.innerText="")}})),Iy=()=>{var e;const t=innerWidth<1024,r=y();try{const i=ry(),[a,s]=n(Ry),[l,u]=n(!1),[h,p]=n(Ey),[f,v]=n(Ay),[m,g]=n(Ny),{ref:y,active:w,top:k,left:x}=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=Gf(e);return r.length>0&&t?zt(zt({},r[0]),{},{active:!0}):zt(zt(zt({},of),rf),{},{active:!1})}("bubble"),S=r.getArray("aprovadores").get(m.aprovador),M=r.getArray("referências").get(m.referência),C={imagem(e){e.preventDefault(),new Oy(h.arquivo,{maxWidth:605,convertSize:1/0,quality:.5,success(e){const t=new FileReader;t.onload=e=>{i.pôrImagem(h.tipo,e.target.result),p(Ey)},t.readAsDataURL(e)}})},tabela(e){e.preventDefault(),i.pôrTabela(+f.linhas,+f.colunas),v(Ay)}};return o((()=>i.addHandler("updated",(()=>s(Ry)))),[]),d("div",{"data-serifa":i.meta.serifa},d("aside",{className:"impressão"}),d("section",{className:"edição"},d("header",null,t?d(c,null,d("button",{"data-ativo":a.impressão,onClick:()=>s({...Ry,"impressão":!a.impressão})},d(it,null)),d("button",{"data-ativo":a.sumário,onClick:()=>s({...Ry,"sumário":!a.sumário})},d(Mt,null))):d("button",{onClick:i.imprimir},d(yt,null))),d("article",null,d("main",{...i.getRootProps(),"data-resumo":i.seções.resumo,"data-abstract":i.seções.abstract,"data-referências":i.seções.referências})),d("footer",null,t&&d(c,null,d("button",{onClick:i.yUndo},d(he,null)),d("button",{onClick:i.yRedo},d(bt,null))),i.table()?d(c,null,d("button",{onClick:i.toggleTableHeaderRow},d(kt,null)),d("button",{onClick:i.addTableRowAfter},d(ft,null)),d("button",{onClick:i.addTableColumnAfter},d(mt,null)),d("button",{onClick:i.addTableRowBefore},d(gt,null)),d("button",{onClick:i.addTableColumnBefore},d(vt,null)),d("button",{onClick:i.toggleTableCellMerge},d(Rt,null)),d("button",{onClick:i.deleteTableRow},d(xt,null)),d("button",{onClick:i.deleteTableColumn},d(rt,null))):d(c,null,d("button",{"data-ativo":i.heading({level:1}),onClick:()=>i.toggleHeading({level:1})},d(ct,null)),d("button",{"data-ativo":i.heading({level:2}),onClick:()=>i.toggleHeading({level:2})},d(ut,null)),d("button",{"data-ativo":i.heading({level:3}),onClick:()=>i.toggleHeading({level:3})},d(ht,null)),d("button",{"data-ativo":i.heading({level:4}),onClick:()=>i.toggleHeading({level:4})},d(dt,null)),d("button",{"data-ativo":i.heading({level:5}),onClick:()=>i.toggleHeading({level:5})},d(pt,null)),d("button",{"data-ativo":i.blockquote(),onClick:i.toggleBlockquote},d(Ot,null)),d("button",{"data-ativo":i.bulletList(),onClick:i.toggleBulletList},d(lt,null)),d("button",{"data-ativo":a.imagem,onClick:()=>s({...Ry,imagem:!a.imagem})},d(st,null)),d("button",{"data-ativo":a.tabela,onClick:()=>s({...Ry,tabela:!a.tabela})},d(ot,null))),d("button",{onClick:()=>document.body.toggleAttribute("data-escuro")},d(nt,null))),d("aside",{ref:y,hidden:!w,style:{top:k,left:x}},d("button",{"data-ativo":i.bold(),onClick:()=>i.toggleBold()},d(Ct,null)),d("button",{"data-ativo":i.italic(),onClick:()=>i.toggleItalic()},d(Et,null)),d("button",{"data-ativo":i.underline(),onClick:i.toggleUnderline},d(At,null))),d("button",null,d(b,{to:"/"},d(at,null))),d("dialog",{open:a.impressão},d(Dy,{mapa:r.getMap("meta"),campo:"vínculo",nome:"Instituição"}),d(Py,{array:r.getArray("autores"),nome:"Autores"}),d(Dy,{mapa:r.getMap("meta"),campo:"título"}),d(Dy,{mapa:r.getMap("meta"),campo:"local",nome:"Cidade"}),d(Dy,{mapa:r.getMap("meta"),campo:"data",nome:"Ano"}),d(Dy,{mapa:r.getMap("meta"),campo:"gênero"}),d(Dy,{mapa:r.getMap("meta"),campo:"objetivo"}),d(Py,{array:r.getArray("orientadores"),nome:"Orientadores"}),d("fieldset",null,d("legend",null,"Aprovadores"),i.meta.aprovadores.map(((e,t)=>d("span",null,d("span",{onClick:()=>{g({...m,aprovador:t}),s({...a,aprovador:!0})}},e.nome||"Sem nome"),d(tt,{onClick:()=>r.getArray("aprovadores").delete(t)})))),d("div",{onClick:()=>{const e=r.getArray("aprovadores");e.push([new ae]),g({...m,aprovador:e.length-1}),s({...a,aprovador:!0})}})),d("hr",{hidden:!0}),d(Ty,{mapa:r.getMap("seções"),campo:"resumo"}),d(Ty,{mapa:r.getMap("seções"),campo:"abstract"}),d(Ty,{mapa:r.getMap("meta"),campo:"ilustrações",nome:"Lista de ilustrações"}),d(Ty,{mapa:r.getMap("meta"),campo:"tabelas",nome:"Lista de tabelas"}),d(Ty,{mapa:r.getMap("seções"),campo:"referências"}),d(Ty,{mapa:r.getMap("meta"),campo:"verso",nome:"Frente e verso"}),d(Ty,{mapa:r.getMap("meta"),campo:"linhas",nome:"Linhas pontilhadas"}),d(Ty,{mapa:r.getMap("meta"),campo:"serifa",nome:"Times New Roman"}),t&&d("button",{onClick:i.imprimir},d(yt,null))),d("dialog",{open:a.sumário},d("article",null,d("div",null,i.sumário.map(((e,t)=>d(e.tipo,{key:t,"data-vista":e.vista})))),d("div",null,i.sumário.map(((e,t)=>d(e.tipo,{key:t,onClick:e.irAté,"data-vista":e.vista},e.título)))))),d("dialog",{open:l},d("fieldset",null,d("label",{htmlFor:""})),d("button",null,"Adicionar referência")),d("dialog",{open:a.imagem},d("form",{onSubmit:C.imagem},d("fieldset",null,d("legend",null,"Tipo"),d("select",{value:h.tipo,onChange:e=>p({...h,tipo:e.target.value})},["desenho","esquema","figura","fluxograma","fotografia","gráfico","imagem","mapa","organograma","planta","quadro","retrato"].map((e=>d("option",{value:e},e))))),d("fieldset",null,d("legend",null,"Arquivo"),d("label",{htmlFor:"arquivo"},(null==(e=h.arquivo)?void 0:e.name)||"Escolher arquivo"),d("input",{hidden:!0,type:"file",id:"arquivo",onChange:e=>p({...h,arquivo:e.target.files[0]})})),d("button",{disabled:!h.arquivo},d(St,null)))),d("dialog",{open:a.tabela},d("form",{onSubmit:C.tabela},d("fieldset",null,d("legend",null,"Linhas"),d("input",{type:"number",value:f.linhas,onChange:e=>v({...f,linhas:e.target.value})})),d("fieldset",null,d("legend",null,"Colunas"),d("input",{type:"number",value:f.colunas,onChange:e=>v({...f,colunas:e.target.value})})),d("button",{disabled:!(f.linhas&&f.colunas)},d(St,null)))),d("dialog",{open:a.aprovador},a.aprovador&&S&&d(c,null,d(Dy,{mapa:S,campo:"nome"}),d(Dy,{mapa:S,campo:"título"}),d(Dy,{mapa:S,campo:"vínculo",nome:"Instituição"})),d("button",{onClick:()=>s({...a,aprovador:!1})},d(Nt,null))),d("dialog",{open:a.referência},a.referência&&M&&d(c,null,d(Dy,{mapa:M,campo:"chave"}),d(Dy,{mapa:M,campo:"título"}),d(Dy,{mapa:M,campo:"data"}),d(Py,{array:M.get("autores"),nome:"Autores"})))))}catch{k().go(0)}};export default()=>d(ty,null,d(Iy,null));
